<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
     <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <link rel="icon" type="image/x-icon" href="favicon.ico">
    <title>๐ฉโ๐ณุดู ุนุงููู ุฃููุ๐ฉโ๐ณ</title>
    <style>
         #enter-app-button:hover {
    background-color: #047857;
    transform: scale(1.05);
}

/* ุชูุณูู ุนุงู ูุฃุฒุฑุงุฑ ุงููุบุฉ */
.lang-btn {
    height: 50px;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
    color: #059669;
}

        /* ุงูุตูุญุฉ RTL ูุงูุฎูููุฉ */
        body {
            direction: rtl;
            text-align: center;
            font-family: sans-serif , Tahoma 'Segoe UI', Geneva, Verdana, ;
            margin: 0;
            padding: 0;
            color: #e4e75e;
            background: linear-gradient(135deg, #f5f0e1, #8b4513, #a52a2a);
            min-height: 100vh;
        }

        /* ุงูุดุฑูุท ุงูุนููู Header โ ูุต ุฏูุงุฑ */
        header {
            padding: 25px 20px;
            text-align: center;
            perspective: 1000px;
            margin-bottom: 20px;
            background: linear-gradient(135deg, #ff7f50, #ff4500);
            border-radius: 20px;
            box-shadow: 0 8px 20px rgba(0,0,0,0.5);
        }

        header h1 {
            display: inline-block;
            font-size: 1.2em;
            font-weight: bold;
            animation: rotateText ;
            animation-duration: 18s; 
            animation-timing-function: linear; 
            animation-iteration-count: infinite; 
        }

        @keyframes rotateText {
                       /* ------------------ 1. ุงููุฑุญูุฉ ุงูุฎุถุฑุงุก (0s - 6s) ------------------ */
            0% { 
                transform: rotateY(0deg); 
                color: #10b981; /* ุฃุฎุถุฑ */
            }
            /* ุงูุฏูุฑุงู ููุชูู ุนูุฏ 16.6% (3 ุซูุงูู) */
            16.6% { 
                transform: rotateY(360deg); 
                color: #10b981; 
            }
            /* ูุชุฑุฉ ุงูุชููู ุญุชู 33.3% (6 ุซูุงูู) */
            33.3% { 
                transform: rotateY(360deg); 
                color: #10b981; 
            }

            /* ------------------ 2. ุงููุฑุญูุฉ ุงูุฒุฑูุงุก (6s - 12s) ------------------ */
            /* ุชุบููุฑ ุงูููู ูุงูุฏูุฑุงู ููุตูุฑ ูู ูุญุธุฉ */
            33.4% { 
                transform: rotateY(0deg); 
                color: #eceef2; /* ุฃุจูุถ */
            }
            /* ุงูุฏูุฑุงู ููุชูู ุนูุฏ 50% (9 ุซูุงูู) */
            50% { 
                transform: rotateY(360deg); 
                color: #eceef2; 
            }
            /* ูุชุฑุฉ ุงูุชููู ุญุชู 66.6% (12 ุซุงููุฉ) */
            66.6% { 
                transform: rotateY(360deg); 
                color: #eceef2; 
            }

            /* ------------------ 3. ุงููุฑุญูุฉ ุงูุณูุฏุงุก (12s - 18s) ------------------ */
            /* ุชุบููุฑ ุงูููู ูุงูุฏูุฑุงู ููุตูุฑ ูู ูุญุธุฉ */
            66.7% { 
                transform: rotateY(0deg); 
                color: #000000; /* ุฃุณูุฏ */
            }
            /* ุงูุฏูุฑุงู ููุชูู ุนูุฏ 83.3% (15 ุซุงููุฉ) */
            83.3% { 
                transform: rotateY(360deg); 
                color: #000000; 
            }
            /* ูุชุฑุฉ ุงูุชููู ุญุชู 100% (18 ุซุงููุฉ) */
            100% { 
                transform: rotateY(360deg); 
                color: #10b981; 
            }
        }
        
        /* ======================================================= */
        /* ๐ ุชูุณูู ูุถุน ุงููุบุฉ ุงูุฅูุฌููุฒูุฉ (LTR) - ุชู ุฏูุฌู ููุง */
        /* ======================================================= */
        .english-mode {
         
        }
        
        /* ูุฐุง ุงูุชูุณูู ููุฑุถ ุงูุงุชุฌุงู ูู ุงููุณุงุฑ ูููููู */
        html[dir="ltr"] body {
            text-align: center !important;
        }
        
        /* ูุฐุง ุงูุชูุณูู ูุถูู ูุญุงุฐุงุฉ ุงูุนูุงุตุฑ ุงูุฏุงุฎููุฉ ูููุณุงุฑ ูู ูุถุนูุฉ ุงูุฅูุฌููุฒูุฉ */
        .english-mode main {
            text-align: center !important;
        }
        .english-mode .meal-title{
        text-align: center !important;
        }
        .english-mode .preparation-section,
        .english-mode .ingredients-section {
            text-align:left !important;
            direction: ltr !important;
        }
        
        /* 1. ุชุญุฏูุฏ ุงูุนุฑุถ ุงูุฃูุตู ู ุงููุงูุด ุงูุฌุงูุจู ุงููุงุจู ููุชุนุฏูู */
        main {
            max-width: 600px; 
            margin: 0 auto 30px; 
            padding: 20px; 
            background-color: rgba(0,0,0,0.7);
            border-radius: 20px;
            box-shadow: 0 6px 15px rgba(0,0,0,0.3);
        }

        .buttons-container {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
        }

        .buttons-container button {
            background: linear-gradient(45deg, #03e5e9, #0996c5);
            color: rgb(46, 3, 3);
            padding: 10px 25px;
            border: none;
            border-radius: 12px;
            font-size: 1rem;
            cursor: pointer;
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
            transition: transform 0.2s ease;
        }

        .buttons-container button:hover {
            transform: scale(1.05);
        }

        /* ุงูุชุณููุฉ */
        label {
            display: block;
            margin: 15px 0 5px;
            font-weight: bold;
            font-size: 1.05em;
        }

        /* ุงูููุงุฆู ุงูููุณุฏูุฉ select */
        select {
            width: 100%;
            padding: 12px;
            border-radius: 12px;
            border: 1px solid #241313;
            font-size: 1.2em;
            font-weight: bold;
            margin-bottom: 10px;
            transition: border-color 0.3s, box-shadow 0.3s;
            direction: ltr; /* ููุญูุงุธ ุนูู ุชูุณูู ุงูุฃุฑูุงู ูุงูุญุฑูู ุงููุงุชูููุฉ */
            text-align: left ; /* ููุญูุงุธ ุนูู ุชูุณูู ุงูุฃุฑูุงู ูุงูุญุฑูู ุงููุงุชูููุฉ */
            background-color: #222;
            color: #cfbd88;
        }

        select:focus {
            border-color: #00ff99;
            box-shadow: 0 0 5px #00ff99;
            outline: none;
        }

        /* ุงูุฃุฒุฑุงุฑ ูุงูุฑุฉ */
        button {
            word-spacing: 12px;
            margin-top: 20px;
            padding: 15px 20px;
            width: 100%;
            border: none;
            border-radius: 15px;
            background: linear-gradient(to right, #a0ff99, #50c878);
            color: #000;
            font-size: 1.2em;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.3s;
        }

        button:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.4);
        }
        
       /* ุชูุณูู ุฃุฒุฑุงุฑ  ุงููุบุฉ ูู ุตู ูุงุญุฏ (Container) */
.lang-switcher-row {
    display: flex; /* ูุถุน ุงูุฃุฒุฑุงุฑ ุฌูุจุงู ุฅูู ุฌูุจ */
    justify-content: center; /* ุชูุณูุท ุงูุฃุฒุฑุงุฑ */
    gap: 8px; /* ูุณุงูุฉ ุจูู ุงูุฃุฒุฑุงุฑ */
    margin-bottom: 15px;
}

/* ุชูุณูู ุงูุฃุฒุฑุงุฑ ุงููุฑุฏูุฉ */
.lang-btn {
    padding: 6px 10px;
    border: 2px solid transparent; /* ูุฌุนู ุงูุญุฏูุฏ ูุฑุฆูุฉ ุนูุฏ ุงูุชูุดูุท */
    border-radius: 8px;
    cursor: pointer;
    font-weight: bold;
    transition: all 0.3s ease; /* ูุชุฃุซูุฑ ุงูุฅุถุงุกุฉ ุงูุณูุณ */
    color: #4A4A4A; /* ููู ูุต ูุทูุฃ */
    background-color: #E0E0E0; /* ุฎูููุฉ ูุทูุฃุฉ */
}

/* ุญุงูุฉ ุงูุฒุฑ ุงููุดุท (ุงูููุถุงุก) */
.lang-btn.active {
    background: linear-gradient(to right, #66ff99, #70d2c8); /* ููุณ ุชุฏุฑุฌ ุงูููู ุงูุฐู ุทูุจุชู */
    color: #000000; /* ููู ูุต ุณุงุทุน */
    border-color: #E91E63; /* ุชุญุฏูุฏ ุจุฅุทุงุฑ ูุฑุฏู */
    box-shadow: 0 0 10px rgba(102, 255, 153, 0.7); /* ุฅุถุงูุฉ ุธู ุฎููู ููุฅุถุงุกุฉ */
}
        

        /* ==================================== */
        /* ๐ ยุชูุณููุงุช ุงููุงุฆูุฉ ุงูููุณุฏูุฉ (ุงูุฌุฏูุฏุฉ) */
        /* ==================================== */

        /* ุชูุณููุงุช ุงูู Dropdown */
        .dropdown {
            position: relative; 
            display: inline-block;
            width: 100%; 
            margin-bottom: 15px;
        }

        /* ุชูุณููุงุช ุฒุฑ ุงููุงุฆูุฉ (ูุณุชุจุฏู ุชูุณูู ุงูุฒุฑ ุงููุฏูู) */
        .dropbtn {
            background: linear-gradient(to right, #66ff99, #70d2c8);
            color: #2c0bbc;
            font-weight: bold;
            width: 100%;
            padding: 15px 20px;
            border: none;
            border-radius: 15px;
            font-size: 1.2em;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.3s;
        }

        /* ูุญุชูู ุงููุงุฆูุฉ ุงูููุณุฏูุฉ (ุงููุฎูู ุงูุชุฑุงุถูุงู) */
        .dropdown-content {
            display: none; 
            position: absolute;
            background-color: #f9f9f9;
            min-width: 100%;
            box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
            z-index: 100; /* ูููุฉ ุนุงููุฉ ูุถูุงู ุงูุธููุฑ ููู ูู ุดูุก */
            border-radius: 10px;
            overflow: hidden;
        }

        /* ุชูุณูู ุฎูุงุฑุงุช ุงููุงุฆูุฉ */
        .dropdown-content a {
            color: black;
            padding: 12px 16px;
            text-decoration: none;
            display: block;
            text-align: right; 
            font-size: 1em;
        }

        /* ุชุฃุซูุฑ ุงูุชูุฑูุฑ ุนูู ุงูุฎูุงุฑุงุช */
        .dropdown-content a:hover {
            background-color: #f1f1f1;
            color: #4ECDC4;
        }

        /* ุฅุธูุงุฑ ุงููุงุฆูุฉ ุนูุฏูุง ุชููู ุงููุดุทุฉ */
        .dropdown-content.show {
            display: block;
        }

        /* ... ููุงูุฉ ุฃููุงุฏ CSS ุงูุฎุงุตุฉ ุจู ... */
        /* ุตูุฏูู ุงููุชุงุฆุฌ */
       #result {
    margin-top: 30px;
    padding: 20px;
    border-radius: 15px;
    background-color: rgba(255,255,255,0.1);
    font-size: 1.15em;
    line-height: 1.5em;
    box-shadow: 0 3px 8px rgba(0,0,0,0.2);

    /* ๐ง ุงูุชุนุฏููุงุช ุงููููุฉ */
    width: 100%;
    max-width: 100%;
    box-sizing: border-box;
    overflow-x: hidden;   /* ูููุน ุฃู ุฎุฑูุฌ ุฃููู */
}
    .meal-image {
    width: 100%;
    max-width: 280px;     /* โ ุงูููุชุงุญ ููุง */
    aspect-ratio: 1 / 1;
    object-fit: contain;
    border-radius: 12px;
}


        /* ุงูุณุงุนุฉ ุงูุฑูููุฉ */
        .clock {
            display: flex;
            justify-content: center;
            margin-bottom: 20px;
        }
        .clock span {
            font-size: 1.5em;
            font-weight: bold;
            color: #0f1cb8;
        }

        /* ุงูุชุตููู ุงููุชุฌุงูุจ ููุดุงุดุงุช ุงูุฃุตุบุฑ ูู 650px */
        @media (max-width: 650px) {
            main {
                margin: 20px;
                padding: 20px;
            }
            header {
                font-size: 1.8em;
                padding: 20px 15px;
            }
            select, button {
                font-size: 1.0em;
                padding: 10px;
            }
            .clock span {
                font-size: 1.3em;
            }
        }

        /* ุฑุณุงูุฉ ุงูููุงููุฉ */
        #confirmationMsg {
            font-weight: bold;
            font-size: 24px;
            color: #e74c3c;
            animation: moveLeftRight 3s infinite alternate, colorChange 3s infinite alternate;
            text-align: left;
            margin-bottom: 15px;
        }

        @keyframes moveLeftRight {
            0% { transform: translateX(0); }
            100% { transform: translateX(20px); }
        }

        @keyframes colorChange {
            0% { color: #e74c3c; }
            50% { color: #f1c40f; }
            100% { color: #2ecc71; }
        }
    /* ---------------------------------------------------- */
        /* 1. ุงูุญู ุงูุฌุฐุฑู ููุดููุฉ "ุงููุงุฌูุฉ ุชุงุฎุฐ ุงูุตู ุงููููู" */
        /* ---------------------------------------------------- */
        body {
            background-color: #f7f9fb;
            font-family: 'Cairo', sans-serif;
            color: #e4e75e;
            direction: rtl; 
            margin: 0;
            padding: 0;
        }

   /* ๐ฅ๐ฅ๐ฅ๐ฅ๐ฅ๐ฅ ุจุงูุทุจุน! ุณุฃูุชุจ ูู ุงูููุฏ ุงูุฌุฏูุฏ๐ฅ๐ฅ๐ฅ๐ฅ๐ฅ๐ฅุงูููุฏ ุงูุฌุฏูุฏ */

/* ุงูุญุงููุฉ ุงูุฑุฆูุณูุฉ ูุชูุณูุท ูู ุงููุญุชูู ูู ุงูููุชุตู */
.main-wrapper {
    width: 90vw;
    max-width: 1800px;
    margin: 20px auto;
    padding: 20px;
    background-color: #ffffff;
    border-radius: 12px;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.05);
}

/* ---------------------------------------------------- */
/* 2. ุดููุฑุฉ CSS ุงูุชู ุงุฑุณูุชูุง (ูุน ุชุตุญูุญ ุงูุชุจุงุฏู ูุงููุญุงุฐุงุฉ) */
/* ---------------------------------------------------- */
.meal-layout {
    display: grid;
    flex-direction: column;
    gap: 20px;
    margin-top: 40px;
    margin: 5px 0;
    width: 100%;
    max-width: 100%;
    background: none;
    padding: 0;
    color: #edd982;
    text-align: center;

}

.meal-content {
    width: 100%;
}

/* 4. ุงููุงูุฐุชุงู - ุถูุงู ุงูุชูุฏุฏ ุงูุฑุฃุณู ูุงููุฑููุฉ */
.preparation-section,
.ingredients-section {
    grid-column: auto;
    margin-top: 0 !important;
    align-self: start !important;
    display: flex;
    flex-direction: column;
    height: 100%;
    width: 100%;
    border-radius: 10px;
    box-shadow: 0 4px 8px rgba(0,0,0,0.2);
}


/* ุชูุงุตูู ูุงูุฐุฉ ุทุฑููุฉ ุงูุชุญุถูุฑ (ุงูุนููุฏ ุงูุซุงูู - ุงููุณุงุฑ) */
.preparation-section {
    margin-top: 0 !important;
    grid-column: 2;
    justify-self: stretch;
    width: 100%;
    max-width: 100%;
    box-sizing: border-box;
    text-align: justify;
    direction: rtl;
    padding: 5px;
    background: rgb(156, 117, 81);
    border-right: 3px solid #4ECDC4;
    border-left: 3px solid #FF6B6B;
}

/* ุชูุงุตูู ูุงูุฐุฉ ุงูููููุงุช (ุงูุนููุฏ ุงูุฃูู - ุงููููู) */
.ingredients-section {
    margin-top: 0 !important;
    grid-column: 1;
    justify-self: stretch;
    width: 100%;
    max-width: 100%;
    box-sizing: border-box;
    text-align: right;
    padding: 5px;
    background: rgb(156, 117, 81);
    border-right: 3px solid #4ECDC4;
    border-left: 3px solid #FF6B6B;
}
/* =========================================== */
/* 2. ุชุนุฏูู ุตูุงุฏูู ุงูุนูุงููู (ุชุทุจูู ุงูุชูุณูุท ูุงูุชูุณูู) */
/* =========================================== */
.ingredients-section strong,
.preparation-section strong {
    display: block;
    font-size: 18px;
    /* color: #f4c952;*/
    border-bottom: none;
    margin: 0;
    align-self: center;
}

:lang(en) .ingredients-section,
:lang(en) .preparation-section,
:lang(ru) .ingredients-section,
:lang(ru) .preparation-section {
    text-align: left;
    direction: ltr;
}

:lang(en) .ingredients-section > *,
:lang(en) .preparation-section > *,
:lang(ru) .ingredients-section > *,
:lang(ru) .preparation-section > * {
    text-align: left;
    direction: ltr;
}

/* --- ุจุฏุงูุฉ ุงูุชุนุฏููุงุช ุงููุทููุจุฉ (ูุชุฌููุน ุงููููู ูุงูุฃููููุฉ) --- */

/* 1. ุชูุนูู ุงููุญุงุฐุงุฉ ุงูุฃูููุฉ ุจูู ุงูุฃุทุฑุงู */
.flex-row-aligned {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 5px 0;
}

/* 2. ุชุฌููุน ุงูุฃููููุฉ ูุงุณู ุงููููู ูุนุงู ูู ุงูุทุฑู ุงูุฃูุณุฑ/ุงูุฃููู ุญุณุจ ุงุชุฌุงู ุงููุต */
.flex-start-group {
    display: flex;
    align-items: center;
    gap: 8px;

    /* ๐ฏ ุงูุชุนุฏูู ุงูุฌููุฑู: ูุฏูุน ูุฐุง ุงูุนูุตุฑ ุฅูู ุงูุทุฑู ุงูุฃูุตู ูู Flexbox */
    margin-inline-end: 0;
    text-align: start;
    margin-inline-start: 0;
}

/* 3. ุชุนุฏูู ุงููุญุฏุฏ .ingredient ููุณู */
    .ingredient {
    display: flex;
    align-items: center;
    gap: 10px;
    width: 100%;
    font-size: 18px;
    color: #321081;
    justify-content: flex-start;
    border-bottom: 2px dashed #1edb0d;
}

    .ingredient:last-child {
     border-bottom: none;
}

.ingredient-quantity {
    color: #130135;
    font-weight: 400;
    font-size: 1.1rem;
    white-space: initial;

    /* ๐ฏ ุงูุชุนุฏูู ูุถูุงู ุจูุงุก ุงููููุฉ ูู ุงูุทุฑู ุงูููุงุฆู ูู ููุชุง ุงููุบุชูู */
    margin-inline-start: auto;
    margin-inline-end: 0;
    text-align: end;
}
.scrolling-text {
    background: #e0f2f1;
    padding: 10px;
    border-radius: 8px;
    margin-top: 20px;
    color: #00897b;
    text-align: center;
}

.product-card {
    background: #f0f4c3;
    padding: 15px;
    border-radius: 8px;
    margin-top: 20px;
    text-align: right;
    border: 3px solid #cddc39;
}

.step {
    color: black;
    padding: 2px 0;
    margin: 0 !important;
    font-size: 18px;
    line-height: 1.4;
    width: 100%;
    display: flex;
    align-items: flex-start;
    border-bottom: 2px dashed #1edb0d;
    gap: 2px;
}

    .step:last-child {
    border-bottom: none;
}


/* ุชุฑุชูุจ ุงูุนูุงุตุฑ ูู .ingredient ุญุณุจ ุงููุบุฉ */
   .ingredient {
    flex-direction: row;
}

/* ูู ุงูุนุฑุจูุฉ ูุงููุงุฑุณูุฉ: ูู ุงููููู ูููุณุงุฑ */
.ingredients-section[lang="ar"],
.ingredients-section[lang="fa"] {
   direction: rtl;
    text-align: right;
}
/* ูู ุงูุฅูุฌููุฒูุฉ ูุงูุฑูุณูุฉ: ุงูุฅูููุฌู ูู ุงูููุงูุฉุ ุงูููุงุฏูุฑ ูู ุงูุจุฏุงูุฉ */
.ingredients-section[lang="en"],
.ingredients-section[lang="ru"] {
     direction: ltr;
    text-align: left;
}
/* ูู .preparation-section: ูู ุงููููู ูููุณุงุฑ ููุนุฑุจูุฉ ูุงููุงุฑุณูุฉุ ูู ุงููุณุงุฑ ูููููู ููุจุงูู */
    .preparation-section[lang="ar"],
    .preparation-section[lang="fa"] {
    direction: rtl;
    text-align: right;
}

     .preparation-section[lang="en"],
    .preparation-section[lang="ru"] {
    direction: ltr;
    text-align: left;
}

       /* ุชุตููู ูุชุฌุงูุจ ููุฌูุงู (Grid-Template-Columns: 1fr) */
     @media (max-width: 768px) {
    .main-wrapper {
        margin: 0;
        padding: 10px;
        border-radius: 0;
    }

    .meal-layout {
        gap: 20px;
    }
   .meal-header {
        display: grid;
        grid-template-columns: 1fr 1fr;
        align-items: center;
        gap: 15px;
    }
    .meal-image {
        width: 100%;
        aspect-ratio: 1 / 1;
        object-fit: contain;
    }

    .meal-content {
        display: flex;
        flex-direction: column;
        gap: 20px;
    }

    .ingredients-section,
    .preparation-section {
        order: unset;
        grid-column: 1;
        border-right: 3px solid #4ECDC4;
        border-bottom: 3px solid #4ECDC4;
        border-left: none;
        border-top: none;
        padding: 5px;
    }

    .preparation-section {
        border-right: 3px solid #FF6B6B;
        border-top: 3px solid #FF6B6B;
        border-bottom: none;
    }

    .meal-title {
        font-size: 20px;
        color: chartreuse;
    }

    main {
        padding: 10px;
        margin: 0 5px 20px 5px;
    }
}

       .health-message {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: rgba(0, 0, 0, 0.85);
    color: #ffcc00;
    font-size: 2.5em;
    font-weight: bold;
    padding: 25px 25px;
    border-radius: 20px;
    animation: fadeInOut 3s ease-in-out;
    z-index: 10000;
    text-align: center;
    border: 3px solid #ffcc00;
    box-shadow: 0 0 30px rgba(255, 204, 0, 0.5);
}

@keyframes fadeInOut {
    0% { opacity: 0; transform: translate(-50%, -50%) scale(0.7); }
    50% { opacity: 1; transform: translate(-50%, -50%) scale(1.1); }
    100% { opacity: 0; transform: translate(-50%, -50%) scale(0.7); }

        }
    </style>
</head>

<body>
   <div id="splash-screen-container" class="fixed inset-0 flex items-center justify-center z-50">
</div>
      
    <div class="clock">
        <span id="timeDisplay">19:29:12</span>
    </div>

    <header>
        <h1>๐ฉโ๐ณ ุดู ุนุงููู ุฃููุ๐ฉโ๐ณ</h1>
    </header> 
    <main>
        <div id="languageSwitcherContainer" class="lang-switcher-row">
    <button class="lang-btn active" data-lang="ar">ุนุฑุจู</button>
    <button class="lang-btn" data-lang="en">English</button>
    <button class="lang-btn" data-lang="fa">ูุงุฑุณ</button>
    <button class="lang-btn" data-lang="ru">ะัััะบะธะน</button>
</div>

        <div class="filters">
            <label for="healthStatus">ุงูุญุงูุฉ ุงูุตุญูุฉ:</label>
            <select id="healthStatus">
                <option value="normal">ุทุจูุนูุฉ</option>
                <option value="diabetes">ุณูุฑู</option>
                <option value="pressure">ุถุบุท</option>
                <option value="heart" selected> ุงูุฑุงุถ ููุจูุฉ</option>
            </select>

            <label for="cost">ุงููููุฉ:</label>
            <select id="cost">
                <option value="high">ุนุงููุฉ</option>
                <option value="medium" >ูุชูุณุทุฉ</option>
                <option value="low" selected>ููุฎูุถุฉ</option>
            </select>

            <label for="mealTime">ููุช ุงููุฌุจุฉ:</label>
            <select id="mealTime">
                <option value="breakfast">ูุทูุฑ</option>
                <option value="lunch" selected>ุบุฏุงุก</option>
                <option value="dinner">ุนุดุงุก</option>
            </select>

            <label for="weather">ุญุงูุฉ ุงูุทูุณ:</label>
            <select id="weather">
                <option value="cold">ุจุงุฑุฏ</option> 
                <option value="moderate" selected>ูุนุชุฏู</option>
                <option value="hot">ุญุงุฑ</option>
            </select>

            <label for="mealType">ููุน ุงููุฌุจุฉ:</label>
            <select id="mealType">
                <option value="quick meal" selected>ูุฌุจุฉ ุณุฑูุนุฉ</option>
                <option value="regular meal">ูุฌุจุฉ ุนุงุฏูุฉ</option>
            </select>

            <label for="numberOfpeople">ุนุฏุฏ ุงูุงูุฑุงุฏ:</label>
                <select id="numberOfpeople">
                <option value="small" selected>1 - 2</option>
                <option value="medium">3 - 4</option>
                <option value="large">5 - 6</option>
                <option value="xlarge">7 - 8</option>
                <option value="xxlarge">9 - 11</option>
                <option value="max">12+</option>
            </select>
        </div>

        <div id="result">
            <div class="no-preparation"> ุญุฏุฏู ุงูุฎูุงุฑุงุช ุงูุชู ุชูุงุณุจูู  ูู ุงููุงุฆูุฉ  </div>
        </div>

        <button id="suggestBtn"> ุงุถุบุทู  ููุง  ูุงูุชุฑุญ   ุนูููู  ูุฌุจุฉ  </button>

        <div class="buttons-container">
            <!-- ุชูุช ุฅุถุงูุฉ ุชูุณูู ูุจุฏุฆู ูุฒุฑ ุงูุฎุฑูุฌ -->
            <button id="alternativeBtn">ุงุจุญุซ ุนู ูุฌุจุฉ ุจุฏููุฉ</button>
            <button id="exitBtn" style="background: linear-gradient(to right, #f01c04, #d71c07); color: rgb(2, 1, 15);">ุฎุฑูุฌ</button>
            <button id="confirmBtn">ููุงููุฉ ุนูู ุงููุฌุจุฉ</button>
            <div id="confirmationMsg" style="display: none;">
        </div>
        </div>
    </main>
    <script>
        /*โ ุชู ุงุฎุชูุงุฑ ุงููุตูุฉ ุจูุฌุงุญ!*/
              // ====================================================================
              // 1. ูุงุฆู ุงูุชุฑุฌูุฉ ุงููุฑูุฒู (Central Translations Object)
              // ====================================================================

            const translations = {

               ar: {
                dir: 'rtl',
                title: '๐ฉโ๐ณุดู ุนุงููู ุฃููุ',
                suggestBtn: 'ุงุถุบุทู ููุง ูุงูุชุฑุญ ุนููู ูุฌุจุฉ',
                altBtn: 'ุงุจุญุซ ุนู ูุฌุจุฉ ุจุฏููุฉ',
                confirmBtn: 'ููุงููุฉ ุนูู ุงููุฌุจุฉ',
                exitBtn: 'ุฎุฑูุฌ',
                healthLabel: 'ุงูุญุงูุฉ ุงูุตุญูุฉ',
                costLabel: 'ุงููููุฉ',
                timeLabel: 'ููุช ุงููุฌุจุฉ',
                weatherLabel: 'ุญุงูุฉ ุงูุทูุณ',
                typeLabel: 'ููุน ุงููุฌุจุฉ',
                peopleLabel: 'ุนุฏุฏ ุงูุฃูุฑุงุฏ',
                preparationLabel: 'ุทุฑููุฉ ุงูุชุญุถูุฑ',
                ingredientsLabel: "ุงูููููุงุช",
                health: ['ุทุจูุนูุฉ', 'ุณูุฑู', 'ุถุบุท', 'ุงูุฑุงุถ ููุจูุฉ'],
                cost: ['ุนุงููุฉ', 'ูุชูุณุทุฉ', 'ููุฎูุถุฉ'],
                time: ['ูุทูุฑ', 'ุบุฏุงุก', 'ุนุดุงุก'],
                weather: ['ุจุงุฑุฏ', 'ูุนุชุฏู', 'ุญุงุฑ'],
                type: ['ูุฌุจุฉ ุณุฑูุนุฉ', 'ูุฌุจุฉ ุนุงุฏูุฉ'],
                people: ['1 - 2', '3 - 4', '5 - 6', '7 - 8', '9 - 11', '12+'],
                noPrepMsg: 'ุญุฏุฏู ุงูุฎูุงุฑุงุช ุงูุชู ุชูุงุณุจูู ูู ุงููุงุฆูุฉ',
                instructionsLabel: 'ุทุฑููุฉ ุงูุชุญุถูุฑ',

                // ๐ 1. ุงููุญุฏุงุช ุงูุฃุณุงุณูุฉ
                units: {
                    'g': 'ุบุฑุงู', 'kg': 'ูุบ', 'L': 'ูุชุฑ', 'ml': 'ูู',
                    'cup': 'ููุจ', 'tbsp': 'ููุนูุฉ ูุจูุฑุฉ', 'tsp': 'ููุนูุฉ ุตุบูุฑุฉ',
                    'count': 'ุงูุนุฏุฏ', 'loaf': 'ุฑุบูู','clove': 'ุญุต',
                    'pinch': 'ุฑุดุฉ', 'squeeze': 'ุนุตุฑุฉ', 'piece': 'ุญุจุฉ'
                },

                // ๐ 2. ุงูููุงุฏูุฑ ูุงูุฑูุงุจุท ุงููุบููุฉ
                quantifiers: {
                    FRACTION_HALF: 'ูุตู',
                    FRACTION_QUARTER: 'ุฑุจุน',
                    FRACTION_THIRD: 'ุซูุซ',
                    FRACTION_TWO_THIRDS: 'ุซูุซูู',
                    FRACTION_THREE_QUARTERS: 'ุซูุงุซุฉ ุฃุฑุจุงุน',
                    CONNECTOR_AND: ' ู ',
                    TEXT_TO_TASTE: 'ุญุณุจ ุงูุทูุจ',
                    TEXT_APPROX: 'ุชูุฑูุจุงู',
                    TEXT_UNIT_AND_HALF: 'ููุตู',
                    TEXT_UNIT_ONE: 'ูุงุญุฏุฉ',
                    TEXT_UNIT_ONE_MASC: 'ูุงุญุฏ',
                    TEXT_UNIT_AND_QUARTER: 'ูุฑุจุน',
                    TEXT_UNIT_AND_TWO_THIRDS: 'ูุซูุซูู',
                },  TEXT_UNIT_AND_THREE_QUARTERS: 'ูุซูุงุซุฉ ุฃุฑุจุงุน',

                // ๐ 3. ุงูุตูุงุช ูุงููุนุฏูุฏุงุช
                descriptors: {
                    MEDIUM: 'ูุชูุณุทุฉ',
                    SMALL: 'ุตุบูุฑุฉ',
                    LARGE: 'ูุจูุฑุฉ',
                    HEAD: 'ุฑุฃุณ',
                    CLOVE: 'ุญุต',
                    BUNCH: 'ุญุฒูุฉ',
                },
            
             // ๐ 4. ุงูุนุจุงุฑุงุช ุงููุดุทุฉ
                activation: {
                    madam: "ุณูุฏุชู ุงููุญุชุฑูุฉุ",
                    giftTitle: "ูุฏูุฉ",
                    preWarning: "ุฃูุดูุช ูุฑุญูุฉ ุงูุงุณุชูุงุฏุฉ ุงููุฌุงููุฉ ุนูู ุงูุงูุชูุงุก! ุจูู ูุฏููู ุงุฎุชูุงุฑุงู ููุท.",
                    graceMsg: "ุณูุฏุชู ุงููุฑููุฉ. ุญุฑุตุงู ููุง ุนูู ุชุณููู ุงูุฃููุฑ ุนููููุ ุฃุถููุง ูุญุงููุชูู ุฅุถุงููุชูู ูููุญูู ุงูููุช ุงููุงูู ููุญุตูู ุนูู ููุชุงุญ ุงูุชูุนูู. ูุญู ุจุงูุชุธุงุฑูู.",
                    upgradeMsg: "ุณูุฏุชู ุงูุนุฒูุฒุฉุ ููุฏ ุงุณุชููุฏุชู ูุงูุฉ ุงููุญุงููุงุช. ูุฑุฌู ุฅุฏุฎุงู ููุชุงุญ ุงูุชูุนูู ููุงุณุชูุชุงุน ุจุงููููุฒุงุช ุงููุงููุฉ.",
                    backBtn: "ุงูุนูุฏุฉ ุฅูู ุงูุชุทุจูู",
                    success: "ุชู ุงูุชูุนูู ุจูุฌุงุญ!"
               },
            },


            // ====================================================================================
            // --- 2. ุงููุบุฉ ุงูุฅูุฌููุฒูุฉ (en) ---
            // ====================================================================================
            en: {
                dir: 'ltr',
                title: '?What is for Dinner๐ฉโ๐ณ',
                suggestBtn: 'Click here to suggest a meal',
                altBtn: 'Find an alternative meal',
                confirmBtn: 'Confirm meal selection',
                exitBtn: 'Exit',
                healthLabel: 'Health Status',
                costLabel: 'Cost',
                timeLabel: 'Meal Time',
                weatherLabel: 'Weather Condition',
                typeLabel: 'Meal Type',
                peopleLabel: 'Number of People',
                preparationLabel: 'Preparation Method',
                ingredientsLabel: "Ingredients",
                health: ['Normal', 'Diabetes', 'Pressure', 'Heart'],
                cost: ['High', 'Medium', 'Low'],
                time: ['Breakfast', 'Lunch', 'Dinner'],
                weather: ['Cold', 'Moderate', 'Hot'],
                type: ['Quick Meal', 'Regular Meal'],
                people: ['1 - 2', '3 - 4', '5 - 6', '7 - 8', '9 - 11', '12+'],
                noPrepMsg: 'Select the options that suit you from the menu',
                instructionsLabel: 'Preparation Method',

                // ๐ 1. ุงููุญุฏุงุช ุงูุฃุณุงุณูุฉ
                units: {
                    'g': 'g', 'kg': 'kg', 'L': 'L', 'ml': 'ml',
                    'cup': 'cup', 'tbsp': 'tbsp', 'tsp': 'tsp',
                    'count': 'count', 'loaf': 'loaf', 'clove': 'clove',
                    'pinch': 'pinch', 'squeeze': 'squeeze', 'piece': 'piece'
                },

                // ๐ 2. ุงูููุงุฏูุฑ ูุงูุฑูุงุจุท ุงููุบููุฉ
                quantifiers: {
                    FRACTION_HALF: 'half',
                    FRACTION_QUARTER: 'quarter',
                    FRACTION_THIRD: 'third',
                    FRACTION_TWO_THIRDS: 'two-thirds',
                    FRACTION_THREE_QUARTERS: 'three-quarters',
                    CONNECTOR_AND: ' and ',
                    TEXT_TO_TASTE: 'to taste',
                    TEXT_APPROX: 'approx',
                    TEXT_UNIT_AND_HALF: ' and a half',
                    TEXT_UNIT_ONE: 'one',
                    TEXT_UNIT_ONE_MASC: 'one',
                    TEXT_UNIT_AND_QUARTER: ' and a quarter',
                    TEXT_UNIT_AND_TWO_THIRDS: ' and two-thirds',
                    TEXT_UNIT_AND_THREE_QUARTERS: ' and three-quarters',
                },

                // ๐ 3. ุงูุตูุงุช ูุงููุนุฏูุฏุงุช
                descriptors: {
                    MEDIUM: 'medium',
                    SMALL: 'small',
                    LARGE: 'large',
                    HEAD: 'head',
                    CLOVE: 'clove',
                    BUNCH: 'bunch',
                },

                // ๐ 4. ุงูุนุจุงุฑุงุช ุงููุงููุฉ
            phrases: {

                // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                // ููุนูุฉ ุตุบูุฑุฉ (teaspoon)
                // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                "ุฑุจุน ููุนูุฉ ุตุบูุฑุฉ": "ยผ teaspoon",
                "ูุตู ููุนูุฉ ุตุบูุฑุฉ": "ยฝ teaspoon",
                "ุซูุงุซุฉ ุฃุฑุจุงุน ููุนูุฉ ุตุบูุฑุฉ": "ยพ teaspoon",
                "ููุนูุฉ ุตุบูุฑุฉ": "1 teaspoon",
                "ููุนูุฉ ุตุบูุฑุฉ ููุตู": "1ยฝ teaspoons",
                "ููุนูุฉ ุตุบูุฑุฉ ูุฑุจุน": "1ยผ teaspoons",
                "ููุนูุชุงู ุตุบูุฑุชุงู": "2 teaspoons",
                "ููุนูุชุงู ุตุบูุฑุชุงู ููุตู": "2ยฝ teaspoons",
                "3 ููุงุนู ุตุบูุฑุฉ": "3 teaspoons",
                "4 ููุงุนู ุตุบูุฑุฉ": "4 teaspoons",
                "5 ููุงุนู ุตุบูุฑุฉ": "5 teaspoons",
                "6 ููุงุนู ุตุบูุฑุฉ": "6 teaspoons",

                // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                // ููุนูุฉ ูุจูุฑุฉ (tablespoon)
                // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                "ุฑุจุน ููุนูุฉ ูุจูุฑุฉ": "ยผ tablespoon",
                "ูุตู ููุนูุฉ ูุจูุฑุฉ": "ยฝ tablespoon",
                "ุซูุงุซุฉ ุฃุฑุจุงุน ููุนูุฉ ูุจูุฑุฉ": "ยพ tablespoon",
                "ููุนูุฉ ูุจูุฑุฉ": "1 tablespoon",
                "ููุนูุฉ ูุจูุฑุฉ ููุตู": "1ยฝ tablespoons",
                "ููุนูุฉ ูุจูุฑุฉ ูุฑุจุน": "1ยผ tablespoons",
                "ููุนูุชุงู ูุจูุฑุชุงู": "2 tablespoons",
                "ููุนูุชุงู ูุจูุฑุชุงู ููุตู": "2ยฝ tablespoons",
                "3 ููุงุนู ูุจูุฑุฉ": "3 tablespoons",
                "4 ููุงุนู ูุจูุฑุฉ": "4 tablespoons",
                "5 ููุงุนู ูุจูุฑุฉ": "5 tablespoons",
                "6 ููุงุนู ูุจูุฑุฉ": "6 tablespoons",

                // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                // ููุจ (cup)
                // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                "ุฑุจุน ููุจ": "ยผ cup",
                "ุซูุซ ููุจ": "โ cup",
                "ูุตู ููุจ": "ยฝ cup",
                "ุซูุซุง ููุจ": "โ cup",
                "ุซูุงุซุฉ ุฃุฑุจุงุน ููุจ": "ยพ cup",
                "ููุจ": "1 cup",
                "ููุจ ููุตู": "1ยฝ cups",
                "ููุจ ูุฑุจุน": "1ยผ cups",
                "ููุจุงู": "2 cups",
                "ููุจุงู ููุตู": "2ยฝ cups",
                "3 ุฃููุงุจ": "3 cups",
                "4 ุฃููุงุจ": "4 cups",
                "5 ุฃููุงุจ": "5 cups",

                // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                // ุญุจุฉ/ูุทุนุฉ (piece)
                // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                "ุฑุจุน ุญุจุฉ": "ยผ piece",
                "ูุตู ุญุจุฉ": "ยฝ piece",
                "ุซูุงุซุฉ ุฃุฑุจุงุน ุญุจุฉ": "ยพ piece",
                "ุญุจุฉ": "1 piece",
                "ุญุจุฉ ููุตู": "1ยฝ pieces",
                "ุญุจุชุงู": "2 pieces",
                "3 ุญุจุงุช": "3 pieces",
                "4 ุญุจุงุช": "4 pieces",
                "5 ุญุจุงุช": "5 pieces",
                "6 ุญุจุงุช": "6 pieces",
                "7 ุญุจุงุช": "7 pieces",
                "8 ุญุจุงุช": "8 pieces",
                "9 ุญุจุงุช": "9 pieces",
                "10 ุญุจุงุช": "10 pieces",

                // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                // ูุต (clove) - ููุซูู
                // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                "ูุตู ูุต": "ยฝ clove",
                "ูุต": "1 clove",
                "ูุตุงู": "2 cloves",
                "3 ูุตูุต": "3 cloves",
                "4 ูุตูุต": "4 cloves",
                "5 ูุตูุต": "5 cloves",
                "6 ูุตูุต": "6 cloves",

                // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                // ุฑุฃุณ (head) - ููุซูู/ุงูุจุตู
                // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                "ุฑุจุน ุฑุฃุณ": "ยผ head",
                "ูุตู ุฑุฃุณ": "ยฝ head",
                "ุฑุฃุณ": "1 head",
                "ุฑุฃุณุงู": "2 heads",
                "3 ุฑุคูุณ": "3 heads",

                // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                // ุญุฒูุฉ/ุฑุจุทุฉ (bunch)
                // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                "ูุตู ุญุฒูุฉ": "ยฝ bunch",
                "ุญุฒูุฉ": "1 bunch",
                "ุญุฒูุชุงู": "2 bunches",
                "ูุตู ุฑุจุทุฉ": "ยฝ bunch",
                "ุฑุจุทุฉ": "1 bunch",

                // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                // ูุฑุตุฉ (pinch)
                // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                "ูุฑุตุฉ": "1 pinch",
                "ูุฑุตุชุงู": "2 pinches",
                "3 ูุฑุตุงุช": "3 pinches",

                // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                // ุงูุฃูุฒุงู ูุงูุญุฌูู
                // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                "ุบุฑุงู": "g",
                "ุฌุฑุงู": "g",
                "ุบุฑุงูุงู": "g",
                "ุฌุฑุงูุงู": "g",
                "ูู": "ml",
                "ูููุชุฑ": "ml",
                "ุฑุจุน ูุชุฑ": "ยผ liter",
                "ูุตู ูุชุฑ": "ยฝ liter",
                "ูุชุฑ": "1 liter",
                "ูุชุฑ ููุตู": "1ยฝ liters",
                "ูุชุฑุงู": "2 liters",
                "ุฑุจุน ูููู": "250g",
                "ูุตู ูููู": "500g",
                "ูููู": "1 kg",
                "ูููู ููุตู": "1.5 kg",

                // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                // ุนุจุงุฑุงุช ุฎุงุตุฉ
                // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                "ุญุณุจ ุงูุฑุบุจุฉ": "to taste",
                "ุญุณุจ ุงูุทูุจ": "to taste",
                "ููุชุฒููู": "for garnish",
                "ุญุณุจ ุงูุญุงุฌุฉ": "as needed",
            },
        },


            // ====================================================================================
            // --- 3. ุงููุบุฉ ุงูุฑูุณูุฉ (ru) ---
            // ====================================================================================
            ru: {
                dir: 'ltr',
                title: '?ะงัะพ ะฝะฐ ะพะฑะตะด ๐ฉโ๐ณ',
                suggestBtn: 'ะะฐะถะผะธัะต ะทะดะตัั, ััะพะฑั ะฟัะตะดะปะพะถะธัั ะฒะฐะผ ะฑะปัะดะพ',
                altBtn: 'ะะฐะนัะธ ะฐะปััะตัะฝะฐัะธะฒะฝะพะต ะฑะปัะดะพ',
                confirmBtn: 'ะะพะดัะฒะตัะดะธัั ะฒัะฑะพั',
                exitBtn: 'ะััะพะด',
                healthLabel: 'ะกะพััะพัะฝะธะต ะทะดะพัะพะฒัั',
                costLabel: 'ะกัะพะธะผะพััั',
                timeLabel: 'ะัะตะผั ะฟัะธัะผะฐ ะฟะธัะธ',
                weatherLabel: 'ะะพะณะพะดะฐ',
                typeLabel: 'ะขะธะฟ ะฑะปัะดะฐ',
                peopleLabel: 'ะะพะปะธัะตััะฒะพ ะฟะตััะพะฝ',
                preparationLabel: 'ะกะฟะพัะพะฑ ะฟัะธะณะพัะพะฒะปะตะฝะธั',
                ingredientsLabel: "ะะฝะณัะตะดะธะตะฝัั",
                health: ['ะะพัะผะฐะปัะฝะพะต', 'ะะธะฐะฑะตั', 'ะะฐะฒะปะตะฝะธะต', 'ะกะตัะดะตัะฝัะต ะทะฐะฑะพะปะตะฒะฐะฝะธั'],
                cost: ['ะััะพะบะฐั', 'ะกัะตะดะฝัั', 'ะะธะทะบะฐั'],
                time: ['ะะฐะฒััะฐะบ', 'ะะฑะตะด', 'ะฃะถะธะฝ'],
                weather: ['ะฅะพะปะพะดะฝะฐั', 'ะฃะผะตัะตะฝะฝะฐั', 'ะะฐัะบะฐั'],
                type: ['ะััััะพะต ะฑะปัะดะพ', 'ะะฑััะฝะพะต ะฑะปัะดะพ'],
                people: ['1-2', '3-4', '5-6', '7-8', '9-11', '12+'],
                noPrepMsg: 'ะัะฑะตัะธัะต ะฟะพะดัะพะดััะธะต ะพะฟัะธะธ ะธะท ัะฟะธัะบะฐ',
                instructionsLabel: 'ะกะฟะพัะพะฑ ะฟัะธะณะพัะพะฒะปะตะฝะธั',

                // ๐ 1. ุงููุญุฏุงุช ุงูุฃุณุงุณูุฉ
                units: {
                    'g': 'ะณ', 'kg': 'ะบะณ', 'L': 'ะป', 'ml': 'ะผะป',
                    'cup': 'ัะฐัะบะฐ', 'tbsp': 'ัั. ะปะพะถะบะฐ', 'tsp': 'ั. ะปะพะถะบะฐ',
                    'count': 'ะบะพะปะธัะตััะฒะพ', 'loaf': 'ะปะพะผัะธะบ', 'clove' :'ะทัะฑัะธะบ',
                    'pinch': 'ัะตะฟะพัะบะฐ', 'squeeze': 'ะฒัะดะฐะฒะปะธะฒะฐะฝะธะต', 'piece': 'ัััะบะฐ'
                },

                // ๐ 2. ุงูููุงุฏูุฑ ูุงูุฑูุงุจุท ุงููุบููุฉ
                quantifiers: {
                    FRACTION_HALF: 'ะฟะพะปะพะฒะธะฝะฐ',
                    FRACTION_QUARTER: 'ัะตัะฒะตััั',
                    FRACTION_THIRD: 'ััะตัั',
                    FRACTION_TWO_THIRDS: 'ะดะฒะต ััะตัะธ',
                    FRACTION_THREE_QUARTERS: 'ััะธ ัะตัะฒะตััะธ',
                    CONNECTOR_AND: ' ะธ ',
                    TEXT_TO_TASTE: 'ะฟะพ ะฒะบััั',
                    TEXT_APPROX: 'ะฟัะธะผะตัะฝะพ',
                    TEXT_UNIT_AND_HALF: ' ะธ ะฟะพะปะพะฒะธะฝะฐ',
                    TEXT_UNIT_ONE: 'ะพะดะฝะฐ',
                    TEXT_UNIT_ONE_MASC: 'ะพะดะธะฝ',
                    TEXT_UNIT_AND_QUARTER: ' ะธ ัะตัะฒะตััั',
                    TEXT_UNIT_AND_THREE_QUARTERS: ' ะธ ััะธ ัะตัะฒะตััะธ',
                    TEXT_UNIT_AND_TWO_THIRDS: ' ะธ ะดะฒะต ััะตัะธ',
                },

                // ๐ 3. ุงูุตูุงุช ูุงููุนุฏูุฏุงุช
                descriptors: {
                    MEDIUM: 'ััะตะดะฝัั',
                    SMALL: 'ะผะฐะปะตะฝัะบะฐั',
                    LARGE: 'ะฑะพะปััะฐั',
                    HEAD: 'ะณะพะปะพะฒะบะฐ',
                    CLOVE: 'ะทัะฑัะธะบ',
                    BUNCH: 'ะฟััะพะบ',
                },

                phrases: {

                // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                // ููุนูุฉ ุตุบูุฑุฉ (ัะฐะนะฝะฐั ะปะพะถะบะฐ) - ูุคูุซ
                // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                "ุฑุจุน ููุนูุฉ ุตุบูุฑุฉ": "ัะตัะฒะตััั ัะฐะนะฝะพะน ะปะพะถะบะธ",
                "ูุตู ููุนูุฉ ุตุบูุฑุฉ": "ะฟะพะปะพะฒะธะฝะฐ ัะฐะนะฝะพะน ะปะพะถะบะธ",
                "ุซูุงุซุฉ ุฃุฑุจุงุน ููุนูุฉ ุตุบูุฑุฉ": "ััะธ ัะตัะฒะตััะธ ัะฐะนะฝะพะน ะปะพะถะบะธ",
                "ููุนูุฉ ุตุบูุฑุฉ": "ะพะดะฝะฐ ัะฐะนะฝะฐั ะปะพะถะบะฐ",
                "ููุนูุฉ ุตุบูุฑุฉ ููุตู": "ะฟะพะปัะพัั ัะฐะนะฝัะต ะปะพะถะบะธ",
                "ููุนูุฉ ุตุบูุฑุฉ ูุฑุจุน": "ะพะดะฝะฐ ั ัะตัะฒะตัััั ัะฐะนะฝะฐั ะปะพะถะบะฐ",
                "ููุนูุชุงู ุตุบูุฑุชุงู": "ะดะฒะต ัะฐะนะฝัะต ะปะพะถะบะธ",
                "ููุนูุชุงู ุตุบูุฑุชุงู ููุตู": "ะดะฒะต ั ะฟะพะปะพะฒะธะฝะพะน ัะฐะนะฝัะต ะปะพะถะบะธ",
                "3 ููุงุนู ุตุบูุฑุฉ": "ััะธ ัะฐะนะฝัะต ะปะพะถะบะธ",
                "4 ููุงุนู ุตุบูุฑุฉ": "ัะตัััะต ัะฐะนะฝัะต ะปะพะถะบะธ",
                "5 ููุงุนู ุตุบูุฑุฉ": "ะฟััั ัะฐะนะฝัั ะปะพะถะตะบ",
                "6 ููุงุนู ุตุบูุฑุฉ": "ัะตััั ัะฐะนะฝัั ะปะพะถะตะบ",

                // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                // ููุนูุฉ ูุจูุฑุฉ (ััะพะปะพะฒะฐั ะปะพะถะบะฐ) - ูุคูุซ
                // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                "ุฑุจุน ููุนูุฉ ูุจูุฑุฉ": "ัะตัะฒะตััั ััะพะปะพะฒะพะน ะปะพะถะบะธ",
                "ูุตู ููุนูุฉ ูุจูุฑุฉ": "ะฟะพะปะพะฒะธะฝะฐ ััะพะปะพะฒะพะน ะปะพะถะบะธ",
                "ุซูุงุซุฉ ุฃุฑุจุงุน ููุนูุฉ ูุจูุฑุฉ": "ััะธ ัะตัะฒะตััะธ ััะพะปะพะฒะพะน ะปะพะถะบะธ",
                "ููุนูุฉ ูุจูุฑุฉ": "ะพะดะฝะฐ ััะพะปะพะฒะฐั ะปะพะถะบะฐ",
                "ููุนูุฉ ูุจูุฑุฉ ููุตู": "ะฟะพะปัะพัั ััะพะปะพะฒัะต ะปะพะถะบะธ",
                "ููุนูุฉ ูุจูุฑุฉ ูุฑุจุน": "ะพะดะฝะฐ ั ัะตัะฒะตัััั ััะพะปะพะฒะฐั ะปะพะถะบะฐ",
                "ููุนูุชุงู ูุจูุฑุชุงู": "ะดะฒะต ััะพะปะพะฒัะต ะปะพะถะบะธ",
                "ููุนูุชุงู ูุจูุฑุชุงู ููุตู": "ะดะฒะต ั ะฟะพะปะพะฒะธะฝะพะน ััะพะปะพะฒัะต ะปะพะถะบะธ",
                "3 ููุงุนู ูุจูุฑุฉ": "ััะธ ััะพะปะพะฒัะต ะปะพะถะบะธ",
                "4 ููุงุนู ูุจูุฑุฉ": "ัะตัััะต ััะพะปะพะฒัะต ะปะพะถะบะธ",
                "5 ููุงุนู ูุจูุฑุฉ": "ะฟััั ััะพะปะพะฒัั ะปะพะถะตะบ",
                "6 ููุงุนู ูุจูุฑุฉ": "ัะตััั ััะพะปะพะฒัั ะปะพะถะตะบ",

                // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                // ููุจ (ััะฐะบะฐะฝ) - ูุฐูุฑ
                // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                "ุฑุจุน ููุจ": "ัะตัะฒะตััั ััะฐะบะฐะฝะฐ",
                "ุซูุซ ููุจ": "ััะตัั ััะฐะบะฐะฝะฐ",
                "ูุตู ููุจ": "ะฟะพะปะพะฒะธะฝะฐ ััะฐะบะฐะฝะฐ",
                "ุซูุซุง ููุจ": "ะดะฒะต ััะตัะธ ััะฐะบะฐะฝะฐ",
                "ุซูุงุซุฉ ุฃุฑุจุงุน ููุจ": "ััะธ ัะตัะฒะตััะธ ััะฐะบะฐะฝะฐ",
                "ููุจ": "ะพะดะธะฝ ััะฐะบะฐะฝ",
                "ููุจ ููุตู": "ะฟะพะปัะพัะฐ ััะฐะบะฐะฝะฐ",
                "ููุจ ูุฑุจุน": "ะพะดะธะฝ ั ัะตัะฒะตัััั ััะฐะบะฐะฝ",
                "ููุจุงู": "ะดะฒะฐ ััะฐะบะฐะฝะฐ",
                "ููุจุงู ููุตู": "ะดะฒะฐ ั ะฟะพะปะพะฒะธะฝะพะน ััะฐะบะฐะฝะฐ",
                "3 ุฃููุงุจ": "ััะธ ััะฐะบะฐะฝะฐ",
                "4 ุฃููุงุจ": "ัะตัััะต ััะฐะบะฐะฝะฐ",
                "5 ุฃููุงุจ": "ะฟััั ััะฐะบะฐะฝะพะฒ",

                // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                // ุญุจุฉ/ูุทุนุฉ (ัััะบะฐ) - ูุคูุซ
                // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                "ุฑุจุน ุญุจุฉ": "ัะตัะฒะตััั ัััะบะธ",
                "ูุตู ุญุจุฉ": "ะฟะพะปะพะฒะธะฝะฐ ัััะบะธ",
                "ุซูุงุซุฉ ุฃุฑุจุงุน ุญุจุฉ": "ััะธ ัะตัะฒะตััะธ ัััะบะธ",
                "ุญุจุฉ": "ะพะดะฝะฐ ัััะบะฐ",
                "ุญุจุฉ ููุตู": "ะฟะพะปัะพัั ัััะบะธ",
                "ุญุจุชุงู": "ะดะฒะต ัััะบะธ",
                "3 ุญุจุงุช": "ััะธ ัััะบะธ",
                "4 ุญุจุงุช": "ัะตัััะต ัััะบะธ",
                "5 ุญุจุงุช": "ะฟััั ัััะบ",
                "6 ุญุจุงุช": "ัะตััั ัััะบ",
                "7 ุญุจุงุช": "ัะตะผั ัััะบ",
                "8 ุญุจุงุช": "ะฒะพัะตะผั ัััะบ",
                "9 ุญุจุงุช": "ะดะตะฒััั ัััะบ",
                "10 ุญุจุงุช": "ะดะตัััั ัััะบ",

                // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                // ูุต (ะทัะฑัะธะบ) - ูุฐูุฑ (ููุซูู)
                // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                "ูุตู ูุต": "ะฟะพะปะพะฒะธะฝะฐ ะทัะฑัะธะบะฐ",
                "ูุต": "ะพะดะธะฝ ะทัะฑัะธะบ",
                "ูุตุงู": "ะดะฒะฐ ะทัะฑัะธะบะฐ",
                "3 ูุตูุต": "ััะธ ะทัะฑัะธะบะฐ",
                "4 ูุตูุต": "ัะตัััะต ะทัะฑัะธะบะฐ",
                "5 ูุตูุต": "ะฟััั ะทัะฑัะธะบะพะฒ",
                "6 ูุตูุต": "ัะตััั ะทัะฑัะธะบะพะฒ",

                // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                // ุฑุฃุณ (ะณะพะปะพะฒะบะฐ) - ูุคูุซ (ููุซูู/ุงูุจุตู)
                // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                "ุฑุจุน ุฑุฃุณ": "ัะตัะฒะตััั ะณะพะปะพะฒะบะธ",
                "ูุตู ุฑุฃุณ": "ะฟะพะปะพะฒะธะฝะฐ ะณะพะปะพะฒะบะธ",
                "ุฑุฃุณ": "ะพะดะฝะฐ ะณะพะปะพะฒะบะฐ",
                "ุฑุฃุณุงู": "ะดะฒะต ะณะพะปะพะฒะบะธ",
                "3 ุฑุคูุณ": "ััะธ ะณะพะปะพะฒะบะธ",

                // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                // ุญุฒูุฉ/ุฑุจุทุฉ (ะฟััะพะบ) - ูุฐูุฑ
                // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                "ูุตู ุญุฒูุฉ": "ะฟะพะปะพะฒะธะฝะฐ ะฟััะบะฐ",
                "ุญุฒูุฉ": "ะพะดะธะฝ ะฟััะพะบ",
                "ุญุฒูุชุงู": "ะดะฒะฐ ะฟััะบะฐ",
                "ูุตู ุฑุจุทุฉ": "ะฟะพะปะพะฒะธะฝะฐ ะฟััะบะฐ",
                "ุฑุจุทุฉ": "ะพะดะธะฝ ะฟััะพะบ",

                // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                // ูุฑุตุฉ (ัะตะฟะพัะบะฐ) - ูุคูุซ
                // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                "ูุฑุตุฉ": "ะพะดะฝะฐ ัะตะฟะพัะบะฐ",
                "ูุฑุตุชุงู": "ะดะฒะต ัะตะฟะพัะบะธ",
                "3 ูุฑุตุงุช": "ััะธ ัะตะฟะพัะบะธ",

                // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                // ุบุฑุงู (ะณัะฐะผะผ) - ูุฐูุฑ
                // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                "ุบุฑุงู": "ะณ",
                "ุฌุฑุงู": "ะณ",
                "ุบุฑุงูุงู": "ะณ",
                "ุฌุฑุงูุงู": "ะณ",

                // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                // ูู (ะผะป) - ุจุฏูู ุชุตุฑูู
                // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                "ูู": "ะผะป",
                "ูููุชุฑ": "ะผะป",

                // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                // ูุชุฑ (ะปะธัั) - ูุฐูุฑ
                // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                "ุฑุจุน ูุชุฑ": "ัะตัะฒะตััั ะปะธััะฐ",
                "ูุตู ูุชุฑ": "ะฟะพะปะพะฒะธะฝะฐ ะปะธััะฐ",
                "ูุชุฑ": "ะพะดะธะฝ ะปะธัั",
                "ูุชุฑ ููุตู": "ะฟะพะปัะพัะฐ ะปะธััะฐ",
                "ูุชุฑุงู": "ะดะฒะฐ ะปะธััะฐ",

                // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                // ูุบ (ะบะณ) - ุจุฏูู ุชุตุฑูู ุนุงุฏุฉู
                // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                "ุฑุจุน ูููู": "ัะตัะฒะตััั ะบะณ",
                "ูุตู ูููู": "ะฟะพะปะพะฒะธะฝะฐ ะบะณ",
                "ูููู": "ะพะดะธะฝ ะบะณ",
                "ูููู ููุตู": "ะฟะพะปัะพัะฐ ะบะณ",

                // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                // ุนุจุงุฑุงุช ุฎุงุตุฉ
                // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                "ุญุณุจ ุงูุฑุบุจุฉ": "ะฟะพ ะฒะบััั",
                "ุญุณุจ ุงูุทูุจ": "ะฟะพ ะฒะบััั",
                "ููุชุฒููู": "ะดะปั ัะบัะฐัะตะฝะธั",
                "ุญุณุจ ุงูุญุงุฌุฉ": "ะฟะพ ะฝะตะพะฑัะพะดะธะผะพััะธ",
            },
        },


            // ====================================================================================
            // --- 4. ุงููุบุฉ ุงููุงุฑุณูุฉ (fa) ---
            // ====================================================================================
            fa: {
                dir: 'rtl',
                title: 'ุบุฐุง ฺ ุฏุงุฑูุ ๐ฉโ๐ณ',
                suggestBtn: 'ุจุฑุง ูพุดููุงุฏ ุบุฐุง ุงูุฌุง ฺฉูฺฉ ฺฉูุฏ',
                altBtn: 'ุงูุชู ุบุฐุง ุฌุงฺฏุฒู',
                confirmBtn: 'ุชุฃุฏ ุงูุชุฎุงุจ ุบุฐุง',
                exitBtn: 'ุฎุฑูุฌ',
                healthLabel: 'ูุถุนุช ุณูุงูุช',
                costLabel: 'ูุฒูู',
                timeLabel: 'ุฒูุงู ูุนุฏู ุบุฐุง',
                weatherLabel: 'ูุถุนุช ุขุจ ู ููุง',
                typeLabel: 'ููุน ุบุฐุง',
                peopleLabel: 'ุชุนุฏุงุฏ ุงูุฑุงุฏ',
                preparationLabel: 'ุฑูุด ุขูุงุฏูโุณุงุฒ',
                ingredientsLabel: "ููุงุฏ ูุงุฒู",
                health: ['ุนุงุฏ', 'ุฏุงุจุช', 'ูุดุงุฑ ุฎูู', 'ูุดฺฉูุงุช ููุจ'],
                cost: ['ุจุงูุง', 'ูุชูุณุท', 'ฺฉู'],
                time: ['ุตุจุญุงูู', 'ูุงูุงุฑ', 'ุดุงู'],
                weather: ['ุณุฑุฏ', 'ููุงู', 'ฺฏุฑู'],
                type: ['ุบุฐุง ููุฑ', 'ุบุฐุง ูุนููู'],
                people: ['1 - 2', '3 - 4', '5 - 6', '7 - 8', '9 - 11', '12+'],
                noPrepMsg: 'ฺฏุฒููโูุง ุฑุง ฺฉู ุจุฑุง ุดูุง ููุงุณุจ ุงุณุช ุงุฒ ููู ุงูุชุฎุงุจ ฺฉูุฏ',
                instructionsLabel: 'ุฑูุด ุขูุงุฏูโุณุงุฒ',

                // ๐ 1. ุงููุญุฏุงุช ุงูุฃุณุงุณูุฉ
                units: {
                    'g': 'ฺฏุฑู', 'kg': 'ฺฉููฺฏุฑู', 'L': 'ูุชุฑ', 'ml': 'ููโูุชุฑ', 'clove':'ูุฎฺฉ',
                    'cup': 'ูพูุงูู', 'tbsp': 'ูุงุดู ุบุฐุงุฎูุฑ', 'tsp': 'ูุงุดู ฺุงโุฎูุฑ',
                    'count': 'ุชุนุฏุงุฏ', 'loaf': 'ูุฑุต',  'slice': 'ุจุฑุด', 'dash': 'ฺฉู',
                    'pinch': 'ูพูฺ', 'squeeze': 'ุนุตุงุฑู', 'piece': 'ุนุฏุฏ', 'to_taste': 'ุจู ูุฒุงู ูุงุฒู'
                },

                // ๐ 2. ุงูููุงุฏูุฑ ูุงูุฑูุงุจุท ุงููุบููุฉ
                quantifiers: {
                    FRACTION_HALF: 'ูุตู',
                    FRACTION_QUARTER: 'ฺฉ ฺูุงุฑู',
                    FRACTION_THIRD: 'ฺฉ ุณูู',
                    FRACTION_TWO_THIRDS: 'ุฏู ุณูู',
                    FRACTION_THREE_QUARTERS: 'ุณู ฺูุงุฑู',
                    CONNECTOR_AND: ' ู ',
                    TEXT_TO_TASTE: 'ุจู ูุฒุงู ูุงุฒู',
                    TEXT_APPROX: 'ุชูุฑุจุงู',
                    TEXT_UNIT_AND_HALF: ' ู ูู',
                    TEXT_UNIT_ONE: 'ฺฉ ุนุฏุฏ',
                    TEXT_UNIT_ONE_MASC: 'ฺฉ',
                    TEXT_UNIT_AND_QUARTER: ' ู ฺฉ ฺูุงุฑู',
                },

                // ๐ 3. ุงูุตูุงุช ูุงููุนุฏูุฏุงุช
                descriptors: {
                    MEDIUM: 'ูุชูุณุท',
                    SMALL: 'ฺฉูฺฺฉ',
                    LARGE: 'ุจุฒุฑฺฏ',
                    HEAD: 'ุณูุฑ',
                    CLOVE: 'ุญุจู',
                    BUNCH: 'ุฏุณุชู',
                },

                // ๐ 4. ุงูุนุจุงุฑุงุช ุงููุงููุฉ
            phrases: {

                // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                // ููุนูุฉ ุตุบูุฑุฉ (ูุงุดู ฺุงุฎูุฑ)
                // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                "ุฑุจุน ููุนูุฉ ุตุบูุฑุฉ": "ฺฉ ฺูุงุฑู ูุงุดู ฺุงุฎูุฑ",
                "ูุตู ููุนูุฉ ุตุบูุฑุฉ": "ูู ูุงุดู ฺุงุฎูุฑ",
                "ุซูุงุซุฉ ุฃุฑุจุงุน ููุนูุฉ ุตุบูุฑุฉ": "ุณู ฺูุงุฑู ูุงุดู ฺุงุฎูุฑ",
                "ููุนูุฉ ุตุบูุฑุฉ": "ฺฉ ูุงุดู ฺุงุฎูุฑ",
                "ููุนูุฉ ุตุบูุฑุฉ ููุตู": "ฺฉ ู ูู ูุงุดู ฺุงุฎูุฑ",
                "ููุนูุฉ ุตุบูุฑุฉ ูุฑุจุน": "ฺฉ ู ฺฉ ฺูุงุฑู ูุงุดู ฺุงุฎูุฑ",
                "ููุนูุชุงู ุตุบูุฑุชุงู": "ุฏู ูุงุดู ฺุงุฎูุฑ",
                "ููุนูุชุงู ุตุบูุฑุชุงู ููุตู": "ุฏู ู ูู ูุงุดู ฺุงุฎูุฑ",
                "3 ููุงุนู ุตุบูุฑุฉ": "ุณู ูุงุดู ฺุงุฎูุฑ",
                "4 ููุงุนู ุตุบูุฑุฉ": "ฺูุงุฑ ูุงุดู ฺุงุฎูุฑ",
                "5 ููุงุนู ุตุบูุฑุฉ": "ูพูุฌ ูุงุดู ฺุงุฎูุฑ",
                "6 ููุงุนู ุตุบูุฑุฉ": "ุดุด ูุงุดู ฺุงุฎูุฑ",

                // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                // ููุนูุฉ ูุจูุฑุฉ (ูุงุดู ุบุฐุงุฎูุฑ)
                // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                "ุฑุจุน ููุนูุฉ ูุจูุฑุฉ": "ฺฉ ฺูุงุฑู ูุงุดู ุบุฐุงุฎูุฑ",
                "ูุตู ููุนูุฉ ูุจูุฑุฉ": "ูู ูุงุดู ุบุฐุงุฎูุฑ",
                "ุซูุงุซุฉ ุฃุฑุจุงุน ููุนูุฉ ูุจูุฑุฉ": "ุณู ฺูุงุฑู ูุงุดู ุบุฐุงุฎูุฑ",
                "ููุนูุฉ ูุจูุฑุฉ": "ฺฉ ูุงุดู ุบุฐุงุฎูุฑ",
                "ููุนูุฉ ูุจูุฑุฉ ููุตู": "ฺฉ ู ูู ูุงุดู ุบุฐุงุฎูุฑ",
                "ููุนูุฉ ูุจูุฑุฉ ูุฑุจุน": "ฺฉ ู ฺฉ ฺูุงุฑู ูุงุดู ุบุฐุงุฎูุฑ",
                "ููุนูุชุงู ูุจูุฑุชุงู": "ุฏู ูุงุดู ุบุฐุงุฎูุฑ",
                "ููุนูุชุงู ูุจูุฑุชุงู ููุตู": "ุฏู ู ูู ูุงุดู ุบุฐุงุฎูุฑ",
                "3 ููุงุนู ูุจูุฑุฉ": "ุณู ูุงุดู ุบุฐุงุฎูุฑ",
                "4 ููุงุนู ูุจูุฑุฉ": "ฺูุงุฑ ูุงุดู ุบุฐุงุฎูุฑ",
                "5 ููุงุนู ูุจูุฑุฉ": "ูพูุฌ ูุงุดู ุบุฐุงุฎูุฑ",
                "6 ููุงุนู ูุจูุฑุฉ": "ุดุด ูุงุดู ุบุฐุงุฎูุฑ",

                // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                // ููุจ (ููุงู)
                // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                "ุฑุจุน ููุจ": "ฺฉ ฺูุงุฑู ููุงู",
                "ุซูุซ ููุจ": "ฺฉ ุณูู ููุงู",
                "ูุตู ููุจ": "ูู ููุงู",
                "ุซูุซุง ููุจ": "ุฏู ุณูู ููุงู",
                "ุซูุงุซุฉ ุฃุฑุจุงุน ููุจ": "ุณู ฺูุงุฑู ููุงู",
                "ููุจ": "ฺฉ ููุงู",
                "ููุจ ููุตู": "ฺฉ ู ูู ููุงู",
                "ููุจ ูุฑุจุน": "ฺฉ ู ฺฉ ฺูุงุฑู ููุงู",
                "ููุจุงู": "ุฏู ููุงู",
                "ููุจุงู ููุตู": "ุฏู ู ูู ููุงู",
                "3 ุฃููุงุจ": "ุณู ููุงู",
                "4 ุฃููุงุจ": "ฺูุงุฑ ููุงู",
                "5 ุฃููุงุจ": "ูพูุฌ ููุงู",

                // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                // ุญุจุฉ/ูุทุนุฉ (ุนุฏุฏ)
                // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                "ุฑุจุน ุญุจุฉ": "ฺฉ ฺูุงุฑู ุนุฏุฏ",
                "ูุตู ุญุจุฉ": "ูู ุนุฏุฏ",
                "ุซูุงุซุฉ ุฃุฑุจุงุน ุญุจุฉ": "ุณู ฺูุงุฑู ุนุฏุฏ",
                "ุญุจุฉ": "ฺฉ ุนุฏุฏ",
                "ุญุจุฉ ููุตู": "ฺฉ ู ูู ุนุฏุฏ",
                "ุญุจุชุงู": "ุฏู ุนุฏุฏ",
                "3 ุญุจุงุช": "ุณู ุนุฏุฏ",
                "4 ุญุจุงุช": "ฺูุงุฑ ุนุฏุฏ",
                "5 ุญุจุงุช": "ูพูุฌ ุนุฏุฏ",
                "6 ุญุจุงุช": "ุดุด ุนุฏุฏ",
                "7 ุญุจุงุช": "ููุช ุนุฏุฏ",
                "8 ุญุจุงุช": "ูุดุช ุนุฏุฏ",
                "9 ุญุจุงุช": "ูู ุนุฏุฏ",
                "10 ุญุจุงุช": "ุฏู ุนุฏุฏ",

                // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                // ูุต (ุญุจู) - ููุซูู
                // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                "ูุตู ูุต": "ูู ุญุจู",
                "ูุต": "ฺฉ ุญุจู",
                "ูุตุงู": "ุฏู ุญุจู",
                "3 ูุตูุต": "ุณู ุญุจู",
                "4 ูุตูุต": "ฺูุงุฑ ุญุจู",
                "5 ูุตูุต": "ูพูุฌ ุญุจู",
                "6 ูุตูุต": "ุดุด ุญุจู",

                // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                // ุฑุฃุณ (ุณุฑ/ุจูุชู)
                // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                "ุฑุจุน ุฑุฃุณ": "ฺฉ ฺูุงุฑู ุจูุชู",
                "ูุตู ุฑุฃุณ": "ูู ุจูุชู",
                "ุฑุฃุณ": "ฺฉ ุจูุชู",
                "ุฑุฃุณุงู": "ุฏู ุจูุชู",
                "3 ุฑุคูุณ": "ุณู ุจูุชู",

                // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                // ุญุฒูุฉ/ุฑุจุทุฉ (ุฏุณุชู)
                // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                "ูุตู ุญุฒูุฉ": "ูู ุฏุณุชู",
                "ุญุฒูุฉ": "ฺฉ ุฏุณุชู",
                "ุญุฒูุชุงู": "ุฏู ุฏุณุชู",
                "ูุตู ุฑุจุทุฉ": "ูู ุฏุณุชู",
                "ุฑุจุทุฉ": "ฺฉ ุฏุณุชู",

                // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                // ูุฑุตุฉ (ููฺฉ ุงูฺฏุดุช)
                // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                "ูุฑุตุฉ": "ฺฉ ููฺฉ ุงูฺฏุดุช",
                "ูุฑุตุชุงู": "ุฏู ููฺฉ ุงูฺฏุดุช",
                "3 ูุฑุตุงุช": "ุณู ููฺฉ ุงูฺฏุดุช",

                // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                // ุงูุฃูุฒุงู ูุงูุญุฌูู
                // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                "ุบุฑุงู": "ฺฏุฑู",
                "ุฌุฑุงู": "ฺฏุฑู",
                "ุบุฑุงูุงู": "ฺฏุฑู",
                "ุฌุฑุงูุงู": "ฺฏุฑู",
                "ูู": "ููโูุชุฑ",
                "ูููุชุฑ": "ููโูุชุฑ",
                "ุฑุจุน ูุชุฑ": "ฺฉ ฺูุงุฑู ูุชุฑ",
                "ูุตู ูุชุฑ": "ูู ูุชุฑ",
                "ูุชุฑ": "ฺฉ ูุชุฑ",
                "ูุชุฑ ููุตู": "ฺฉ ู ูู ูุชุฑ",
                "ูุชุฑุงู": "ุฏู ูุชุฑ",
                "ุฑุจุน ูููู": "ฒตฐ ฺฏุฑู",
                "ูุตู ูููู": "ตฐฐ ฺฏุฑู",
                "ูููู": "ฺฉ ฺฉูู",
                "ูููู ููุตู": "ฺฉ ู ูู ฺฉูู",

                // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                // ุนุจุงุฑุงุช ุฎุงุตุฉ
                // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                "ุญุณุจ ุงูุฑุบุจุฉ": "ุจู ูุฒุงู ุฏูุฎูุงู",
                "ุญุณุจ ุงูุทูุจ": "ุจู ูุฒุงู ุฏูุฎูุงู",
                "ููุชุฒููู": "ุจุฑุง ุชุฒู",
                "ุญุณุจ ุงูุญุงุฌุฉ": "ุจู ุงูุฏุงุฒู ูุงุฒ",
            },
        },

        };
        // ====================================================================
        // 2. ุฏูุงู ูุณุงุนุฏุฉ ููุบุฉ ูุงููุงุฌูุฉ (UI Helpers)
        // ====================================================================

        /**
         * ุฏุงูุฉ ุชุญุฏูุซ ูุธูุฑ ุงูุฒุฑ ุงููุดุท (ุงูุฅุถุงุกุฉ).
         * @param {string} activeLangCode ููุฏ ุงููุบุฉ ุงููุดุท.
         */
        function highlightActiveLanguageButton(activeLangCode) {
            const langButtons = document.querySelectorAll('.lang-btn');

            langButtons.forEach(button => {
                button.classList.remove('active');
                if (button.getAttribute('data-lang') === activeLangCode) {
                    button.classList.add('active');
                }
            });
        }

        /**
         * ุฏุงูุฉ ุชุทุจูู ุงูุชุฑุฌูุฉ ุงูููุญุฏุฉ ุนูู ุนูุงุตุฑ ุงููุงุฌูุฉ.
         * @param {string} langCode ููุฏ ุงููุบุฉ ุงููุฑุงุฏ ุชุทุจููู.
         */
        function applyUITranslation(langCode) {
            const t = translations[langCode];
            if (!t) return;

            // 1. ุชุญุฏูุซ ุงูุงุชุฌุงู ุงูุฃุณุงุณู ูุงูู Class
            document.documentElement.setAttribute('lang', langCode);
            document.documentElement.setAttribute('dir', t.dir);
            document.body.className = t.dir === 'rtl' ? 'rtl-mode' : 'ltr-mode';
            document.title = t.title;

            const headerTitle = document.querySelector('header h1');
            if (headerTitle) { headerTitle.textContent = t.title; }

            // 2. ุชุญุฏูุซ ูุตูุต ุงูุฃุฒุฑุงุฑ ูุงูููุงุทู ุงูุซุงุจุชุฉ
            const elementsToUpdate = {
                '#suggestBtn': t.suggestBtn,
                '#alternativeBtn': t.altBtn,
                '#confirmBtn': t.confirmBtn,
                '#exitBtn': t.exitBtn,
                '#confirmationMsg': t.confirmMsg,
                '#noPrepMsg': t.noPrepMsg
            };

            for (const selector in elementsToUpdate) {
                const element = document.querySelector(selector);
                if (element) {
                    element.textContent = elementsToUpdate[selector];
                }
            }

            // 3. ุชุญุฏูุซ ุชุณููุงุช ุญููู ุงูุฅุฏุฎุงู (Labels)
            const labelMap = {
                'healthStatus': t.healthLabel,
                'cost': t.costLabel,
                'mealTime': t.timeLabel,
                'weather': t.weatherLabel,
                'mealType': t.typeLabel,
                'numberOfpeople': t.peopleLabel
            };

            for (const id in labelMap) {
                const label = document.querySelector(`label[for="${id}"]`);
                if (label) { label.textContent = labelMap[id]; }
            }

            // 4. ุชุญุฏูุซ ุฎูุงุฑุงุช ุงูููุงุฆู ุงูููุณุฏูุฉ (Options Texts)
            const selectOptions = [
                { id: 'healthStatus', data: t.health },
                { id: 'cost', data: t.cost },
                { id: 'mealTime', data: t.time },
                { id: 'weather', data: t.weather },
                { id: 'mealType', data: t.type },
                { id: 'numberOfpeople', data: t.people }
            ];

            selectOptions.forEach(item => {
                const selectElement = document.getElementById(item.id);
                if (selectElement) {
                    item.data.forEach((text, index) => {
                        if (selectElement.options[index]) {
                            selectElement.options[index].textContent = text;
                        }
                    });
                }
            });

            // 5. ุชุญุฏูุซ ูุบุฉ ุงูุณุงุนุฉ (ุฅู ูุฌุฏุช)
            if (typeof updateClock === 'function') {
                 updateClock();
            }
        }
    </script>
   <script src="meals_dbase_1-50.js"></script>
   <script src="meals_dbase_51-100.js"></script>
   <script src="meals_dbase_101-150.js"></script>
   <script src="meals_dbase_151-200.js"></script>
   <script>
   /**
 * ุชุชุญูู ูุณุคูููุฉ ุชุจุฏูู ุงููุบุฉ ุงููุนููุฉ ูู ุงูุชุทุจูู ูุชุทุจูู ุงูุชูุณููุงุช.
 * @param {string} langCode ููุฏ ุงููุบุฉ ุงูุฐู ุชู ุงุฎุชูุงุฑู ('ar', 'en', 'ru', 'fa').
 */
function handleLanguageToggle(langCode) { 
    console.log(`--- ุจุฏุก ุชุชุจุน ุฏุงูุฉ handleLanguageToggle ููุบุฉ: ${langCode} ---`);
    
    // 1. ุงูุญูุธ ูู ุงูุฐุงูุฑุฉ
    localStorage.setItem('preferredLang', langCode);
    console.log(`1. ุชู ุญูุธ ุงููุบุฉ ุงูููุถูุฉ: ${langCode}`);

    // 2. ุชุญุฏูุฏ ูุชุทุจูู ุงุชุฌุงู ุงููุชุงุจุฉ (LTR/RTL)
    const isRTL = (langCode === 'ar' || langCode === 'fa'); 
    document.documentElement.dir = isRTL ? 'rtl' : 'ltr';
    document.documentElement.lang = langCode;
    console.log(`2. ุชู ุชุนููู ุงุชุฌุงู ุงููุชุงุจุฉ ุฅูู: ${document.documentElement.dir}`); // ูุนุฑุถ 'rtl' ุฃู 'ltr'

    // 3. ุชุทุจูู ุงูุชุฑุฌูุฉ ูุชุญุฏูุซ ุงููุงุฌูุฉ
    applyUITranslation(langCode); 
    console.log(`3. ุชู ุงุณุชุฏุนุงุก applyUITranslation ูุชุญุฏูุซ ุงููุงุฌูุฉ ุงูุซุงุจุชุฉ.`);
    
    // 4. ุชูุนูู ุงูุฒุฑ ุงูููุถุงุก
    highlightActiveLanguageButton(langCode);

    console.log('4. ุชู ุชุธููู ุฒุฑ ุงููุบุฉ ุงููุดุท.');

    // 5. ุฅุฎูุงุก ุฑุณุงูุฉ ุงูุชุฃููุฏ
    const confirmationMsg = document.getElementById('confirmationMsg');
    if (confirmationMsg) { 
        confirmationMsg.style.display = 'none';
        console.log('5. ุชู ุฅุฎูุงุก ุฑุณุงูุฉ ุงูุชุฃููุฏ.');
    }

    // 6. ุฅุนุงุฏุฉ ุนุฑุถ ุงููุฌุจุฉ ุงูุญุงููุฉ ุจุงููุบุฉ ุงูุฌุฏูุฏุฉ
    if (window.currentSuggestedMeal) {
        console.log('6. ุงููุฌุจุฉ ุงูุญุงููุฉ ููุฌูุฏุฉ. ุณูุชู ุงุณุชุฏุนุงุก displayMeal...');
        displayMeal(window.currentSuggestedMeal);
        console.log('   ุชู ุงุณุชุฏุนุงุก displayMeal ุจูุฌุงุญ.');
    } else {
        console.log('6. ูุง ุชูุฌุฏ ูุฌุจุฉ ุญุงููุฉ. ุชุญุฏูุซ ุฑุณุงูุฉ "ูุง ูุชุงุฆุฌ"...');
        displayNoResults(false, true);
    }

    // 7. ุชุญุฏูุซ ููุฏ ุงููุบุฉ ุนูู ูุณู HTML
    document.documentElement.lang = langCode;
    console.log(`7. ุชู ุชุนููู document.documentElement.lang ุฅูู: ${document.documentElement.lang}`);

    console.log(`--- ุงูุชูุงุก ุชุชุจุน ุฏุงูุฉ handleLanguageToggle ---`);
}

/**
 * ุฏุงูุฉ ุนุฑุถ ุฑุณุงูุฉ "ูุง ูุชุงุฆุฌ" (ููุจูุงุฉ ูู ุงูููุฏ ุงููุฏูู).
 * @param {boolean} isAlternative ูู ุงูุฑุณุงูุฉ ุฎุงุตุฉ ุจุงูุจุฏุงุฆู.
 * @param {boolean} isReset ูู ุงูุฑุณุงูุฉ ูู ุฑุณุงูุฉ ุงูุจุฏุงูุฉ.
 */
function displayNoResults(isAlternative = false, isReset = false) {
    const resultDiv = document.getElementById('result');
    const currentLangCode = document.documentElement.lang; 

    const messages = {
        'ar': isReset ? 'โุญุฏุฏู  ุงูุฎูุงุฑุงุช ุงูุชู ุชูุงุณุจูู ูู ุงููุงุฆูุฉ๐ ' : (isAlternative ? 'ุนููุงูุ ูุง ุชูุฌุฏ ูุฌุจุฉ ุจุฏููุฉ ุชุทุงุจู ุงููุนุงููุฑ ุงููุญุฏุฏุฉ.' : 'ุนููุงูุ ูุง ุชูุฌุฏ ูุฌุจุงุช ุชุทุงุจู ุงููุนุงููุฑ ุงููุญุฏุฏุฉ ุญุงููุงู.'),
        'en': isReset ? "โ Select the appropriate options from the list ๐" : (isAlternative ? 'Sorry, no alternative meal matches the specified criteria.' : 'Sorry, no meals currently match the specified criteria.'),
        'ru': isReset ? "โ ะัะฑะตัะธัะต ะฟะพะดัะพะดััะธะต ะฒะฐัะธะฐะฝัั ะธะท ัะฟะธัะบะฐ ๐" : (isAlternative ? 'ะ ัะพะถะฐะปะตะฝะธั, ะฐะปััะตัะฝะฐัะธะฒะฝะพะต ะฑะปัะดะพ ะฝะต ัะพะพัะฒะตัััะฒัะตั ัะบะฐะทะฐะฝะฝัะผ ะบัะธัะตัะธัะผ.' : 'ะ ัะพะถะฐะปะตะฝะธั, ะฒ ะฝะฐััะพััะตะต ะฒัะตะผั ะฝะตั ะฑะปัะด, ัะพะพัะฒะตัััะฒัััะธั ัะบะฐะทะฐะฝะฝัะผ ะบัะธัะตัะธัะผ.'),
        'fa': isReset ? " โ ฺฏุฒูููุง ููุงุณุจ ุฑุง ุงุฒ ูุณุช ุงูุชุฎุงุจ ฺฉูุฏ๐" : (isAlternative ? 'ูุชุฃุณูุงููุ ุบุฐุง ุฌุงฺฏุฒู ุจุง ูุนุงุฑูุง ูุดุฎุต ุดุฏู ูุทุงุจูุช ูุฏุงุฑุฏ.' : 'ูุชุฃุณูุงููุ ุฏุฑ ุญุงู ุญุงุถุฑ ูฺ ุบุฐุง ุจุง ูุนุงุฑูุง ูุดุฎุต ุดุฏู ูุทุงุจูุช ูุฏุงุฑุฏ.')
    };

    const message = messages[currentLangCode] || messages['ar'];

    resultDiv.innerHTML = `<div class="${isReset ? 'noPrepMsg' : 'no-results'}">${message}</div>`;
}

// ====================================================================
// 3. ุฏูุงู ููุทู ุงููุฌุจุงุช (Meal Logic Helpers)
// ====================================================================

const suggestBtn = document.getElementById('suggestBtn');
const alternativeBtn = document.getElementById('alternativeBtn');
const confirmBtn = document.getElementById('confirmBtn');
const exitBtn = document.getElementById('exitBtn');
const noPrepMsg = document.getElementById('noPrepMsg');

let lastSuggestedMeal = null; 

/**
 * ูุญุฏุฏ ุนุงูู ุงูุถุฑุจ (ุงููุถุงุนู) ุจูุงุกู ุนูู ุงูุนุฏุฏ ุงููุฎุชุงุฑ ูู ูุงุฆูุฉ ุงููุนุงููุฑ.
 * @param {string} numberOfpeople ุงููููุฉ ุงููุฎุชุงุฑุฉ ูู ุงููุงุฆูุฉ.
 * @returns {number} ุงููุถุงุนู ุงูุฑููู.
 */
function getQuantityMultiplier(numberOfpeople) {
    switch (numberOfpeople) {
        case 'small': return 0.5; // 1 - 2 ุดุฎุต
        case 'medium': return 1; // 3 - 4 ุฃุดุฎุงุต (ุงูุฃุณุงุณ)
        case 'large': return 1.5; // 5 - 6 ุฃุดุฎุงุต
        case 'xlarge': return 2; // 7 - 8 ุฃุดุฎุงุต
        case 'xxlarge': return 2.5; // 9 - 11 ุฃุดุฎุงุต
        case 'max': return 3; // 12+ ุฃุดุฎุงุต
        default: return 1; 
    }
}

/**
 * ุชุญูู ุงูููุฏุงุฑ ุงูุฑููู ุฅูู ุชุนุจูุฑ ูุตู ุนููู (1.5 -> ููุจ ููุตู).
 * @param {number} quantity ุงููููุฉ ุงูุฑูููุฉ ุงููุญุณูุจุฉ.
 * @param {string} unitAr ุงููุญุฏุฉ ุงูุนุฑุจูุฉ ูููููู.
 * @returns {string} ุงูููุฏุงุฑ ุงูุฌุฏูุฏ ูุงููุญุฏุฉ ุงููุตูุฉ.
 */
/**
 * ุชุชุญูู ููุง ุฅุฐุง ูุงูุช ุงููุญุฏุฉ ูุคูุซุฉ.
 * @param {string} unitAr ุงููุญุฏุฉ ุงูุนุฑุจูุฉ.
 * @returns {boolean}
 */
function isUnitFeminine(unitAr) {
    // ูุงุฆูุฉ ุดุงุฆุนุฉ ูููุญุฏุงุช ุงููุคูุซุฉ
    const knownFeminine = ['ูุทุนุฉ', 'ููุนูุฉ', 'ุญุจุฉ', 'ุญุฒูุฉ','ูุฑุฉ', 'ูุญุฏุฉ']; 
    
    if (unitAr.endsWith('ุฉ') || knownFeminine.includes(unitAr)) {
        return true;
    }
    return false;
}

/**
 * ุชุญูู ุงูููุฏุงุฑ ุงูุฑููู ุฅูู ุชุนุจูุฑ ูุตู ุนููู (1.5 -> ููุจ ููุตู).
 * (ููุญุฏููุซุฉ ูุฏุนู ุงูุชุฃููุซ ูุงูุชุฐููุฑ ูููุนุช 'ูุงุญุฏ')
 * * @param {number} quantity ุงููููุฉ ุงูุฑูููุฉ ุงููุญุณูุจุฉ.
 * @param {string} unitAr ุงููุญุฏุฉ ุงูุนุฑุจูุฉ ูููููู.
 * @returns {string} ุงูููุฏุงุฑ ุงูุฌุฏูุฏ ูุงููุญุฏุฉ ุงููุตูุฉ.
 */
function convertToPracticalText(quantity, unitAr) {
    console.log(`\n--- ุจุฏุก ุงููุนุงูุฌุฉ ููููุฉ: ${quantity} ${unitAr} ---`);
    
    // ๐ 1. ุงูุชุญุถูุฑ ูุงูููุงุนุฏ ุงูุซุงุจุชุฉ
    
    // ุฏุงูุฉ ูุณุงุนุฏุฉ ููุญุตูู ุนูู ุงูููุฑุฏ
    function getSingularForm(unit) {
        // ๐จ ุฎุทูุฉ ุงูุชูุธูู ุงูุฌุฏูุฏุฉ: ุฅุฒุงูุฉ "ุงูุนุฏุฏ" ูุฃู ุฑููุฒ ูุฃููุงุณ
        let cleanedUnit = unit.replace(/ุงูุนุฏุฏ|\(|\)/g, '').trim();

        // ุงูุขู ูุทุจู ููุงุนุฏ ุงูููุฑุฏ ุนูู ุงููุญุฏุฉ ุงููุธููุฉ
        if (cleanedUnit === 'ุญุจุงุช') return 'ุญุจุฉ';
        if (cleanedUnit === 'ุฃููุงุจ') return 'ููุจ';
        if (cleanedUnit === 'ููุงุนู ูุจูุฑุฉ') return 'ููุนูุฉ ูุจูุฑุฉ';
        if (cleanedUnit === 'ููุงุนู ุตุบูุฑุฉ') return 'ููุนูุฉ ุตุบูุฑุฉ';
        if (cleanedUnit.includes('ุฃุฑุบูุฉ')) return cleanedUnit.replace('ุฃุฑุบูุฉ', 'ุฑุบูู');
        
        // ูู ุญุงูุฉ (ุฑุบูู)
        if (cleanedUnit.includes('ุฑุบูู') && cleanedUnit.length > 5) return 'ุฑุบูู';
        
        return cleanedUnit; // ุฅุฐุง ูู ููู ููุงู ุชุตุฑููุ ูุฑุฌุน ุงููุญุฏุฉ ุงููุธููุฉ
    }

    const unitSingular = getSingularForm(unitAr); // ุงูุญุตูู ุนูู ุงูููุฑุฏ ุงููุธูู
    
    if (unitAr.includes('ุฑุดุฉ') || unitAr === 'ุฑุดุฉ') {
        return 'ุฑุดุฉ ุญุณุจ ุงูุทูุจ';
    }

    const adjectiveOne = isUnitFeminine(unitSingular) ? 'ูุงุญุฏุฉ' : 'ูุงุญุฏ';
    
    // ุฏุงูุฉ ุชุตุฑูู ุงููุญุฏุฉ (ููุฌูุน: 3 ูุฃูุซุฑ)
    function getUnitForm(unit, count) { 
    // ูุทุจู ุงูุฌูุน ููุท ุฅุฐุง ูุงู ุงูุนุฏุฏ ุจูู 3 ู 10
    if (count >= 3 && count <= 10) { 
         if (unit === 'ุญุจุฉ') return 'ุญุจุงุช';
         if (unit === 'ููุจ') return 'ุฃููุงุจ';
         if (unit === 'ููุนูุฉ ูุจูุฑุฉ') return 'ููุงุนู ูุจูุฑุฉ'; 
         if (unit === 'ููุนูุฉ ุตุบูุฑุฉ') return 'ููุงุนู ุตุบูุฑุฉ';
         
         // ุชุนุฏูู ุญุต: ุงูุจุญุซ ุนู ุงููููุฉ ุณูุงุก ูุงูุช ุฏุงุฎู ุฃููุงุณ ุฃู ูุง
         if (unit.includes('ุญุต')) return unit.replace('ุญุต', 'ุญุตูุต'); 
         
         // ุชุนุฏูู ุฑุบูู
         if (unit.includes('ุฑุบูู')) return unit.replace('ุฑุบูู', 'ุฃุฑุบูุฉ'); 
    }
    
    // ุฅุฐุง ูุงู ุงูุนุฏุฏ 11 ูุฃูุซุฑุ ุฃู ุฃูู ูู 3ุ ูุนูุฏ ููููุฑุฏ ุชููุงุฆูุงู
    return unit; 
}

    const fractionsMap = [
        { value: 0.25, text: 'ุฑุจุน' }, { value: 0.5, text: 'ูุตู' }, 
        { value: 0.75, text: 'ุซูุงุซุฉ ุฃุฑุจุงุน' }, { value: 0.33, text: 'ุซูุซ' }, 
        { value: 0.66, text: 'ุซูุซูู' }
    ];

    // ๐ 2. ุญุงูุฉ ูููุฉ ุตุบูุฑุฉ ุฌุฏุงู (ุฑุดุฉ)
    if (unitSingular === 'ููุนูุฉ ุตุบูุฑุฉ' && quantity < 0.25) {
        return 'ุฑุดุฉ ุญุณุจ ุงูุทูุจ';
    }
    
    const integerPart = Math.floor(quantity);
    const fractionalPart = quantity - integerPart;

    let bestMatch = null;
    if (fractionalPart > 0.05) { 
        let minDiff = Infinity;
        fractionsMap.forEach(frac => {
            const diff = Math.abs(fractionalPart - frac.value);
            if (diff < minDiff) {
                minDiff = diff;
                bestMatch = frac;
            }
        });
    }

    console.log(`ุงูุฌุฒุก ุงูุตุญูุญ: ${integerPart}, ุงููุณุฑ ุงูููุฑุจ: ${bestMatch ? bestMatch.text : 'ูุง ููุฌุฏ'}, ุงููุญุฏุฉ ุงูููุฑุฏุฉ ุงูููุณุชุฎุฏูุฉ: ${unitSingular}`);
    
    let resultText = '';
    
   // 2. ุชุญุฏูุฏ ุงููุญุฏุฉ ุงูููุงุณุจุฉ ุจูุงุกู ุนูู ุงููููุฉ
// ุงูุชุนุฏูู: ูุณุชุฎุฏู ุงูุฌูุน ููุท ุฅุฐุง ูุงู ุงูุนุฏุฏ ุจูู 3 ู 10ุ ุบูุฑ ุฐูู ูุณุชุฎุฏู ุงูููุฑุฏ
const unitForPluralCount = (integerPart >= 3 && integerPart <= 10) 
    ? getUnitForm(unitSingular, 3) 
    : unitSingular;

// 3. ุจูุงุก ุงููุต: ุงูุชุนุงูู ูุน ุงูุฌุฒุก ุงูุตุญูุญ
if (integerPart >= 1) {
    
    if (integerPart === 1) { 
        // ุญุงูุฉ 1 ุฃู 1.x: (ูุซูุงู: ููุจ ุฃู 1.5 ููุจ)
        resultText += `${integerPart} ${unitSingular}`;
    } 
    else if (integerPart === 2) {
         // ุญุงูุฉ 2 ุฃู 2.x: ุงููุซูู ุฃู 2 + ุงูููุฑุฏ
         if (unitSingular === 'ุญุจุฉ') {
             resultText += `ุญุจุชุงู`;
         } else {
             resultText += `${integerPart} ${unitSingular}`;
         }
    }
    else {
        // ุญุงูุฉ 3 ููุง ููู: 
        // ุฅุฐุง ูุงู ุจูู 3-10 ุณูุฃุฎุฐ ุงูุฌูุน ูู unitForPluralCount
        // ุฅุฐุง ูุงู ุฃูุจุฑ ูู 10 ุณูุฃุฎุฐ ุงูููุฑุฏ ูู unitForPluralCount
        resultText += `${integerPart} ${unitForPluralCount}`; 
    }
}

    console.log(`ุงููุต ุจุนุฏ ูุนุงูุฌุฉ ุงูุฌุฒุก ุงูุตุญูุญ (${integerPart}): "${resultText}"`);
    
    // 4. ุจูุงุก ุงููุต: ุงูุชุนุงูู ูุน ุงูุฌุฒุก ุงููุณุฑู
    if (bestMatch) {
        
        if (integerPart === 1) {
             // ๐ ุญุงูุฉ 1.x: ุงูุงุฎุชุตุงุฑ (ุญุจุฉ ููุตู)
             resultText = `${unitSingular} ู${bestMatch.text}`;
        }
        else if (integerPart === 2) {
             // ุญุงูุฉ 2.x: ุญุจุชุงู ููุตู / ููุจุงู ูุฑุจุน
             let dualText = (unitSingular === 'ุญุจุฉ') ? 'ุญุจุชุงู' : `${integerPart} ${unitSingular}`;
             resultText = `${dualText} ู${bestMatch.text}`;
        }
        else if (integerPart >= 3) {
            // ุญุงูุฉ 3.x: ุงูุฑูู + ุงูุฌูุน + ู + ุงููุณุฑ
            resultText += ' ู';
            resultText += `${bestMatch.text.replace('ู', '')}`;
        } 
        else if (integerPart === 0) {
            // ุญุงูุฉ 0.x: ุงููุณุฑ + ุงูููุฑุฏ (ูุตู ููุนูุฉ)
            resultText += `${bestMatch.text.replace('ู', '')} ${unitSingular}`;
        }
        console.log(`ุงููุต ุจุนุฏ ูุนุงูุฌุฉ ุงููุณุฑ: "${resultText}"`);
    } 

    // 5. ุญุงูุงุช ุงูุญุตุฑ (ุงูุฃุนุฏุงุฏ ุงููุงููุฉ)
    if (resultText === '' && integerPart >= 1) {
        if (integerPart === 1) {
            resultText = `${unitSingular} ${adjectiveOne}`; // "ุญุจุฉ ูุงุญุฏุฉ"
        }
        else if (integerPart === 2) {
             resultText = (unitSingular === 'ุญุจุฉ') ? 'ุญุจุชุงู' : `${integerPart} ${unitSingular}`; 
        }
        else {
            resultText = `${integerPart} ${unitForPluralCount}`;
        }
        console.log(`ุงููุต ุจุนุฏ ูุนุงูุฌุฉ ุงูุฃุนุฏุงุฏ ุงููุงููุฉ: "${resultText}"`);
    }
    
    if (resultText === '' && integerPart === 0 && !bestMatch) {
        console.log('ุงููููุฉ ุตูุฑ.');
        return '';
    }

    // 6. ุงูุฅุฎุฑุงุฌ ุงูููุงุฆู
    const finalOutput = resultText.trim().replace(/\s+/g, ' ');
    console.log(`ุงูุฅุฎุฑุงุฌ ุงูููุงุฆู: "${finalOutput}"`);
    console.log(`----------------------------------`);
    return finalOutput;
}
// โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
// ๐ฅ ูุงููุณ ููููุงุช ุงูุจูุถ (ุบูุฑ ูุงุจูุฉ ููุชูุณูู)
// โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

const INDIVISIBLE_INGREDIENTS = [
    "ุจูุถ", "ุจูุถุฉ", "ุจูุถุงุช", "ุจูุถุชุงู", "ุจูุถุชูู"
];

/**
 * ูุชุญูู ุฅุฐุง ูุงู ุงููููู ูู ุงูุจูุถ.
 * @param {string} ingredientName ุงุณู ุงููููู ุจุงูุนุฑุจูุฉ.
 * @returns {boolean} true ุฅุฐุง ูุงู ุจูุถ.
 */
function isEggIngredient(ingredientName) {
    if (!ingredientName) return false;

    return INDIVISIBLE_INGREDIENTS.some(egg => ingredientName.includes(egg));
}

// โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
// ๐ ุฏุงูุฉ ุงูุงุญุชุณุงุจ ุงูููุนุฏูููุฉ
// โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

/**
 * ุชููู ุจุญุณุงุจ ุงููููุงุช ุงูุฌุฏูุฏุฉ ููููููุงุช ุจูุงุกู ุนูู ูุถุงุนู ูุนููุ
 * ูุชุฌุฑู ุชุญูููุงุช ุฐููุฉ ูููุญุฏุงุช (ูุซู ุชุญููู ูู ุฅูู ููุจ ุฃู ูุชุฑ) ูุชุณููู ุงููุฑุงุกุฉ.
 * * ุงูููุฒุฉ ุงูุฃุณุงุณูุฉ: ุชู ุฅุฒุงูุฉ ุดุฑุท ุงูุชุฌุงูุฒ (multiplier === 1) ูุถูุงู ุฃู ุญูู quantity
 * ูุญุชูู ุฏุงุฆูุงู ุนูู ุงููููุฉ ูุงููุญุฏุฉ ูุฏูุฌุชููุ ุญุชู ูู ุงููููุงุช ุงูุฃุณุงุณูุฉ.
 */
function calculateNewQuantities(meal, multiplier) {
    const TOAST_BREAD_WEIGHT_GRAMS = 35; // ูุฒู ุฑุบูู ุงูุฎุจุฒ ุงููุญูุต ุงูุชูุฑูุจู

    // ๐ ุชู ุฅุฒุงูุฉ ุงูุดุฑุท if (multiplier === 1) { return meal; }
    // ุงูุขูุ ุณููุฑ ุงููุถุงุนู 1 ุนุจุฑ ุนูููุฉ ุงููุนุงูุฌุฉ ูุถูุงู ุฏูุฌ ุงููููุฉ ูุงููุญุฏุฉ.

    const calculatedIngredients = meal.ingredients.map(ingredient => {
        // ุงุณุชุฎูุงุต ุงูุจูุงูุงุช ุงูุฃุณุงุณูุฉ
        let baseQuantity = ingredient.quantity;
        let baseUnit = ingredient.unit_ar;
        const ingredientName = ingredient.item_ar || "";

        // 1. ุชุทุจูู ุงููุถุงุนู
        // ุฅุฐุง ูุงู ุงููุถุงุนู = 1ุ ูุณุชุจูู newQuantity ููุง ูู.
        let newQuantity = baseQuantity * multiplier;

        // ๐ฅ ุชุฏููุฑ ุงูุจูุถ ููุนุฏุฏ ุงูุตุญูุญ ุงูุฃูุฑุจ (ูุง ููู ุนู 1)
        if (isEggIngredient(ingredientName)) {
            newQuantity = Math.max(1, Math.round(newQuantity));
        }

        // ๐ ุงูุชุญูู ูู "ุฎุจุฒ ูุญูุต" ูุชุญูููู ูู ูุฒู ุฅูู ุนุฏุฏ
        if (ingredientName && ingredientName.includes('ุฎุจุฒ ูุญูุต')) {
            let totalGrams = newQuantity;

            if (baseUnit === 'ูุบ' || baseUnit === 'ููููุบุฑุงู') {
                totalGrams *= 1000;
            }

            newQuantity = totalGrams / TOAST_BREAD_WEIGHT_GRAMS;
            baseUnit = 'ุงูุนุฏุฏ';
            baseUnit = `${baseUnit} (ุฑุบูู)`;
        }

        // 2. ุงูุชุญููู ูู "ูู" ุฅูู ูุญุฏุงุช ุนูููุฉ ุฃูุจุฑ (ููุจุ ููุนูุฉ ูุจูุฑุฉุ ูุชุฑ)
        if (baseUnit === 'ูู' || baseUnit === 'ููููุชุฑ') {
            baseUnit = 'ูู'; // ุชูุญูุฏ ุงูุงุณู ููุญุฏุฉ ูู

            if (newQuantity >= 1000) {
                newQuantity /= 1000;
                baseUnit = 'ูุชุฑ';
            }
            else if (newQuantity >= 240) {
                newQuantity /= 240;
                baseUnit = 'ููุจ';
            }
            else if (newQuantity >= 15) {
                newQuantity /= 15;
                baseUnit = 'ููุนูุฉ ูุจูุฑุฉ';
            }
            else if (newQuantity >= 5) {
                newQuantity /= 5;
                baseUnit = 'ููุนูุฉ ุตุบูุฑุฉ';
            }
        }

        // 3. ุงูุชุญููู ูู "ููุจ" ุฅูู "ูุชุฑ" ุฅุฐุง ูุงูุช ุงููููุฉ ูุจูุฑุฉ
        if (baseUnit === 'ููุจ' && newQuantity > 4) {
            newQuantity /= 4.166;
            baseUnit = 'ูุชุฑ';
        }

        // 4. ุชุทุจูู ุงูุชุญููู ุงููุตู (ุงููุณูุฑ ูุงูุชูุฑูุจ)
        // ๐ฅ ูุง ูุทุจู ุงููุณูุฑ ุนูู ุงูุจูุถ
        const finalOutputText = isEggIngredient(ingredientName)
            ? null
            : convertToPracticalText(newQuantity, baseUnit);

        if (finalOutputText) {
             return {
                 ...ingredient,
                 unit_ar: baseUnit,
                 quantity: finalOutputText // ูุซุงู: "ุญุจุฉ ููุตู" (ุงููุต ูุงูู)
             };
        } else {
             // ๐ ูุฐุง ุงููุณุงุฑ ูุชู ุชูููุฐู ุงูุขู ุญุชู ุนูุฏูุง ูููู ุงููุถุงุนู 1
             const finalQuantity = Math.round(newQuantity * 100) / 100;

             // ๐ฏ ุถูุงู ุฏูุฌ ุงููููุฉ ูุงููุญุฏุฉ ูู ุญูู quantity
             const finalDisplay = `${finalQuantity} ${baseUnit}`;

             return {
                 ...ingredient,
                 quantity: finalDisplay, // ูุซุงู: "1.0 ุฌุฑุงู" ุฃู "250 ุฌุฑุงู"
                 unit_ar: baseUnit
             };
        }
    });

    return {
        ...meal,
        ingredients: calculatedIngredients
    };
}

// โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
// ๐ข ูุธุงู ุงูุชุฑุฌูุฉ ุงูุญุณุงุจู ููููุงุฏูุฑ - ุงูุฅุตุฏุงุฑ ุงูููุตุญููุญ V2
// โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

const QuantityTranslator = {

    // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
    // ๐ ูุงููุณ ุงููุณูุฑ โ ูููุชูุง ุงูุนุฏุฏูุฉ
    // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
    fractions: {
        "ุฑุจุน": 0.25,
        "ุซูุซ": 0.33,
        "ูุตู": 0.5,
        "ุซูุซุง": 0.66,
        "ุซูุซู": 0.66,
        "ุซูุงุซุฉ ุฃุฑุจุงุน": 0.75,
    },

    // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
    // ๐ ุงูุฃุนุฏุงุฏ ุงูููุชูุจุฉ โ ูููุชูุง
    // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
    arabicNumbers: {
        "ูุงุญุฏ": 1, "ูุงุญุฏุฉ": 1,
        "ุงุซูุงู": 2, "ุงุซูุชุงู": 2, "ุงุซููู": 2, "ุงุซูุชูู": 2,
        "ุซูุงุซ": 3, "ุซูุงุซุฉ": 3,
        "ุฃุฑุจุน": 4, "ุฃุฑุจุนุฉ": 4,
        "ุฎูุณ": 5, "ุฎูุณุฉ": 5,
        "ุณุช": 6, "ุณุชุฉ": 6,
        "ุณุจุน": 7, "ุณุจุนุฉ": 7,
        "ุซูุงูู": 8, "ุซูุงู": 8, "ุซูุงููุฉ": 8,
        "ุชุณุน": 9, "ุชุณุนุฉ": 9,
        "ุนุดุฑ": 10, "ุนุดุฑุฉ": 10,
    },

    // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
    // ๐ ุงููุซูู โ ูููุชู (2) + ุงููุญุฏุฉ ุงูุฃุณุงุณูุฉ
    // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
    dualForms: {
        "ููุนูุชุงู ุตุบูุฑุชุงู": { value: 2, unit: "ููุนูุฉ ุตุบูุฑุฉ" },
        "ููุนูุชูู ุตุบูุฑุชูู": { value: 2, unit: "ููุนูุฉ ุตุบูุฑุฉ" },
        "ููุนูุชุงู ูุจูุฑุชุงู": { value: 2, unit: "ููุนูุฉ ูุจูุฑุฉ" },
        "ููุนูุชูู ูุจูุฑุชูู": { value: 2, unit: "ููุนูุฉ ูุจูุฑุฉ" },
        "ููุนูุชุงู": { value: 2, unit: "ููุนูุฉ ุตุบูุฑุฉ" },
        "ููุนูุชูู": { value: 2, unit: "ููุนูุฉ ุตุบูุฑุฉ" },
        "ููุจุงู": { value: 2, unit: "ููุจ" },
        "ููุจูู": { value: 2, unit: "ููุจ" },
        "ุญุจุชุงู": { value: 2, unit: "ุญุจุฉ" },
        "ุญุจุชูู": { value: 2, unit: "ุญุจุฉ" },
        "ูุตุงู": { value: 2, unit: "ูุต" },
        "ูุตูู": { value: 2, unit: "ูุต" },
        "ุฑุฃุณุงู": { value: 2, unit: "ุฑุฃุณ" },
        "ุฑุฃุณูู": { value: 2, unit: "ุฑุฃุณ" },
        "ุญุฒูุชุงู": { value: 2, unit: "ุญุฒูุฉ" },
        "ุญุฒูุชูู": { value: 2, unit: "ุญุฒูุฉ" },
        "ูุฑุตุชุงู": { value: 2, unit: "ูุฑุตุฉ" },
        "ูุฑุตุชูู": { value: 2, unit: "ูุฑุตุฉ" },
        "ุดุฑูุญุชุงู": { value: 2, unit: "ุดุฑูุญุฉ" },
        "ุดุฑูุญุชูู": { value: 2, unit: "ุดุฑูุญุฉ" },
        "ุฑุบููุงู": { value: 2, unit: "ุฑุบูู" },
        "ุฑุบูููู": { value: 2, unit: "ุฑุบูู" },
    },

    // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
    // ๐ฅ ุงููุญุฏุงุช ูุชุตุฑููุงุชูุง ุจูู ูุบุฉ - ููุญุฏููุซุฉ
    // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
    units: {
        "ููุนูุฉ ุตุบูุฑุฉ": {
            ar_variants: ["ููุนูุฉ ุตุบูุฑุฉ", "ููุงุนู ุตุบูุฑุฉ"],
            en: { singular: "teaspoon", plural: "teaspoons" },
            ru: { fractional: "ัะฐะนะฝะพะน ะปะพะถะบะธ", one: "ัะฐะนะฝะฐั ะปะพะถะบะฐ", few: "ัะฐะนะฝัะต ะปะพะถะบะธ", many: "ัะฐะนะฝัั ะปะพะถะตะบ" },
            fa: { base: "ูุงุดู ฺุงโุฎูุฑ" }
        },
        "ููุนูุฉ ูุจูุฑุฉ": {
            ar_variants: ["ููุนูุฉ ูุจูุฑุฉ", "ููุงุนู ูุจูุฑุฉ"],
            en: { singular: "tablespoon", plural: "tablespoons" },
            ru: { fractional: "ััะพะปะพะฒะพะน ะปะพะถะบะธ", one: "ััะพะปะพะฒะฐั ะปะพะถะบะฐ", few: "ััะพะปะพะฒัะต ะปะพะถะบะธ", many: "ััะพะปะพะฒัั ะปะพะถะตะบ" },
            fa: { base: "ูุงุดู ุบุฐุงุฎูุฑ" }
        },
        "ููุจ": {
            ar_variants: ["ููุจ", "ุฃููุงุจ"],
            en: { singular: "cup", plural: "cups" },
            ru: { fractional: "ััะฐะบะฐะฝะฐ", one: "ััะฐะบะฐะฝ", few: "ััะฐะบะฐะฝะฐ", many: "ััะฐะบะฐะฝะพะฒ" },
            fa: { base: "ูพูุงูู" }
        },
        "ูุฑูุฉ": {
            ar_variants: ["ูุฑูุฉ", "ูุฑูุงุช", "ุฃูุฑุงู", "ูุฑู"],
            en: { singular: "leaf", plural: "leaves" },
            ru: { fractional: "ะปะธััะฐ", one: "ะปะธัั", few: "ะปะธััะฐ", many: "ะปะธัััะตะฒ" },
            fa: { base: "ุจุฑฺฏ" }
        },
        "ุญุจุฉ": {
            ar_variants: ["ุญุจุฉ", "ุญุจุงุช", "ุญุจุฉ ุตุบูุฑุฉ", "ุญุจุฉ ูุจูุฑุฉ", "ุญุจุฉ ูุชูุณุทุฉ"],
            en: { singular: "piece", plural: "pieces" },
            ru: { fractional: "ัััะบะธ", one: "ัััะบะฐ", few: "ัััะบะธ", many: "ัััะบ" },
            fa: { base: "ุนุฏุฏ" }
        },
        "ูุต": {
            ar_variants: ["ุญุต","ุญุตูุต","ูุต", "ูุตูุต"],  // โ ุฅุถุงูุฉ "ุญุต"
            en: { singular: "clove", plural: "cloves" },
            ru: { fractional: "ะทัะฑัะธะบะฐ", one: "ะทัะฑัะธะบ", few: "ะทัะฑัะธะบะฐ", many: "ะทัะฑัะธะบะพะฒ" },
            fa: { base: "ุญุจู" }
        },
        "ุฑุฃุณ": {
            ar_variants: ["ุฑุฃุณ", "ุฑุคูุณ"],
            en: { singular: "head", plural: "heads" },
            ru: { fractional: "ะณะพะปะพะฒะบะธ", one: "ะณะพะปะพะฒะบะฐ", few: "ะณะพะปะพะฒะบะธ", many: "ะณะพะปะพะฒะพะบ" },
            fa: { base: "ุนุฏุฏ" }
        },
        "ุญุฒูุฉ": {
            ar_variants: ["ุญุฒูุฉ", "ุญุฒู", "ุจุงูุฉ", "ุฑุจุทุฉ"],
            en: { singular: "bunch", plural: "bunches" },
            ru: { fractional: "ะฟััะบะฐ", one: "ะฟััะพะบ", few: "ะฟััะบะฐ", many: "ะฟััะบะพะฒ" },
            fa: { base: "ุฏุณุชู" }
        },
        "ูุฑุตุฉ": {
            ar_variants: ["ูุฑุตุฉ", "ูุฑุตุงุช"],
            en: { singular: "pinch", plural: "pinches" },
            ru: { fractional: "ัะตะฟะพัะบะธ", one: "ัะตะฟะพัะบะฐ", few: "ัะตะฟะพัะบะธ", many: "ัะตะฟะพัะพะบ" },
            fa: { base: "ููฺฉ ูุงุดู" }
        },
        "ุฑุดุฉ": {  // โ ุฅุถุงูุฉ ูุญุฏุฉ ุฌุฏูุฏุฉ
            ar_variants: ["ุฑุดุฉ", "ุฑุดุงุช"],
            en: { singular: "dash", plural: "dashes" },
            ru: { fractional: "ัะตะฟะพัะบะธ", one: "ัะตะฟะพัะบะฐ", few: "ัะตะฟะพัะบะธ", many: "ัะตะฟะพัะพะบ" },
            fa: { base: "ฺฉู" }
        },
        "ุดุฑูุญุฉ": {
            ar_variants: ["ุดุฑูุญุฉ", "ุดุฑุงุฆุญ"],
            en: { singular: "slice", plural: "slices" },
            ru: { fractional: "ะปะพะผัะธะบะฐ", one: "ะปะพะผัะธะบ", few: "ะปะพะผัะธะบะฐ", many: "ะปะพะผัะธะบะพะฒ" },
            fa: { base: "ุจุฑุด" }
        },
        "ูุทุนุฉ": {
            ar_variants: ["ูุทุนุฉ", "ูุทุน"],
            en: { singular: "piece", plural: "pieces" },
            ru: { fractional: "ะบััะพัะบะฐ", one: "ะบััะพัะตะบ", few: "ะบััะพัะบะฐ", many: "ะบััะพัะบะพะฒ" },
            fa: { base: "ุชฺฉู" }
        },
        "ุฑุบูู": {  // โ ุฅุถุงูุฉ ูุญุฏุฉ ุฌุฏูุฏุฉ
            ar_variants: ["ุฑุบูู", "ุฃุฑุบูุฉ", "ุฎุจุฒุฉ"],
            en: { singular: "loaf", plural: "loaves" },
            ru: { fractional: "ะปะตะฟััะบะธ", one: "ะปะตะฟััะบะฐ", few: "ะปะตะฟััะบะธ", many: "ะปะตะฟััะตะบ" },
            fa: { base: "ูุงู" }
        },
        "ุบุฑุงู": {
            ar_variants: ["ุบุฑุงู", "ุบุฑุงูุงู", "ุฌุฑุงู", "ุฌุฑุงูุงู", "ุบ", "ุฌู"],
            en: { singular: "gram", plural: "grams" },
            ru: { fractional: "ะณัะฐะผะผะฐ", one: "ะณัะฐะผะผ", few: "ะณัะฐะผะผะฐ", many: "ะณัะฐะผะผะพะฒ" },
            fa: { base: "ฺฏุฑู" }
        },
        "ููููุบุฑุงู": {
            ar_variants: ["ููููุบุฑุงู", "ูููู", "ูุบ", "ูุฌู"],
            en: { singular: "kilogram", plural: "kilograms" },
            ru: { fractional: "ะบะธะปะพะณัะฐะผะผะฐ", one: "ะบะธะปะพะณัะฐะผะผ", few: "ะบะธะปะพะณัะฐะผะผะฐ", many: "ะบะธะปะพะณัะฐะผะผะพะฒ" },
            fa: { base: "ฺฉููฺฏุฑู" }
        },
        "ูุชุฑ": {
            ar_variants: ["ูุชุฑ", "ููุชุฑ", "ูุชุฑุงุช"],
            en: { singular: "liter", plural: "liters" },
            ru: { fractional: "ะปะธััะฐ", one: "ะปะธัั", few: "ะปะธััะฐ", many: "ะปะธััะพะฒ" },
            fa: { base: "ูุชุฑ" }
        },
  "ูู": {
    ar_variants: ["ูููุชุฑ", "ูููููุชุฑ", "ููู"],  // โ ุญุฐูุช "ูู" ูุฃููุง ุชุชุถุงุฑุจ ูุน "ููุนูุฉ"
    en: { singular: "ml", plural: "ml" },
    ru: { fractional: "ะผะป", one: "ะผะป", few: "ะผะป", many: "ะผะป" },
    fa: { base: "ููโูุชุฑ" }
},
    },

    // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
    // ๐ข ุฑููุฒ ุงููุณูุฑ ููุนุฑุถ
    // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
    fractionSymbols: {
        0.25: "ยผ", 0.33: "โ", 0.5: "ยฝ", 0.66: "โ", 0.75: "ยพ",
        1.25: "1ยผ", 1.33: "1โ", 1.5: "1ยฝ", 1.66: "1โ", 1.75: "1ยพ",
        2.25: "2ยผ", 2.33: "2โ", 2.5: "2ยฝ", 2.66: "2โ", 2.75: "2ยพ",
        3.25: "3ยผ", 3.33: "3โ", 3.5: "3ยฝ", 3.66: "3โ", 3.75: "3ยพ",
        4.5: "4ยฝ", 4.25: "4ยผ", 4.75: "4ยพ",
        5.5: "5ยฝ", 6.5: "6ยฝ", 7.5: "7ยฝ", 8.5: "8ยฝ", 9.5: "9ยฝ",
    },

    // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
    // โ๏ธ ุฏูุงู ุงูุชุตุฑูู ุญุณุจ ุงููุบุฉ
    // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

    getEnglishForm(quantity, unitData) {
        return (quantity === 1) ? unitData.singular : unitData.plural;
    },

    getRussianForm(quantity, unitData) {
        if (quantity < 1) return unitData.fractional;

        const intPart = Math.floor(quantity);
        const hasFraction = (quantity !== intPart);

        // ุฅุฐุง ูุงู ููุงู ูุณุฑุ ูุณุชุฎุฏู ุตูุบุฉ ุงูุฌุฑ (ุงููุถุงู ุฅููู)
        if (hasFraction) return unitData.fractional;

        const lastDigit = intPart % 10;
        const lastTwoDigits = intPart % 100;

        if (lastTwoDigits >= 11 && lastTwoDigits <= 14) return unitData.many;
        if (lastDigit === 1) return unitData.one;
        if (lastDigit >= 2 && lastDigit <= 4) return unitData.few;
        return unitData.many;
    },

    getPersianForm(quantity, unitData) {
        return unitData.base;
    },

    formatNumber(num, lang) {
        const roundedNum = Math.round(num * 100) / 100;
        if (this.fractionSymbols[roundedNum]) {
            return this.fractionSymbols[roundedNum];
        }
        if (Number.isInteger(num)) {
            return String(num);
        }
        // ููุฃุนุฏุงุฏ ุงูุนุดุฑูุฉ ุจุฏูู ุฑูุฒ ูุณุฑ
        return (lang === 'ru') ? String(roundedNum).replace('.', ',') : String(roundedNum);
    },

    // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
    // ๐ฏ ุงูุฏุงูุฉ ุงูุฑุฆูุณูุฉ: ุชุฑุฌูุฉ ููุฏุงุฑ ูุงูู
    // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
    translate(quantity, unitKey, lang) {
        const unitData = this.units[unitKey];
        if (!unitData || !unitData[lang]) return null;

        const formattedNum = this.formatNumber(quantity, lang);
        let unitForm;

        switch (lang) {
            case 'en': unitForm = this.getEnglishForm(quantity, unitData.en); break;
            case 'ru': unitForm = this.getRussianForm(quantity, unitData.ru); break;
            case 'fa': unitForm = this.getPersianForm(quantity, unitData.fa); break;
            default: return null;
        }

        return `${formattedNum} ${unitForm}`;
    },
};

// โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
// ๐ ูุญูู ุงููุต ุงูุนุฑุจู - ุงูุฅุตุฏุงุฑ ุงูููุตุญููุญ V3 (ุฅุตูุงุญ ูุดููุฉ ุงููุญุฏุงุช ุงูุฌุฒุฆูุฉ)
// โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

const ArabicQuantityParser = {

    parse(text) {
        let quantity = 0;
        let unit = null;
        let remaining = String(text || '').trim();
        let foundNumber = false;
        let foundUnit = false;

        console.log(`[Parser] Input: "${remaining}"`);

        // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
        // 1. ุงูุจุญุซ ุนู ุฑูู ูู ุงูุจุฏุงูุฉ
        // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
        const numMatch = remaining.match(/^(\d+(?:[.,]\d+)?)\s*/);
        if (numMatch) {
            quantity = parseFloat(numMatch[1].replace(',', '.'));
            remaining = remaining.slice(numMatch[0].length).trim();
            foundNumber = true;
            console.log(`[Parser] Found number: ${quantity}, remaining: "${remaining}"`);
        }

        // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
        // 2. ุงูุจุญุซ ุนู ูุณุฑ ูู ุงูุจุฏุงูุฉ (ูุตูุ ุฑุจุนุ ุซูุงุซุฉ ุฃุฑุจุงุน)
        // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
        const sortedFractions = Object.keys(QuantityTranslator.fractions).sort((a, b) => b.length - a.length);
        for (const fracWord of sortedFractions) {
            if (remaining.startsWith(fracWord)) {
                quantity += QuantityTranslator.fractions[fracWord];
                remaining = remaining.slice(fracWord.length).trim();
                foundNumber = true;
                console.log(`[Parser] Found leading fraction: ${fracWord}, quantity now: ${quantity}`);
                break;
            }
        }

        // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
        // 3. ุงูุจุญุซ ุนู ุงููุซูู (ููุนูุชุงู ุตุบูุฑุชุงูุ ููุจุงูุ ุฅูุฎ)
        // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
        const sortedDuals = Object.keys(QuantityTranslator.dualForms).sort((a, b) => b.length - a.length);
        for (const dualWord of sortedDuals) {
            if (remaining.includes(dualWord)) {
                const dualData = QuantityTranslator.dualForms[dualWord];
                if (!foundNumber) quantity = dualData.value;
                else quantity += dualData.value;
                unit = dualData.unit;
                remaining = remaining.replace(dualWord, '').trim();
                foundNumber = true;
                foundUnit = true;
                console.log(`[Parser] Found dual: ${dualWord}, unit: ${unit}, quantity: ${quantity}`);
                break;
            }
        }

        // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
        // 4. โ ุชุญุฏูุฏ ุงููุญุฏุฉ (ูุน ุญูุงูุฉ ูู ุงููุทุงุจูุฉ ุงูุฌุฒุฆูุฉ)
        // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
        if (!foundUnit) {
            // ุฌูุน ูู ุงููุญุฏุงุช ูุน variants
            const allVariants = [];
            for (const unitKey in QuantityTranslator.units) {
                const unitData = QuantityTranslator.units[unitKey];
                for (const variant of unitData.ar_variants) {
                    allVariants.push({ variant, unitKey });
                }
            }
            // โ ุชุฑุชูุจ ูู ุงูุฃุทูู ููุฃูุตุฑ (ููู ุฌุฏุงู!)
            allVariants.sort((a, b) => b.variant.length - a.variant.length);

            for (const { variant, unitKey } of allVariants) {
                // โ ุงุณุชุฎุฏุงู regex ููุชุฃูุฏ ูู ุฃู ุงููุญุฏุฉ ูููุฉ ูุงููุฉ ูููุณุช ุฌุฒุก ูู ูููุฉ
                const regex = new RegExp(`(^|\\s)(${variant})($|\\s|ู)`, 'u');
                const match = remaining.match(regex);

                if (match) {
                    unit = unitKey;
                    // ุฅุฒุงูุฉ ุงููุญุฏุฉ ููุท (ูุน ุงูุญูุงุธ ุนูู ุงููุณุงูุงุช)
                    remaining = remaining.replace(match[2], ' ').trim();
                    foundUnit = true;
                    console.log(`[Parser] Found unit: ${unitKey} (from variant: "${variant}")`);
                    break;
                }
            }
        }

        // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
        // 5. ุฅุฐุง ูุฌุฏูุง ูุญุฏุฉ ููู ูุฌุฏ ุฑููุ ุงููููุฉ ุงูุงูุชุฑุงุถูุฉ = 1
        // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
        if (foundUnit && !foundNumber) {
            quantity = 1;
            foundNumber = true;
            console.log(`[Parser] No number found, defaulting to 1`);
        }

        // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
        // 6. ุงูุจุญุซ ุนู "ููุตู" ุฃู "ูุฑุจุน" ูู ุงููุต ุงููุชุจูู
        // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
        const suffixFractions = {
            "ูุซูุงุซุฉ ุฃุฑุจุงุน": 0.75,
            "ููุตู": 0.5,
            "ูุฑุจุน": 0.25,
            "ูุซูุซ": 0.33,
        };
        for (const [suffix, value] of Object.entries(suffixFractions)) {
            if (remaining.includes(suffix)) {
                quantity += value;
                remaining = remaining.replace(suffix, '').trim();
                console.log(`[Parser] Found suffix fraction: ${suffix}, quantity now: ${quantity}`);
                break;
            }
        }

        // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
        // 7. โ ุฅุฒุงูุฉ ุงูุตูุงุช ุงููุชุจููุฉ ูู remaining (ููุชูุธูู ููุท)
        // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
        const descriptors = ["ุตุบูุฑุฉ", "ูุจูุฑุฉ", "ูุชูุณุทุฉ", "ูุงุญุฏุฉ", "ูุงุญุฏ", "ุทุงุฒุฌุฉ", "ููุฑููุฉ", "ููุทุนุฉ"];
        for (const desc of descriptors) {
            remaining = remaining.replace(new RegExp(desc, 'g'), '').trim();
        }

        console.log(`[Parser] Final: quantity=${quantity}, unit=${unit}, remaining="${remaining}"`);

        return { quantity, unit, unparsed: remaining.trim() };
    },

    translateText(arabicText, lang) {
        const parsed = this.parse(arabicText);

        if (!parsed.unit) {
            console.log(`[SmartTranslator] โ๏ธ ูู ูุชู ุงูุชุนุฑู ุนูู ุงููุญุฏุฉ ูู: "${arabicText}"`);
            return null;
        }

        const finalQuantity = parsed.quantity || 1;
        const translated = QuantityTranslator.translate(finalQuantity, parsed.unit, lang);

        if (!translated) {
            console.log(`[SmartTranslator] โ๏ธ ูุดู ูู ุชุฑุฌูุฉ: "${arabicText}"`);
            return null;
        }

        console.log(`[SmartTranslator] โ "${arabicText}" โ "${translated}"`);
        return translated;
    }
};

// โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
// ๐ฝ๏ธ ุฏุงูุฉ ุงูุชุฑุฌูุฉ ุงูุฑุฆูุณูุฉ ุงูููุธูุฉ ูุงููุงููุฉ
// โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
/**
 * ุชูุชุฑุฌู ูุฌุจุฉ ุงูุทุนุงู ุจุงููุงูู (ุงูุงุณูุ ุงูุชุญุถูุฑุ ุงูููููุงุชุ ุงูููุงุฏูุฑ) ุฅูู ุงููุบุฉ ุงููุฏู.
 * ุชุนุชูุฏ ุนูู ูุธุงู ุงูุชุฑุฌูุฉ ุงูุฐูู ูููููุงุช ูุงููุญุฏุงุช ูุฃููููุฉุ ุซู ุนูู ุงูููุงููุณ ุงููุฏููุฉ (ุงููุธุงู ุงููุฏูู) ูุฎุทุฉ ุงุญุชูุงุทูุฉ.
 */
function translateMeal(meal, currentLangCode) {

    // 1. ููุทู ุงููุบุฉ ุงูุนุฑุจูุฉ: ููุฑุฌุน ุงูุจูุงูุงุช ุงูุฃุตููุฉ
    if (currentLangCode === 'ar') {
        let preparation = meal.preparation_ar;
        const preparationSteps = Array.isArray(preparation) ? preparation : (preparation ? [preparation] : []);
        return {
            ...meal,
            name: meal.name_ar || meal.name,
            preparation: preparationSteps,
        };
    }

    // ุงูุชุญูู ูู ุชููุฑ ุจูุงูุงุช ุงูุชุฑุฌูุฉ
    if (typeof translations === 'undefined' || !translations[currentLangCode]) {
        // ุงูุนูุฏุฉ ุฅูู ุงูุนุฑุจูุฉ ูู ุญุงู ุนุฏู ุชููุฑ ุงูุชุฑุฌูุฉ
        return { ...meal, name: meal.name_ar, preparation: meal.preparation_ar };
    }

    // 2. ููุทู ุงููุบุงุช ุงูุฃุฎุฑู (ุงูุฃุฌูุจูุฉ)
    const langSuffix = '_' + currentLangCode;
    const translatedMeal = { ...meal };

    // ุชุฑุฌูุฉ ุงูุงุณู ูุทุฑููุฉ ุงูุชุญุถูุฑ
    const translatedNameField = 'name' + langSuffix;
    translatedMeal.name = translatedMeal[translatedNameField] || translatedMeal.name_ar;

    const translatedPreparationField = 'preparation' + langSuffix;
    let preparationData = meal[translatedPreparationField] || meal.preparation_ar;
    translatedMeal.preparation = Array.isArray(preparationData) ? preparationData : (preparationData ? [preparationData] : []);

    // 3. ุชุฑุฌูุฉ ุงูููููุงุช ูุงููุญุฏุงุช ูุงูููุงุฏูุฑ
    if (meal.ingredients && meal.ingredients.length > 0) {

        translatedMeal.ingredients = meal.ingredients.map((originalIng) => {

            // ุชุฑุฌูุฉ ุงุณู ุงููููู
            const itemField = 'item' + langSuffix;
            const translatedItem = originalIng[itemField] || originalIng.item_ar;

            const originalQuantityValue = originalIng.quantity;
            let translatedQuantity = (originalQuantityValue != null) ? String(originalQuantityValue) : "";

            if (translatedQuantity) {

                // ๐ ุงููุญุงููุฉ ุงูุฃููู: ุงููุธุงู ุงูุญุณุงุจู ุงูุฐูู
                const smartTranslation = ArabicQuantityParser.translateText(translatedQuantity, currentLangCode);

                if (smartTranslation) {
                    // โ ูุฌุญ ุงููุธุงู ุงูุฐูู
                    translatedQuantity = smartTranslation;
                }
                else {
                    // ๐ ุงูุฎุทุฉ ุงูุจุฏููุฉ: ุงููุธุงู ุงููุฏูู (ุงูููุงููุณ ุงููุฏููุฉ)

                    const targetLangData = translations[currentLangCode];
                    const arabicLangData = translations.ar;

                    const targetQuantifiers = targetLangData.quantifiers || {};
                    const arabicQuantifiers = arabicLangData.quantifiers || {};
                    const targetUnitsMap = targetLangData.units || {};
                    const arabicUnitsMap = arabicLangData.units || {};
                    const targetDescriptors = targetLangData.descriptors || {};
                    const arabicDescriptors = arabicLangData.descriptors || {};

                    let textToTranslate = String(originalQuantityValue || '').trim();
                    const replacementMap = {};

                    // ุฏูุฌ ุงูููุงุฏูุฑุ ุงูุตูุงุชุ ูุงููุญุฏุงุช (ุจูุงุก ุฎุฑูุทุฉ ุงูุงุณุชุจุฏุงู)
                    for (const key in arabicQuantifiers) {
                        const arabicValue = arabicQuantifiers[key];
                        const targetValue = targetQuantifiers[key];
                        if (arabicValue && targetValue) replacementMap[arabicValue] = targetValue;
                    }
                    for (const key in arabicDescriptors) {
                        const arabicValue = arabicDescriptors[key];
                        const targetValue = targetDescriptors[key];
                        if (arabicValue && targetValue) replacementMap[arabicValue] = targetValue;
                    }
                    for (const key in arabicUnitsMap) {
                        const arabicValue = arabicUnitsMap[key];
                        const targetValue = targetUnitsMap[key];
                        if (arabicValue && targetValue) replacementMap[arabicValue] = targetValue;
                    }

                    // ุงูุฅุถุงูุงุช ุงููุฏููุฉ ูุงููุตูุงุช
                    if (targetQuantifiers['ูุตู']) replacementMap['ูุตู'] = targetQuantifiers['ูุตู'];
                    if (targetQuantifiers['ุฑุจุน']) replacementMap['ุฑุจุน'] = targetQuantifiers['ุฑุจุน'];
                    if (targetQuantifiers['ุซูุซ']) replacementMap['ุซูุซ'] = targetQuantifiers['ุซูุซ'];
                    if (targetQuantifiers['ุซูุซูู']) replacementMap['ุซูุซูู'] = targetQuantifiers['ุซูุซูู'];
                    if (targetQuantifiers['ุซูุงุซุฉ ุฃุฑุจุงุน']) replacementMap['ุซูุงุซุฉ ุฃุฑุจุงุน'] = targetQuantifiers['ุซูุงุซุฉ ุฃุฑุจุงุน'];
                    if (targetDescriptors['ูุชูุณุทุฉ']) replacementMap['ูุชูุณุทุฉ'] = targetDescriptors['ูุชูุณุทุฉ'];
                    if (targetDescriptors['ุตุบูุฑุฉ']) replacementMap['ุตุบูุฑุฉ'] = targetDescriptors['ุตุบูุฑุฉ'];
                    if (targetDescriptors['ูุจูุฑุฉ']) replacementMap['ูุจูุฑุฉ'] = targetDescriptors['ูุจูุฑุฉ'];
                    if (targetDescriptors['ูุงุญุฏุฉ']) replacementMap['ูุงุญุฏุฉ'] = targetDescriptors['ูุงุญุฏุฉ'];

                    replacementMap['ู'] = targetLangData.linkers?.AND || 'and'; // ูุตูุฉ "ู"

                    // ุงูุชุฑุฌูุงุช ุงูุฎุงุตุฉ ุจุงูุนุจุงุฑุงุช ุงูุซุงุจุชุฉ ููู ูุบุฉ
                    if (currentLangCode === 'ru') {
                        replacementMap['ุญุณุจ ุงูุทูุจ'] = 'ะฟะพ ะฒะบััั';
                        replacementMap['ูู ูู ููุน'] = 'ะธะท ะบะฐะถะดะพะณะพ ะฒะธะดะฐ';
                        replacementMap['ููุชุฒููู'] = 'ะดะปั ัะบัะฐัะตะฝะธั';
                        replacementMap['ุญุณุจ ุงูุฑุบุจุฉ'] = 'ะฟะพ ะถะตะปะฐะฝะธั';
                    } else if (currentLangCode === 'fa') {
                        replacementMap['ุญุณุจ ุงูุทูุจ'] = 'ุจู ูุฒุงู ุฏูุฎูุงู';
                        replacementMap['ูู ูู ููุน'] = 'ุงุฒ ูุฑ ููุน';
                        replacementMap['ููุชุฒููู'] = 'ุจุฑุง ุชุฒู';
                        replacementMap['ุญุณุจ ุงูุฑุบุจุฉ'] = 'ุจู ุฏูุฎูุงู';
                    } else { // EN ุฃู ุบูุฑูุง
                        replacementMap['ุญุณุจ ุงูุทูุจ'] = targetLangData.descriptors?.TO_TASTE || 'to taste';
                        replacementMap['ูู ูู ููุน'] = targetLangData.descriptors?.VARIETY || 'of each';
                        replacementMap['ููุชุฒููู'] = 'for garnish';
                        replacementMap['ุญุณุจ ุงูุฑุบุจุฉ'] = 'as desired';
                    }

                    // ุชูููุฐ ุงูุงุณุชุจุฏุงู ุจุงุณุชุฎุฏุงู RegEx
                    const sortedArabicWords = Object.keys(replacementMap).sort((a, b) => b.length - a.length);

                    try {
                        let paddedText = ' ' + textToTranslate + ' ';

                        for (const arabicWord of sortedArabicWords) {
                            const targetWord = replacementMap[arabicWord];
                            const arabicWordEscaped = arabicWord.replace(/[-\/\\^$*+?.()|[\]{}]/g, '\\$&');
                            // ุงูุจุญุซ ุนู ุงููููุฉ ูุญุงุทุฉ ุจูุณุงูุงุช ูุถูุงู ุนุฏู ุงุณุชุจุฏุงู ุฌุฒุก ูู ูููุฉ ุฃูุจุฑ
                            const regex = new RegExp(`\\s${arabicWordEscaped}\\s`, 'g');
                            paddedText = paddedText.replace(regex, ` ${targetWord} `);
                        }

                        translatedQuantity = paddedText.replace(/\s+/g, ' ').trim(); // ุชูุธูู ุงููุณุงูุงุช ุงูุฒุงุฆุฏุฉ

                    } catch (error) {
                        console.error(`[Critical Error] Failed on translating quantity (Legacy). Error: ${error.message}`);
                        translatedQuantity = String(originalQuantityValue || '').trim();
                    }
                }
            }

            // ุฅุฑุฌุงุน ุงููุงุฆู ูุน ุงูุงุณู ูุงููููุฉ ุงููุชุฑุฌูุฉ
            return {
                ...originalIng,
                item: translatedItem,
                quantity: translatedQuantity,
            };
        });
    }

    return translatedMeal;
}


function showKeyErrorModal() {
    const errorMsg = `
        <div style="text-align: right; color: #c0392b; font-weight: bold;">
            ุนุฐุฑุงู ุณูุฏุชูุ ููุชุงุญ ุงูุชูุนูู ุงูุฐู ุฃุฏุฎูุชูู ุบูุฑ ุตุญูุญ. 
            <br> ูุฑุฌู ุงูุชุฃูุฏ ูู ุงูุฑูุฒ ูุงููุญุงููุฉ ูุฑุฉ ุฃุฎุฑู.
        </div>`;

    // ุงุณุชุฏุนุงุก ุงูุฏุงูุฉ ุงูุฃุณุงุณูุฉ (ููุฑุฑ true ููุจูู ุญูู ุงูุฅุฏุฎุงู ุธุงูุฑุงู)
    updateModalContent("โ", "ุฎุทุฃ ูู ุงูุชูุนูู", errorMsg, true);

    // ุฅุธูุงุฑ ุฒุฑ ูุงุญุฏ ูุฅุนุงุฏุฉ ุงููุญุงููุฉ
    const closeBtn = document.querySelector('.btn-close') || document.getElementById('closeModalBtn');
    if (closeBtn) {
        closeBtn.style.display = 'block';
        closeBtn.innerText = "ุฅุนุงุฏุฉ ุงููุญุงููุฉ";
    }
}

// =================================================================
// 1. ุงูุฏูุงู ุงูููุงุฆูุฉ ูููุทู ุงูุนุฏุงุฏ ูุงูุชุฑููุฉ
// =================================================================

// =================================================================
// 1. ุงูุฏุงูุฉ ุงูุฃุณุงุณูุฉ ูุฅุธูุงุฑ ุงูููุงูุฐ (ูุฌุจ ุฃู ุชููู ูู ุงูุฃุนูู)
// =================================================================
function updateModalContent(icon, title, message, showKey) {
    const modal = document.getElementById('customModal');
    const modalIcon = document.getElementById('modalIcon');
    const modalTitle = document.getElementById('modalTitle');
    const modalMessage = document.getElementById('modalMessage');
    const proSection = document.getElementById('proKeySection');

    if (!modal) {
        console.error("โ ุฎุทุฃ: ุนูุตุฑ customModal ุบูุฑ ููุฌูุฏ ูู HTML");
        return;
    }

    // 1. ุชุญุฏูุซ ุงููุตูุต (ุงุณุชุฎุฏุงู innerHTML ูุถูุงู ุชูุณูู ุงูุฑุณุงุฆู ุงูุทูููุฉ)
    if (modalIcon) modalIcon.innerText = icon;
    if (modalTitle) modalTitle.innerText = title;
    if (modalMessage) modalMessage.innerHTML = message; 

    // 2. ุงูุชุญูู ูู ูุณู ููุชุงุญ ุงูุชูุนูู
    if (proSection) {
        proSection.style.display = showKey ? 'block' : 'none';
    }

    // 3. ๐ก๏ธ ุชุตููุฑ ุงูุฃุฒุฑุงุฑ (ุฅุฎูุงุก ุงูุฌููุน ูุจู ุฅุธูุงุฑ ุงููุทููุจ)
    const allButtons = modal.querySelectorAll('.modal-buttons button');
    allButtons.forEach(btn => {
        btn.style.display = 'none'; 
    });

    // 4. ุฅุธูุงุฑ ุงูููุฏุงู
    modal.style.display = 'flex';
    console.log(`%c ๐ข ุชู ุฅุธูุงุฑ ุงููุงูุฐุฉ ุจูุฌุงุญ: ${title}`, "color: white; background: green;");
}

// =================================================================
// 2. ุฏูุงู ุงุณุชุฏุนุงุก ุงูุชูุจููุงุช
// =================================================================
 
const activationMessages = {
    ar: "ููุฏ ุฃูุดูุช ูุฑุญูุฉ ุงูุงุณุชุฎุฏุงู ุงููุฌุงูู ุนูู ุงูุงูุชูุงุก! ุจูู ูุฏููู ุงุฎุชูุงุฑุงู ููุท.",
    en: "The free trial period is about to end! You only have two choices left.",
    ru: "ะะตัะฟะปะฐัะฝัะน ะฟัะพะฑะฝัะน ะฟะตัะธะพะด ะฟะพะดัะพะดะธั ะบ ะบะพะฝัั! ะฃ ะฒะฐั ะพััะฐะปะพัั ะฒัะตะณะพ ะดะฒะฐ ะฒะฐัะธะฐะฝัะฐ.",
    fa: "ุฏูุฑู ุขุฒูุงุด ุฑุงฺฏุงู ุฑู ุจู ูพุงุงู ุงุณุช! ููุท ุฏู ุงูุชุฎุงุจ ุฏฺฏุฑ ุฏุงุฑุฏ."
};
    

function showPreLimitWarning() {
    // ุฌูุจ ููุฏ ุงููุบุฉ ุงูุญุงูู ูู ุงููุชุตูุญ (ar, en, ru, fa)
    const lang = document.documentElement.lang || 'ar';
    
    // ุงุฎุชูุงุฑ ุงูุฑุณุงูุฉ ุงูููุงุณุจุฉ ุจูุงุกู ุนูู ุงููุบุฉ
    const msg = activationMessages[lang] || activationMessages['ar'];

    // ูุตูุต ุซุงุจุชุฉ ููุนูุงููู ูุงูุฃุฒุฑุงุฑ ุญุณุจ ุงููุบุฉ
    let title = "ุณูุฏุชู ุงููุญุชุฑูุฉุ";
    let btnText = "ุงูุนูุฏุฉ ุฅูู ุงูุชุทุจูู";
    const isRTL = (lang === 'ar' || lang === 'fa');

    if (lang === 'en') {
        title = "!Dear Madam";
        btnText = "Back to App";
    } else if (lang === 'ru') {
        title = "!ะฃะฒะฐะถะฐะตะผะฐั ะณะพัะฟะพะถะฐ";
        btnText = "ะะตัะฝััััั ะบ ะฟัะธะปะพะถะตะฝะธั";
    } else if (lang === 'fa') {
        title = "ุจุงูู ฺฏุฑุงูุ";
        btnText = "ุจุงุฒฺฏุดุช ุจู ุจุฑูุงูู";
    }

    // ุจูุงุก ุงููุญุชูู ูุน ุถุจุท ุงูุงุชุฌุงู ูุงููุญุงุฐุงุฉ
    const messageHtml = `
        <div class="activation-modal-font" style="direction: ${isRTL ? 'rtl' : 'ltr'}; text-align: ${isRTL ? 'right' : 'left'};">
            ${msg}
        </div>`;

    // ุฅุธูุงุฑ ุงููุงูุฐุฉ
    updateModalContent(" ", title, messageHtml, false);

    // ุถุจุท ุฒุฑ ุงูุฅุบูุงู
    const closeBtn = document.querySelector('.btn-close');
    if (closeBtn) {
        closeBtn.innerText = btnText;
        closeBtn.style.display = 'block';
    }
}

const giftMessages = {
    ar:  "ุณูุฏุชู ุงููุญุชุฑูุฉ. ุญุฑุตุง ููุง ุนูู ุชุณููู ุงูุงููุฑ ุนูููู ุณูู ูููู ุจุงุถุงูุฉ ูุญุงููุชูู ูุฌุงููุชูู ููู ูุนุทููู ุงูููุช ุงููุงูู ููุญุตูู ุนูู ููุชุงุญ ุชูุนูู ุงููุณุฎุฉ ุงููุฏููุนุฉ ูุชุทุจูู  <b>ุดู ุนุงููู ุฃููุ</b>  ูุญู ุจุงูุชุธุงุฑู.",
    en: ` To make things easier for you, we have added two extra free attempts. This gives you time to obtain the activation key for the <b>"Whatโs Cooking?"</b> app. We look forward to having you with us.`,
    ru: `ยซะฃะฒะฐะถะฐะตะผะฐั ะณะพัะฟะพะถะฐ. ะงัะพะฑั ะพะฑะปะตะณัะธัั ะฒะฐะผ ะทะฐะดะฐัั, ะผั ะดะพะฑะฐะฒะธะผ ะดะฒะต ะฑะตัะฟะปะฐัะฝัะต ะฟะพะฟััะบะธ, ััะพะฑั ั ะฒะฐั ะฑัะปะพ ะดะพััะฐัะพัะฝะพ ะฒัะตะผะตะฝะธ ะดะปั ะฟะพะปััะตะฝะธั ะบะปััะฐ ะฐะบัะธะฒะฐัะธะธ ะฟะปะฐัะฝะพะน ะฒะตััะธะธ ะฟัะธะปะพะถะตะฝะธั <b>"ะงัะพ ะผั ะฟัะธะณะพัะพะฒะธะผ?"</b>.`,
    fa:" ุฎุงูู ูุญุชุฑู. ุจุฑุง ุขุณุงูโุชุฑ ฺฉุฑุฏู ฺฉุงุฑูุง ุจุฑุง ุดูุงุ ุฏู ูุฑุญููโ ุฑุงฺฏุงู ุงุถุงูู ุฎูุงูู ฺฉุฑุฏ ุชุง ุฒูุงู ฺฉุงู ุจุฑุง ุฏุฑุงูุช ฺฉูุฏ ูุนุงูโุณุงุฒ ูุณุฎูโ ูพูู ุจุฑูุงููโ <b>ฺ ูโูพุฒุ </b> ุฏุงุดุชู ุจุงุดุฏ. ููุชุธุฑ ุดูุง ูุณุชู.",
};

function showGracePeriodModal() {
    // ุฌูุจ ููุฏ ุงููุบุฉ ุงูุญุงูู
    const lang = document.documentElement.lang || 'ar';
    
    // ุงุฎุชูุงุฑ ุงูุฑุณุงูุฉ ูุงูุนููุงู ูุงูุฒุฑ ุจูุงุกู ุนูู ุงููุบุฉ
    const msg = giftMessages[lang] || giftMessages['ar'];
    const isRTL = (lang === 'ar' || lang === 'fa');

    let title = "ูุฏูุฉ ููู";
    let btnText = "ุดูุฑุงูุ ุงูุนูุฏุฉ ููุชุทุจูู";

    if (lang === 'en') {
        title = "Dear Madam";
        btnText = "Thanks, Back to App";
    } else if (lang === 'ru') {
        title = "ะะพะดะฐัะพะบ";
        btnText = "ะกะฟะฐัะธะฑะพ, ะฒะตัะฝััััั";
    } else if (lang === 'fa') {
        title = "ูุฏู ุจุฑุง ุดูุง";
        btnText = "ูููููุ ุจุงุฒฺฏุดุช";
    }

    const messageHtml = `
        <div class="activation-modal-font" style="direction: ${isRTL ? 'rtl' : 'ltr'}; text-align: ${isRTL ? 'right' : 'left'};">
            ${msg}
        </div>`;

    // ุฅุธูุงุฑ ุงููุงูุฐุฉ ูุน ุฃููููุฉ ุงููุฏูุฉ ๐
    updateModalContent(" ", title, messageHtml, false);
 
    // ุชูุนูู ุฒุฑ ุงูุฅุบูุงู ุจูุต ูุฎุตุต
    const closeBtn = document.querySelector('.btn-close');
    if (closeBtn) {
        closeBtn.innerText = btnText;
        closeBtn.style.display = 'block';
    }
}

const upgradeMessages = {
    ar: "ููุฏ ุงุณุชููุฏุชู ุฌููุน ุงููุญุงููุงุช ุงููุฌุงููุฉ. ูุฑุฌู ุฅุฏุฎุงู ููุชุงุญ ุงูุชูุนูู ููุงุณุชูุฑุงุฑ ูู ุงูุงุณุชูุงุฏุฉ ูู ูุงูุฉ ููุฒุงุช ุงูุชุทุจูู.",
    en: "You have exhausted all free attempts. Please enter the activation key to continue enjoying the full features of the app.",
    ru: "ะั ะธััะตัะฟะฐะปะธ ะฒัะต ะฑะตัะฟะปะฐัะฝัะต ะฟะพะฟััะบะธ. ะะพะถะฐะปัะนััะฐ, ะฒะฒะตะดะธัะต ะบะปัั ะฐะบัะธะฒะฐัะธะธ, ััะพะฑั ะฟัะพะดะพะปะถะธัั ะฟะพะปัะทะพะฒะฐัััั ะฒัะตะผะธ ััะฝะบัะธัะผะธ ะฟัะธะปะพะถะตะฝะธั.",
    fa: "ุชูุงู ูุฑุตุชโูุง ุฑุงฺฏุงู ุดูุง ุจู ูพุงุงู ุฑุณุฏู ุงุณุช. ูุทูุงู ุจุฑุง ุงุฏุงูู ุงุณุชูุงุฏู ุงุฒ ุชูุงู ุงูฺฉุงูุงุช ุจุฑูุงููุ ฺฉูุฏ ูุนุงูโุณุงุฒ ุฑุง ูุงุฑุฏ ฺฉูุฏ."
};
function displayUpgradePrompt() {
    // ุฌูุจ ููุฏ ุงููุบุฉ ุงูุญุงูู
    const lang = document.documentElement.lang || 'ar';
    
    // ุงุฎุชูุงุฑ ุงูุฑุณุงูุฉ ูุงูุนููุงู ุจูุงุกู ุนูู ุงููุบุฉ
    const msg = upgradeMessages[lang] || upgradeMessages['ar'];
    const isRTL = (lang === 'ar' || lang === 'fa');

    let title = "ุณูุฏุชู !";
    if (lang === 'en') title = "Dear Madam,";
    else if (lang === 'ru') title = "ะฃะฒะฐะถะฐะตะผะฐั ะณะพัะฟะพะถะฐ!";
    else if (lang === 'fa') title = "ุจุงูู ฺฏุฑุงูุ";

    const messageHtml = `
        <div class="activation-modal-font" style="direction: ${isRTL ? 'rtl' : 'ltr'}; text-align: ${isRTL ? 'right' : 'left'};">
            ${msg}
        </div>`;

    // ุงุณุชุฏุนุงุก ุงูููุฏุงู ูุน ุฃููููุฉ ุงูููู ๐ 
    // ููุงุญุธุฉ: ูุฑุณู true ูู ุงููุนุงูู ุงูุฑุงุจุน ูุฅุธูุงุฑ ุญูู ุฅุฏุฎุงู ุงูููุฏ
    updateModalContent(" ", title, messageHtml, true);

    // ูู ูุฐู ุงูุฑุณุงูุฉุ ูุง ูุฑูุฏ ุฒุฑ ุฅุบูุงู (ูุฃู ุงูุชุทุจูู ูููู)
    const closeBtn = document.querySelector('.btn-close');
    if (closeBtn) {
        closeBtn.style.display = 'none';
    }
}
// =================================================================
// 3. ุฏุงูุฉ ุงููุญุต ุงูุฐูู (ุงููุญุฑู ุงูุฑุฆูุณู)
// =================================================================

function checkLimitAndIncrement() {
    const isPro = localStorage.getItem(PRO_VERSION_KEY) === 'true';
    if (isPro) return true;

    let count = parseInt(localStorage.getItem(FREE_USES_KEY) || '0', 10);
    const graceUsed = localStorage.getItem(GRACE_PERIOD_KEY) === 'true';

    console.log(`%c ๐ก๏ธ ูุญุต ุตุงุฑู - ุงูุนุฏุงุฏ: ${count}`, "color: blue; font-weight: bold;");

    // 1. ุงูููู ุงูููุงุฆู (ุนูุฏ 12) - ููุง ููุท ูุณุชุฎุฏู return false ูููุน ุงูุฎุฏูุฉ
    if (count >= 12) {
        displayUpgradePrompt(); // ุณุชุณุชุฎุฏู ุงูุฑุณุงูุฉ ุงูุชูููุฏูุฉ ุงูุชู ุฃุนุฏุฏูุงูุง
        return false;
    }

    // 2. ููุญุฉ ุงููุญุงููุฉ 10 (ุชุธูุฑ ูุฑุฉ ูุงุญุฏุฉ ููุท)
    if (count === 10 && !graceUsed) {
        showGracePeriodModal(); // ุณุชุณุชุฎุฏู ุงูุฑุณุงูุฉ ุงูุชูููุฏูุฉ
        localStorage.setItem(GRACE_PERIOD_KEY, 'true'); // โ ุชูุนูู ุงูููู ููุฑุงู ูููุน ุงูุชูุฑุงุฑ
        // โ๏ธ ุญุฐููุง return false ูู ููุง ููุณูุญ ููุนุฏุงุฏ ุจุงูุฒูุงุฏุฉ ูููุญุงููุฉ 11
    }

    // 3. ุชูุจูู ุงููุญุงููุฉ 8
    if (count === 8) {
        showPreLimitWarning(); // ุณุชุณุชุฎุฏู ุงูุฑุณุงูุฉ ุงูุชูููุฏูุฉ
    }

    // 4. ุฒูุงุฏุฉ ุงูุนุฏุงุฏ (ูุฐุง ุงูุฌุฒุก ูุงู ููููู ุนูุฏ ุงูุฑูู 10 ุณุงุจูุงู)
    count++;
    localStorage.setItem(FREE_USES_KEY, count.toString());
    updateSuggestButtonState();
    return true;
}

/**
 * ูุณู ุชูุนูู ุงููุณุฎุฉ ุงููุฏููุนุฉ - ูุชูุงูู ูุน ูุธุงู ุงูุญูุงูุฉ ุงูุฎุงุต ุจูู
 */

// 1. ุงุณุชุฎุฏุงู ููุณ ุงูุซูุงุจุช ุงูุฎุงุตุฉ ุจูู ูุถูุงู ุงูุฑุจุท ุงูุตุญูุญ
const PRO_VERSION_KEY_APP = 'mealApp_isProVersion'; // ูุฌุจ ุฃู ูุทุงุจู PRO_VERSION_KEY ูู ุฏุงูุฉ suggestMeal


// ูุตูููุฉ ุงูุจุตูุงุช (Hashes) ููููุงุชูุญ ุงูุฅุถุงููุฉ ูุถูุงู ุงูุฃูุงู


// 2. ุฏุงูุฉ ุงูุชุดููุฑ
function generateHash(str) {
    let hash = 0;
    for (let i = 0; i < str.length; i++) {
        const char = str.charCodeAt(i);
        hash = ((hash << 5) - hash) + char;
        hash = hash & hash;
    }
    return String(Math.abs(hash));
}
// 3. ุฃุฏุงุฉ ุงูุฅุฏุงุฑุฉ ุงููุณุชุฏุงูุฉ (ุชูุณุชุฏุนู ูู ุงููููุณูู ุฏุงุฆูุงู)
window.createNewSecureKey = function(plainKey) {
    const hash = generateHash(plainKey);
    console.log("%c-----------------------------------------", "color: #27ae60");
    console.log("%c๐ ูููุฏ ุงูููุงุชูุญ ุงูุขูู", "font-weight: bold; font-size: 14px;");
    console.log("ุงูููุชุงุญ ุงููุตู: " + plainKey);
    console.log("ุงูุจุตูุฉ ุงููุทููุจ ูุถุนูุง ูู ุงููุตูููุฉ: " + hash);
    console.log("%c-----------------------------------------", "color: #27ae60");
};

// 4. ูุงูุฐุฉ ุงููุฌุงุญ ูุงูุนูุฏุฉ ุงูุชููุงุฆูุฉ ููุถุน ุงููุฌุจุงุช
function showSuccessWithCountdown() {
    let timeLeft = 5;
    const successTitle = "ุชู ุงูุชูุนูู ุจูุฌุงุญ!";
    
    const getSuccessMsg = (seconds) => `
        <div class="activation-modal-font"> 
            <span class="text-success-custom">ุดูุฑุงู ูุซูุชูู ุจูุง ุณูุฏุชู.</span>
            <br>
            ุชู ุชูุนูู ุงููุณุฎุฉ ุงููุงููุฉ ุจูุฌุงุญ.
            <br><br>
            ุณูุชู ุนุฑุถ ุงููุฌุจุฉ ุฎูุงู <b style="color: #e67e22;">${seconds}</b> ุซูุงูู...
        </div>`;

    updateModalContent("โ", "ุชู ุงูุชูุนูู", getSuccessMsg(timeLeft), false);
    document.querySelectorAll('.modal-buttons button').forEach(btn => btn.style.display = 'none');

    const timer = setInterval(() => {
        timeLeft--;
        const msgElement = document.getElementById('modalMessage');
        if (msgElement) {
            msgElement.innerHTML = getSuccessMsg(timeLeft);
        }

        if (timeLeft <= 0) {
            clearInterval(timer);
            
            // ุฅุบูุงู ุงููุงูุฐุฉ
            const modal = document.getElementById('customModal');
            if (modal) modal.style.display = 'none';

            // ุฅุนุงุฏุฉ ุถุจุท ูุงุฌูุฉ ุงูุฃุฒุฑุงุฑ ูุถูุงู ุธููุฑ ุฒุฑ ุงูุงูุชุฑุงุญ ุฃู ุงูุจุฏุงุฆู
            const suggestBtn = document.getElementById('suggestBtn');
            if (suggestBtn) suggestBtn.style.display = 'block';

            // ุชุดุบูู ูุญุฑู ุงูุงูุชุฑุงุญุงุช ุงูุฎุงุต ุจูู ููุฑุงู
            if (typeof suggestMeal === "function") {
                console.log("๐ ุชุดุบูู ุงูุงูุชุฑุงุญ ุงูุฃูู ุจุนุฏ ุงูุชูุนูู...");
                suggestMeal(); 
            } else {
                // ุญู ุงุญุชูุงุทู: ุฅุนุงุฏุฉ ุชุญููู ุงูุตูุญุฉ ูุชุญุฏูุซ ุงูุญุงูุฉ
                location.reload();
            }
        }
    }, 1000);
}

// 5. ูุงูุฐุฉ ุงูุฎุทุฃ
function showKeyErrorModal() {
    const errorMsg = `
        <div style="text-align: right; color: #c0392b; font-weight: bold;">
            ุนุฐุฑุงู ุณูุฏุชูุ ููุชุงุญ ุงูุชูุนูู ุบูุฑ ุตุญูุญ. 
            <br> ูุฑุฌู ุงููุญุงููุฉ ูุฑุฉ ุฃุฎุฑู ุฃู ุงูุชูุงุตู ูุน ุงูุฏุนู.
        </div>`;

    updateModalContent("โ", "ุฎุทุฃ ูู ุงูุชูุนูู", errorMsg, true);

    const closeBtn = document.querySelector('.btn-close') || document.getElementById('closeModalBtn');
    if (closeBtn) {
        closeBtn.style.display = 'block';
        closeBtn.innerText = "ุฅุนุงุฏุฉ ุงููุญุงููุฉ";
    }
}

// 5. ูุงูุฐุฉ ุงููุฌุงุญ ูุน ุฅุนุงุฏุฉ ุงูุถุจุท ุงูุชููุงุฆู
function showSuccessWithCountdown() {
    let timeLeft = 5;
    const successTitle = "ุชู ุงูุชูุนูู ุจูุฌุงุญ!";
    
    const getSuccessMsg = (seconds) => `
        <div style="text-align: center; line-height: 1.8;">
            ุดูุฑุงู ูุซูุชูู ุจูุง ุณูุฏุชู. ุชู ุชูุนูู ุงููุณุฎุฉ ุงููุงููุฉ ุจูุฌุงุญ.
            <br>
            <span style="font-size: 1.2em; color: #27ae60;">ุงุณุชูุชุนู ุงูุขู ุจูุงูุฉ ุงููููุฒุงุช.</span>
            <br><br>
            ุณูุชู ูุชุญ ุงูุงูุชุฑุงุญุงุช ุฎูุงู <b>${seconds}</b> ุซูุงูู...
        </div>`;

    // ุฅุฎูุงุก ูุณู ุฅุฏุฎุงู ุงูููุชุงุญ ููุฑุงู ูููุน ุงูุชุดุชุช
    const proKeySection = document.getElementById('proKeySection');
    if (proKeySection) proKeySection.style.display = 'none';

    // ุชุญุฏูุซ ุงููุญุชูู ูุฅุฎูุงุก ุงูุฃุฒุฑุงุฑ
    updateModalContent("โ", successTitle, getSuccessMsg(timeLeft), false);

    // ุฅุฎูุงุก ุฌููุน ุงูุฃุฒุฑุงุฑ ุฏุงุฎู ุงูููุฏุงู ููุฑูุฒ ุงููุณุชุฎุฏู ุนูู ุงูุฑุณุงูุฉ
    document.querySelectorAll('.modal-content button').forEach(btn => btn.style.display = 'none');

    const timer = setInterval(() => {
        timeLeft--;
        const msgElement = document.getElementById('modalMessage');
        if (msgElement) {
            msgElement.innerHTML = getSuccessMsg(timeLeft);
        }

        if (timeLeft <= 0) {
            clearInterval(timer);
            closeModal();

            const mainBtn = document.getElementById('suggestBtn');
            if (mainBtn) mainBtn.style.display = 'block';

            if (typeof suggestMeal === "function") {
                suggestMeal();
            } else {
                location.reload(); 
            }
        }
    }, 2000);
}

// 6. ุฏุงูุฉ ุฅุบูุงู ุงูููุฏุงู (ููุชุฃูุฏ ูู ุงุฎุชูุงุก ุงูุฎูููุฉ ุงูุฑูุงุฏูุฉ)
function closeModal() {
    const modal = document.getElementById('customModal');
    if (modal) {
        modal.style.display = 'none';
    }
}
/**
 * ุชุญุฏูุซ ุญุงูุฉ ุฒุฑ ุงูุงูุชุฑุงุญ ุจูุงุกู ุนูู ุงูุนุฏุงุฏ
 */
function updateSuggestButtonState() {
    const suggestBtn = document.getElementById('suggestBtn');
    if (!suggestBtn) return;
    
    const lang = document.documentElement.lang || 'ar'; // ุฑุตุฏ ุงููุบุฉ ุนูุฏ "ุจุงุจ ุงูุทุงุญูู"
    const isPro = localStorage.getItem(PRO_VERSION_KEY) === 'true';
    let count = parseInt(localStorage.getItem(FREE_USES_KEY) || '0', 10);
    
    // ูุงููุณ ุณุฑูุน ููุญุงูุงุช (ุฃู ุงุณุชุฎุฏูู ูุงููุณู ุงูุนุงู)
    const btnTexts = {
        ar: { pro: 'ุงุถุบุทู ููุง ูุงูุชุฑุญ ุนูููู ูุฌุจุฉ', locked: 'ุงูุชูุช ูุญุงููุงุชูู ุงููุฌุงููุฉ! (ุงุถุบุทู ููุชูุนูู)', normal: 'ุงุถุบุทู ููุง ูุงูุชุฑุญ ุนูููู ูุฌุจุฉ', remain: 'ูุญุงููุฉ ูุชุจููุฉ' },
        en: { pro: 'Click here to suggest a meal', locked: 'Free attempts exhausted! (Click to activate)', normal: 'Click here to suggest a meal', remain: 'attempts left' },
        ru: { pro: 'ะะฐะถะผะธัะต, ััะพะฑั ะฟัะตะดะปะพะถะธัั ะฑะปัะดะพ', locked: 'ะะตัะฟะปะฐัะฝัะต ะฟะพะฟััะบะธ ะธััะตัะฟะฐะฝั!', normal: 'ะะฐะถะผะธัะต ะทะดะตัั', remain: 'ะฟะพะฟััะพะบ ะพััะฐะปะพัั' },
        fa: { pro: 'ุจุฑุง ูพุดููุงุฏ ุบุฐุง ุงูุฌุง ุฑุง ฺฉูฺฉ ฺฉูุฏ', locked: 'ูุฑุตุชโูุง ุฑุงฺฏุงู ุชูุงู ุดุฏ!', normal: 'ุงูุฌุง ุฑุง ฺฉูฺฉ ฺฉูุฏ', remain: 'ูุฑุตุช ุจุงูโูุงูุฏู' }
    };

    const t = btnTexts[lang] || btnTexts['ar'];

    if (isPro) {
        suggestBtn.disabled = false;
        suggestBtn.textContent = t.pro;
        suggestBtn.style.backgroundColor = ""; // ุงูุนูุฏุฉ ูููู ุงูุทุจูุนู
    } else if (count >= 12) {
        suggestBtn.disabled = false; 
        suggestBtn.textContent = t.locked;
        suggestBtn.style.backgroundColor = "#ff4d4d"; 
    } else {
        suggestBtn.disabled = false;
        // ููุง ูุฏูุฌ ุงููุต ุงููุชุฑุฌู ูุน ุงูุฑูู ุงููุญุณูุจ
        suggestBtn.textContent = `${t.normal} (${12 - count} ${t.remain})`;
        suggestBtn.style.backgroundColor = ""; 
    }
}

// =================================================================
// 0. ุงูุชููุฆุฉุ ุงูุซูุงุจุชุ ูุงููุชุบูุฑุงุช ุงูุฑุฆูุณูุฉ
//    (ูุฌุจ ุฃู ุชููู ูุฐู ุงููุชุบูุฑุงุช ูู ุงููุทุงู ุงูุนุงู ูุฌููุน ุงูุฏูุงู)
// =================================================================

// 1. ุงุณุชุฏุนุงุก ุงููููุงุช (ูุฌุจ ุฃู ูููู ูุฏ ุชู ูู ุงูุฃุนูู)
   // 2. ุงูุฏูุฌ ูู ุงููุชุบูุฑ ุงูุฐู ูุจุญุซ ุนูู ุงููุญุฑู (meals ูู ุงูุงุณู ุงููุฑุฌุญ)
   const meals = [
   ...(typeof meals1 !== 'undefined' ? meals1 : []),
   ...(typeof meals2 !== 'undefined' ? meals2 : []),
   ...(typeof meals3 !== 'undefined' ? meals3 : []),
   ...(typeof meals4 !== 'undefined' ? meals4 : [])
   ];

   // 3. ุงูุชุญูู ูู ุงููุฌุงุญ ูู Console
   if (meals.length > 0) {
   console.log("โ ูุงุนุฏุฉ ุงูุจูุงูุงุช ุฌุงูุฒุฉ ููุญููุฉ. ุงูุนุฏุฏ: " + meals.length);
   } else {
   console.error("โ ูุดู ุชุญููู ูุงุนุฏุฉ ุงูุจูุงูุงุช. ุชุฃูุฏ ูู ุชุนุฑูู meals1, meals2, meals3");
   }
// ูุชุบูุฑุงุช ุญุงูุฉ ุงูุชุทุจูู ุงูุนุงูููุฉ (Global State Variables) - ุฅุฐุง ูุงูุช ุบูุฑ ููุฌูุฏุฉ ูุฏูู

window.currentSuggestedMeal = null;
window.suggestedMealsHistory = [];
window.lastFilteredMeals = [];
window.originalMealData = null;
window.currentMultiplier = 1;

// --- ุงูุซูุงุจุช ุงูุฃุณุงุณูุฉ ---
const MAX_FREE_USES = 12;
const FREE_USES_KEY = 'mealApp_freeUsesCount';
const PRO_VERSION_KEY = 'mealApp_isProVersion';
const GRACE_PERIOD_KEY = 'mealApp_graceUsed';


// ==========================================
// ูุญุฏุฉ ุงูุฃูุงู ูุงูุชูุนูู (Security & Activation Module)
// ==========================================

// 1. ุงูุซูุงุจุช ุงูุฃูููุฉ
const SECRET_SALT = "Shoamli_Secure_2026_#";
const VALID_KEYS_HASHES = ["49c60063d93b6891b8bfc1ddb673234551c3e6a481c9e23580235e4dc225d03f", "cc674705316778da9ec619ff7c83a4d5df92e822d3bf04d5c6a38ab570e32c11", "e2c3ff58cf62c3748fd2d8454365849a42dbb88fd98172c4108c4a25f31a7375", "97863d3f89f71ed86541e431e676321b520c0cef755ccdd30af6000c551aa5b7", "6a621b8925d275d0ae56409efb88b95d0644ce2e8f5914140bc95e763cc9a5e1", "12f7e0f3a366f937b7ad9422f16b817a8bcc393b76decab6aadcac772f3475f7", "332458c62067e16e4b32cc1e90889f9bfe28f3fdc72804966aa9ae6895427f2b", "2d265cb9c8e26717dd88c120bca3620406499a0070064322e53b86781d4d1d60", "5748d157bfeea82e819eb59d5634520f43e4a3c3a4524eefec8550f227628767", "40b60c423d474f0e0681411f1128cfc7f22e2f76f351e10744c2b1b169b66cc2", "1fda00126bf81bc0654ebe1fbf369d29f3c77ea588b672a5a57eba29a7d542cb", "b8009d24c71bc985d40fb152876d8ccf861da8f4fce83dfc3abf8220b06ccf6f"];

/**
 * ุฏุงูุฉ ุชุดููุฑ ุงููุตูุต ุจุงุณุชุฎุฏุงู SHA-256 ูุน ุฅุถุงูุฉ ุงูููุญ ุงูุณุฑู
 */
async function generateSecureHash(text) {
    console.log("๐ ุชุดููุฑ ุงููุต...");
    const encoder = new TextEncoder();
    const data = encoder.encode(text.trim() + SECRET_SALT);
    const hashBuffer = await crypto.subtle.digest('SHA-256', data);
    const hashArray = Array.from(new Uint8Array(hashBuffer));
    return hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
}

/**
 * ุงูุฏุงูุฉ ุงููุณุคููุฉ ุนู ูุญุต ูุญุงููุฉ ุงูุชูุนูู ุนูุฏ ุงูุถุบุท ุนูู ุงูุฒุฑ
 */
function handleActivationAttempt() {
    console.log("๐ ูุญุงููุฉ ุชูุนูู ( handleActivationAttempt )");
    const isPro = localStorage.getItem(PRO_VERSION_KEY) === 'true';

    if (isPro) {
        alert("ุงูุชุทุจูู ููุนู ุจุงููุนู.");
        return;
    }

    // ุฅุธูุงุฑ ูุงูุฐุฉ ุฅุฏุฎุงู ุงูููุฏ (ุชุฃูุฏู ุฃู ูุฐู ุงูุฏุงูุฉ ููุฌูุฏุฉ ูุฏููู ูุฅุธูุงุฑ ุงูููุฏุงู)
    showActivationPrompt();
}

/**
 * ุงูุฏุงูุฉ ุงูููุงุฆูุฉ ููุชุญูู ูู ุงูููุฏ ุงููุฏุฎู ูููุงุฑูุชู ุจุงููุงุด
 */
async function handleKeyActivation() {
    console.log("๐ ุฌุงุฑู ุงูุชุญูู ูู ุงูููุชุงุญ...");
    const inputField = document.getElementById('proKeyInput');

    if (!inputField) {
        console.error("โ ูู ูุชู ุงูุนุซูุฑ ุนูู ุนูุตุฑ ุงูุฅุฏุฎุงู 'proKeyInput'");
        return;
    }

    const userInput = inputField.value.trim();
    if (!userInput) {
        alert("ูุทูุงูุ ุฃุฏุฎูู ุงูููุชุงุญ.");
        return;
    }

    const userHash = await generateSecureHash(userInput);
    console.log("ุงููุงุด ุงููุงุชุฌ:", userHash);

    if (VALID_KEYS_HASHES.includes(userHash)) {
        console.log("โ ุชุทุงุจู! ุชูุนูู ุงููุณุฎุฉ PRO");
        localStorage.setItem(PRO_VERSION_KEY, 'true');

        // ููุง ูุณุชุฏุนู ูุงูุฐุฉ ุงููุฌุงุญ ุงูุฃุตููุฉ ุงูุฎุงุตุฉ ุจูู
        if (typeof showSuccessWithCountdown === "function") {
            showSuccessWithCountdown();
        } else {
            // ุญู ุงุญุชูุงุทู ูู ุญุงู ูุงูุช ุงูุฏุงูุฉ ุจุงุณู ูุฎุชูู
            alert("โ ุชู ุงูุชูุนูู ุจูุฌุงุญ! ุณูุชู ุชุญุฏูุซ ุงูุชุทุจูู.");
            location.reload();
        }
    }

// ==========================================

    // ููุทู ูุชุฑุฉ ุงูุณูุงุญ
    const newCount = MAX_FREE_USES - 2;
    localStorage.setItem(FREE_USES_KEY, newCount.toString());
    localStorage.setItem(GRACE_PERIOD_KEY, 'true');

    const graceMessage = "ุณูุฏุชู ุงููุญุชุฑูุฉ. ุญุฑุตุง ููุง ุนูู ุชุณููู ุงูุงููุฑ ุนูููู ุณูู ูููู ุจุงุถุงูุฉ ูุญุงููุชูู ูุฌุงููุชูู ููู ูุนุทููู ุงูููุช ุงููุงูู ููุญุตูู ุนูู ููุชุงุญ ุงูุชูุนูู ูููุณุฎุฉ ุงููุฏููุนุฉ ูุชุทุจูู : ุดู ุนุงููู ุงููุ ูุญู ุจุงูุชุธุงุฑู.";
    showGracePeriodModal(graceMessage);
}

/**
 * ุนุฑุถ ูุงูุฐุฉ ุฅุฏุฎุงู ุงูููุชุงุญ
 */
async function showActivationPrompt() {
    const userKey = prompt("ุงูุฑุฌุงุก ุฅุฏุฎุงู ููุชุงุญ ุงูุชูุนูู ุงูุฎุงุต ุจู:");
    if (userKey) {
        await activateApp(userKey.trim());
    }
}

/**
 * ุฏุงูุฉ ุงูุชูุนูู ูุงูุชุญูู (ุงูููุทู ุงูุฌุฏูุฏ)
 */
async function activateApp(enteredKey) {
    // ุชุดููุฑ ูุง ุฃุฏุฎูู ุงููุณุชุฎุฏู ูููุงุฑูุชู ุจุงููุงุดุงุช ุงููุญููุฉ
    const userHash = await generateSecureHash(enteredKey);

    if (VALID_KEYS_HASHES.includes(userHash)) {
        // ูุฌุงุญ ุงูุชูุนูู
        localStorage.setItem(PRO_VERSION_KEY, 'true');
        // ุชุฎุฒูู ุงููุงุด ูุฏููู ุชูุนูู (ุจุฏูุงู ูู ุงูููุชุงุญ ุงูุตุงูู)
        localStorage.setItem('mealApp_activationProof', userHash);

        updateSuggestButtonState();
        alert("ุชู ุงูุชูุนูู ุจูุฌุงุญ! ุดูุฑุงู ูู.");
    } else {
        alert("ุงูููุชุงุญ ุบูุฑ ุตุญูุญ. ูุฑุฌู ุงูุชุฃูุฏ ูู ุงูููุชุงุญ ูุงููุญุงููุฉ ูุฌุฏุฏุงู.");
    }
}

// =================================================================
// 2. ุฏุงูุฉ returnToFilterView (ุงูุนูุฏุฉ ุงูุชููุงุฆูุฉ)
// =================================================================

/**
 * ุฏุงูุฉ ูุชูููุฐ ุงูุนูุฏุฉ ุงูุชููุงุฆูุฉ ุฅูู ุงููุงุฌูุฉ ุงูุฃุณุงุณูุฉ (ูุงุฌูุฉ ุงูููุชุฑุฉ)
 */
function returnToFilterView() {
    // ุฌูุจ ุงูุนูุงุตุฑ ุงูุฎูุณุฉ
    const suggestBtn = document.getElementById('suggestBtn');
    const alternativeBtn = document.getElementById('alternativeBtn');
    const exitBtn = document.getElementById('exitBtn');
    const confirmBtn = document.getElementById('confirmBtn');
    const noPrepMsg = document.getElementById('noPrepMsg'); // ุงูุชุฃูุฏ ูู ุนุฏู ูุฌูุฏ ูุณุงูุฉ ููุง

    // ุชุญุฏูุซ ุงูุธููุฑ (ุฅุธูุงุฑ ุนูุงุตุฑ ุงูุจุฏุงูุฉ)
    if (suggestBtn) suggestBtn.style.display = 'block';
    if (noPrepMsg)  noPrepMsg.style.display = 'block';

    // ุฅุฎูุงุก ุนูุงุตุฑ ุงููุชูุฌุฉ
    if (alternativeBtn) alternativeBtn.style.display = 'none';
    if (exitBtn)        exitBtn.style.display = 'none';
    if (confirmBtn)     confirmBtn.style.display = 'none';
    
    // ููุง ุชูุณู ุงุณุชุฏุนุงุก ุชุญุฏูุซ ุงููุบุฉ ูุถูุงู ุจูุงุก ุงููุตูุต ุตุญูุญุฉ ุนูุฏ ุงูุนูุฏุฉ
    updateSuggestButtonState();
}


/**
 * @function suggestMeal
 * ุงูุฏุงูุฉ ุงูุฑุฆูุณูุฉ ูุงูุชุฑุงุญ ุงููุฌุจุฉ ูุน ูุธุงู ุงูุญูุงูุฉ ุงููุชูุงูู
 */
function suggestMeal() {
    // 1. ุฌูุจ ุงูุจูุงูุงุช ุงูุฃุณุงุณูุฉ ููุนุฏุงุฏ ูุงููุณุฎุฉ
    const isPro = localStorage.getItem(PRO_VERSION_KEY) === 'true';
    let count = parseInt(localStorage.getItem(FREE_USES_KEY) || '0', 10);

    // 2. ุงูุญุงุฑุณ ุงูููุงุฆู: ุฅุฐุง ุงุณุชููุฏุช ุงููุญุงููุงุชุ ุงูุทุน ุงูุทุฑูู ูุงูุชุญ ูุงูุฐุฉ ุงูุชูุนูู
    if (!isPro && count >= MAX_FREE_USES) {
        console.log("๐ ุชู ุงููุตูู ููุญุฏ ุงูุฃูุตู. ุฅุธูุงุฑ ูุงูุฐุฉ ุงูุชูุนูู.");
        displayUpgradePrompt("ููุฏ ุงุณุชููุฏุชู ูุงูุฉ ุงููุญุงููุงุช ุงููุฌุงููุฉ ูุงูููุญุฉ ุงูุฅุถุงููุฉ. ูุฑุฌู ุฅุฏุฎุงู ููุชุงุญ ุงูุชูุนูู ูููุชุงุจุนุฉ ูุงูุงุณุชูุงุฏุฉ ุงููุงููุฉ ูู ุชุทุจูู ุดู ุนุงููู ุงููุ");
        return; // ุชููู ุชุงู ููุง
    }

    // 3. ุงูุชุญูู ูู ุงูุนุฏุงุฏ ูุฒูุงุฏุชู (ูููุญุงููุงุช ูู 1 ุฅูู 11)
    if (!checkLimitAndIncrement()) {
        return; // ูุชููู ุฅุฐุง ูุงูุช ููุงู ุฑุณุงูุฉ ุชูุจูู ุฃู ููุญุฉ ุชุญุชุงุฌ ุถุบุท ุฒุฑ
    }
    
    // 4. ุฅุฎูุงุก ุฑุณุงูุฉ ุงูุชุฃููุฏ ุงูุณุงุจูุฉ ูุชุฌููุฒ ุงูุจูุฆุฉ
    const confirmationMsg = document.getElementById('confirmationMsg');
    if (confirmationMsg) {
        confirmationMsg.style.display = 'none';
    }
    window.suggestedMealsHistory = []; 

    // 5. ุฌูุจ ููู ุงูููุชุฑุฉ ูู ูุงุฌูุฉ ุงููุณุชุฎุฏู
    const healthStatus = document.getElementById('healthStatus').value;
    const cost = document.getElementById('cost').value;
    const mealTime = document.getElementById('mealTime').value;
    const weather = document.getElementById('weather').value;
    const mealType = document.getElementById('mealType').value;
    const numberOfpeople = document.getElementById('numberOfpeople').value;

    // ุงูุชุญูู ูู ูุฌูุฏ ุจูุงูุงุช ุงููุฌุจุงุช
    if (typeof meals === 'undefined' || meals.length === 0) {
        console.error("ุฎุทุฃ: ูู ูุชู ุชุญููู ูุงุนุฏุฉ ุจูุงูุงุช ุงููุฌุจุงุช.");
        return;
    }

    // 6. ููุทู ุชุตููุฉ ุงููุฌุจุงุช (Filtering Logic)
    const normalizedUserMealType = mealType.trim().toLowerCase();
    const normalizedCost = cost.trim().toLowerCase();
    const normalizedHealth = healthStatus.trim().toLowerCase();
    const normalizedWeather = weather.trim().toLowerCase();
    const successfulMeals = meals.filter(meal => {
        if (!meal || !meal.health || !meal.cost || !meal.mealTime || !meal.weather || !meal.mealType) {
            return false;
        }

        const healthCheck = meal.health.includes(healthStatus);
        const costCheck = meal.cost.includes(cost);
        const mealTimeCheck = meal.mealTime.includes(mealTime);
        const weatherCheck = meal.weather.includes(weather);

        const mealTypeData = Array.isArray(meal.mealType) ? meal.mealType : [meal.mealType];
        const mealTypeCheck = mealTypeData
            .map(type => String(type).trim().toLowerCase())
            .includes(normalizedUserMealType);

        return healthCheck && costCheck && mealTimeCheck && weatherCheck && mealTypeCheck;
    });

    window.lastFilteredMeals = successfulMeals;

    // 7. ุงูุชุนุงูู ูุน ุญุงูุฉ ุนุฏู ูุฌูุฏ ูุชุงุฆุฌ
    if (successfulMeals.length === 0) {
        displayNoResults(false, true); 
        window.currentSuggestedMeal = null;
        window.suggestedMealsHistory = [];
        updateSuggestButtonState(); 
        return;
    }

    // 8. ุงุฎุชูุงุฑ ูุฌุจุฉ ุนุดูุงุฆูุฉ ููุนุงูุฌุฉ ุงููููุงุช
    const randomIndex = Math.floor(Math.random() * successfulMeals.length);
    let suggestedMeal = JSON.parse(JSON.stringify(successfulMeals[randomIndex])); // ูุณุฎุฉ ุนูููุฉ
    
    window.originalMealData = suggestedMeal;
    const multiplier = getQuantityMultiplier(numberOfpeople);
    
    // ุญุณุงุจ ุงููููุงุช ุจูุงุกู ุนูู ุนุฏุฏ ุงูุฃูุฑุงุฏ
    suggestedMeal = calculateNewQuantities(suggestedMeal, multiplier);
    
    window.currentSuggestedMeal = suggestedMeal;
    window.currentMultiplier = multiplier;
    window.suggestedMealsHistory.push(suggestedMeal.name_ar);

    // 9. ุนุฑุถ ุงููุฌุจุฉ ุงูููุงุฆูุฉ ูู ุงููุงุฌูุฉ
    displayMeal(suggestedMeal);
    
    // 10. ุงูุงูุชูุงู ูููุงุฌูุฉ ุงูุซุงูููุฉ (ุฃุฒุฑุงุฑ ุงูุชุญูู ุจุนุฏ ุงูุงูุชุฑุงุญ)
    document.getElementById('suggestBtn').style.display = 'none'; 
    document.getElementById('alternativeBtn').style.display = 'block';
    document.getElementById('exitBtn').style.display = 'block';
    document.getElementById('confirmBtn').style.display = 'block'; 
    //document.getElementById(' noPrepMsg').style.display = 'none'; 
    // ุชุญุฏูุซ ุญุงูุฉ ุงูุฒุฑ (ูุถูุงู ุชุญุฏูุซ ุงูุนุฏุงุฏ ูู ุงูุฎูููุฉ)
    updateSuggestButtonState(); 
}


// =================================================================
// 4. ุฑุจุท ุงูุฃุญุฏุงุซ (Event Listeners)
// =================================================================

const criticalFilters = [
    'healthStatus', 
    'cost', 
    'mealTime', 
    'weather', 
    'mealType'
];

document.addEventListener('DOMContentLoaded', () => {
    
    document.getElementById('suggestBtn').addEventListener('click', suggestMeal);
    
    criticalFilters.forEach(filterId => {
        const filterElement = document.getElementById(filterId);
        if (filterElement) {
            filterElement.addEventListener('change', () => {
                // ุงูุดุฑุท: ูููุฐ ุงูุนูุฏุฉ ุงูุชููุงุฆูุฉ ููุท ุฅุฐุง ูุงูุช ุงููุฌุจุฉ ูุนุฑูุถุฉ (ุฃู ุฒุฑ ุงูุงูุชุฑุงุญ ูุฎูู)
                if (document.getElementById('suggestBtn').style.display === 'none') {
                    returnToFilterView();
                }
            });
        }
    });
    
    // ุชููุฆุฉ ุญุงูุฉ ุงููุงุฌูุฉ ุนูุฏ ุงูุชุญููู (ุถูุงู ุญุงูุฉ ุงูุจุฏุงูุฉ ุงูุตุญูุญุฉ)
    returnToFilterView(); 
    document.getElementById('suggestBtn').style.display = 'block'; 
    updateSuggestButtonState(); // ุชุญุฏูุซ ุงููุต ู ุญุงูุฉ ุงูุชูุนูู ุนูุฏ ุงูุชุญููู
});

/**
 * @function renderMealIngredients
 * ูุฑุณู ูุงุฆูุฉ ุงูููููุงุช ูู ุงููุงุฌูุฉ ุจูุงุกู ุนูู ุงูุจูุงูุงุช ุงููุชุฑุฌูุฉ ูุงููููุงุช ุงููุญุชุณุจุฉ.
 */
function renderMealIngredients(ingredients) {
    const container = document.querySelector('.ingredients-list');
    if (!container) return;

    // ูุณุญ ุงููุญุชูู ุงููุฏูู ูุจุงุดุฑุฉ
    container.innerHTML = '';

    ingredients.forEach((ingredient) => {
        // ุชุญุฏูุฏ ุงูููู ุงููุทููุจุฉ
        const quantityText = ingredient.quantity || 'ุบูุฑ ูุชููุฑุฉ';
        const targetLang = ingredient.targetLang || 'ar';

        // 1. ุชุญุฏูุฏ ุงูุงุณู ุงููุชุฑุฌู
        const translatedFieldName = `item_${targetLang}`;
        // ุงูุฃููููุฉ ููุบุฉ ุงููุทููุจุฉุ ุซู ุงูุนุฑุจูุฉุ ุซู ุงูุฅูุฌููุฒูุฉ ูุงุญุชูุงุทู
        const ingredientName = ingredient[translatedFieldName] || ingredient.item_ar || ingredient.item_en || 'ุงุณู ุบูุฑ ูุชููุฑ';

        // 2. ุฌูุจ ุงูุงุณู ุงูุนุฑุจู ููุจุญุซ ุนู ุงูุฅูููุฌู
        // ูุณุชุฎุฏู ุงูุงุณู ุงููุฎุชุตุฑ (ุฅุฐุง ุชููุฑ) ุฃู ุงูุงุณู ุงูุนุฑุจู ุงููุงูู ูููุทุงุจูุฉ ูุน emojiMap
        const nameForEmojiLookup = ingredient.name_ar_short || ingredient.item_ar;

        // 3. ุฌูุจ ุงูุฅูููุฌู ุจุงุณุชุฎุฏุงู ุงูุฏุงูุฉ ุงููุณุงุนุฏุฉ
        const ingredientEmoji = getIngredientEmoji(nameForEmojiLookup);

        // ุฅูุดุงุก ุงูุนูุตุฑ ูุฏูุฌ ุงูุจูุงูุงุช
        const ingredientDiv = document.createElement('div');
        ingredientDiv.className = 'ingredient';

        // ุฏูุฌ ุงููููุฉ ูุงูุฅูููุฌู ูุงูุงุณู
        ingredientDiv.innerHTML = `
           <strong>${ingredientEmoji} ${ingredientName}</strong>
           <span class="ingredient-quantity">${quantityText}</span>
        `;

        container.appendChild(ingredientDiv);
    });
}
/**
 * ูุถูู ูุณุชูุนุงู ููุชุบููุฑ ูู ูุงุฆูุฉ "ุนุฏุฏ ุงูุฃูุฑุงุฏ" ูุชูุนูู ุงูุชุญุฏูุซ ุงูุชูุงุนูู.
 */
function setupQuantityListener() {
    const peopleSelect = document.getElementById('numberOfpeople');
    if (peopleSelect) {
        peopleSelect.addEventListener('change', updateIngredientsDisplay);
        console.log('โ ุชู ุชูุนูู ูุณุชูุน ุงูุชุบููุฑ ูุนุฏุฏ ุงูุฃูุฑุงุฏ.');
    }
}

/**
 * @function updateIngredientsDisplay
 * ููุญุฏุซ ูููุงุช ุงูููููุงุช ูู ุงููุงุฌูุฉ ุจูุงุกู ุนูู ุงููุถุงุนู (ุนุฏุฏ ุงูุฃูุฑุงุฏ).
 * ูููู ุจุงูุงุญุชุณุงุจ ุซู ุงูุชุฑุฌูุฉ ููุบุฉ ุงููุงุฌูุฉุ ููุญุงูุธ ุนูู ุงููููุงุช ุงููุชุฑุฌูุฉ.
 */
function updateIngredientsDisplay() {
    // โ๏ธ ูููู ุฅุฒุงูุฉ ูุฐุง ุงูุณุทุฑ ุจุนุฏ ุงูุชุฃูุฏ ูู ุนูู ุงููุธููุฉ ุจุดูู ูุงูู ูู ุจูุฆุฉ ุงูุฅูุชุงุฌ.
    console.log('--- ุจุฏุก ุชูููุฐ ุชุญุฏูุซ ุงููููุงุช ุงูุชูุงุนูู (ููุธู) ---');

    // ุงูุชุญูู ุงูุฃุณุงุณู
    if (typeof window.originalMealData === 'undefined' || !window.originalMealData) {
        console.warn('โ๏ธ ูุดู ุงูุชุญุฏูุซ: ูุง ููุฌุฏ ูุฑุฌุน ุซุงุจุช ูููุฌุจุฉ.');
        return;
    }

    // 1. ุชุญุฏูุฏ ุงููุถุงุนู ูููุฏ ุงููุบุฉ
    const numberOfpeopleElement = document.getElementById('numberOfpeople');
    const numberOfpeople = numberOfpeopleElement ? numberOfpeopleElement.value : 'medium';
    const multiplier = getQuantityMultiplier(numberOfpeople);
    const currentLangCode = document.documentElement.lang;

    // 2. ุงูุงุญุชุณุงุจ (ููุชุฌ ูููุงุช ููุณูุฉ ุจุงููุบุฉ ุงูุนุฑุจูุฉ)
    const updatedMeal = calculateNewQuantities(window.originalMealData, multiplier);

    // 3. ุงูุชุฑุฌูุฉ (ููุชุฌ ูููุงุช ูุชุฑุฌูุฉ ููุบุฉ ุงููุทููุจุฉ)
    const translatedMeal = translateMeal(updatedMeal, currentLangCode);

    // 4. ุงูุฏูุฌ ูุงูุชุฌููุฒ ููุนุฑุถ
    if (translatedMeal && translatedMeal.ingredients) {
        window.currentSuggestedMeal = updatedMeal;

        translatedMeal.ingredients = translatedMeal.ingredients.map((translatedIng) => {
             // ุงูุญูุงุธ ุนูู ุงููููุฉ ุงููุชุฑุฌูุฉ ุงูุชู ุชู ุชูููุฏูุง ุฏุงุฎู translateMeal
             const finalTranslatedQuantity = translatedIng.quantity;

             return {
                 ...translatedIng,
                 quantity: finalTranslatedQuantity, // ุงุณุชุฎุฏุงู ุงููููุฉ ุงููุชุฑุฌูุฉ
                 targetLang: currentLangCode        // ุญูุธ ููุฏ ุงููุบุฉ ููุนุฑุถ
             };
        });
    } else {
        console.error("โ ูุดู ุงูุชุญุฏูุซ: ุจูุงูุงุช ุงููุฌุจุฉ ุงููุชุฑุฌูุฉ ุบูุฑ ุตุงูุญุฉ.");
        return;
    }

    // 5. ุชูุฑูุฑ ุงูุจูุงูุงุช ุฅูู ุงูุนุฑุถ
    renderMealIngredients(translatedMeal.ingredients);

    // โ๏ธ ูููู ุฅุฒุงูุฉ ูุฐุง ุงูุณุทุฑ ุจุนุฏ ุงูุชุฃูุฏ ูู ุนูู ุงููุธููุฉ ุจุดูู ูุงูู.
    console.log('--- ุงูุชูู ุชุญุฏูุซ ุงููููุงุช ุจูุฌุงุญ (ููุธู) ---');
}
       setupQuantityListener()

       /**
 * ูุชู ุงุณุชุฏุนุงุก ูุฐู ุงูุฏุงูุฉ ุจุนุฏ ุชุญููู ูุญุชูู ุงูุตูุญุฉ ุจุงููุงูู.
 */
function initializeMealSuggestionListeners() {
    const numberOfPeopleInput = document.getElementById('numberOfpeople');

    if (numberOfPeopleInput) {
        // ูุฑุจุท ุญุฏุซ 'change' ุจู updateIngredientsDisplay
        // ูุฐุง ูุนูู ุฃู ุงูุฏุงูุฉ ุณุชุนูู ููุฑุงู ุจุนุฏ ุฃู ูุบูุฑ ุงููุณุชุฎุฏู ุงููููุฉ ููุฎุฑุฌ ูู ุงูุญูู.
        numberOfPeopleInput.addEventListener('change', updateIngredientsDisplay);
        console.log('โ ุชู ุชูุนูู ูุณุชูุน ุงูุชุบููุฑ ูุนุฏุฏ ุงูุฃูุฑุงุฏ ุจูุฌุงุญ.');
    } else {
        console.error('โ ูุดู ุงูุฑุจุท: ูู ูุชู ุงูุนุซูุฑ ุนูู ุนูุตุฑ #numberOfpeople.');
    }
}

// ๐ ุงูุฎุทูุฉ ุงูุฃุฎูุฑุฉ: ุงูุชุฃูุฏ ูู ุชุดุบูู ุฏุงูุฉ ุงูุฑุจุท
// ูุฌุจ ุงุณุชุฏุนุงุก initializeMealSuggestionListeners() ุนูุฏ ุชุญููู ุงูุตูุญุฉ:
// window.onload = initializeMealSuggestionListeners;
// ุฃู ุงูุฃูุถู:
document.addEventListener('DOMContentLoaded', initializeMealSuggestionListeners);

/**
 * @function suggestAlternative
 * ุชุฎุชุงุฑ ูุฌุจุฉ ุจุฏููุฉ ูู ูุงุฆูุฉ ุงููุฌุจุงุช ุงููููุชุฑุฉ ุณุงุจูุงูุ ูุน ุชุทุจูู ุงูุงุญุชุณุงุจ ูููุน ุงูุชูุฑุงุฑ.
 * ุฅุฐุง ุชู ุงุณุชููุงู ุฌููุน ุงูุจุฏุงุฆูุ ูุชู ุฅุนุงุฏุฉ ุชุตููุฑ ุณุฌู ุงูุชุงุฑูุฎ ูุฅุนุงุฏุฉ ุงูุฏูุฑุฉ.
 */
function suggestAlternative() {

    // ุฅุฎูุงุก ุฑุณุงูุฉ ุงูุชุฃููุฏ
    const confirmationMsg = document.getElementById('confirmationMsg');
    if (confirmationMsg) {
        confirmationMsg.style.display = 'none';
    }

    let filteredMeals = window.lastFilteredMeals || [];
    let history = window.suggestedMealsHistory || [];

    // ุงูุชุญูู ุงูุฃุณุงุณู ูู ูุฌูุฏ ูุฌุจุงุช ูููุชุฑุฉ
    if (filteredMeals.length === 0) {
        displayNoResults(false, true);
        return;
    }

    // 1. ุชุตููุฉ ุงููุงุฆูุฉ: ุฅุฒุงูุฉ ุงููุฌุจุงุช ุงูุชู ุชู ุนุฑุถูุง ุจุงููุนู
    let availableAlternatives = filteredMeals.filter(meal =>
        !history.includes(meal.name_ar)
    );

    // 2. ูุญุต ุญุงูุฉ ุงูุฏูุฑุฉ: ุฅุฐุง ูุงูุช ุงููุงุฆูุฉ ูุงุฑุบุฉุ ูู ุจุฅุนุงุฏุฉ ุชุตููุฑ ุงูุณุฌู
    if (availableAlternatives.length === 0) {
        window.suggestedMealsHistory = [];
        history = []; // ุชุญุฏูุซ ุงููุชุบูุฑ ุงููุญูู

        // ุฅุนุงุฏุฉ ุงูุชุตููุฉ ุจุนุฏ ุงูุชุตููุฑ
        availableAlternatives = filteredMeals.filter(meal =>
            !history.includes(meal.name_ar)
        );
    }

    // 3. ุฅุฒุงูุฉ ุงููุฌุจุฉ ุงููุนุฑูุถุฉ ุญุงููุงู (ููุชุฃูุฏ ูู ุนุฏู ุธููุฑูุง ููุฑุงู ูุฑุฉ ุฃุฎุฑู)
    const currentlySuggested = window.currentSuggestedMeal;

    if (currentlySuggested && currentlySuggested.name_ar) {
        availableAlternatives = availableAlternatives.filter(meal => meal.name_ar !== currentlySuggested.name_ar);
    }

    // ุงูุชุญูู ุงูููุงุฆู ูู ูุฌูุฏ ุจุฏูู
    if (availableAlternatives.length === 0) {
        displayNoResults(true, false); // ุฑุณุงูุฉ "ูุง ููุฌุฏ ุจุฏูู"
        return;
    }

    // 4. ุงุฎุชูุงุฑ ูุฌุจุฉ ุนุดูุงุฆูุฉ ูู ุงููุงุฆูุฉ ุงูุฌุฏูุฏุฉ
    const randomIndex = Math.floor(Math.random() * availableAlternatives.length);
    let suggestedMeal = availableAlternatives[randomIndex];

    // 5. ุญูุธ ุงููุฌุจุฉ ุงูุฃุตููุฉ (ุงููุฑุฌุน ุงูุซุงุจุช) ูููุฌุจุฉ ุงูุฌุฏูุฏุฉ
    window.originalMealData = suggestedMeal;

    // 6. ุญุณุงุจ ุงููุถุงุนู ูุชุทุจูู ุงูุงุญุชุณุงุจ
    const numberOfpeople = document.getElementById('numberOfpeople').value;
    const multiplier = getQuantityMultiplier(numberOfpeople);
    suggestedMeal = calculateNewQuantities(suggestedMeal, multiplier);

    // 7. ุชุญุฏูุซ ุงูุณุฌู ูุงููุฌุจุฉ ุงูุญุงููุฉ
    window.currentSuggestedMeal = suggestedMeal;
    window.currentMultiplier = multiplier;

    // ุฅุถุงูุฉ ุงููุฌุจุฉ ุงูุฌุฏูุฏุฉ ุฅูู ุณุฌู ุงูุชุงุฑูุฎ (ุชุชู ุงูุฅุถุงูุฉ ููุง ูุฑุฉ ูุงุญุฏุฉ ููุท)
    window.suggestedMealsHistory.push(suggestedMeal.name_ar);

    // 8. ุนุฑุถ ุงููุฌุจุฉ
    displayMeal(suggestedMeal);
}
/**
 * ุฏุงูุฉ ูุนุฑุถ ุงููุตูุฉ ุนูู ุงููุงุฌูุฉ (ูุน ุงูุชุฑุฌูุฉ).
 * @param {object} mealData ูุงุฆู ุงููุฌุจุฉ ุงูููุญุชุณุจ ูุงููููุชุฑุญ.
 */
function displayMeal(mealData) { 
    const resultDiv = document.getElementById('result');
    if (!mealData) {
        // ููุชุฑุถ ุฃู ุฏุงูุฉ displayNoResults ูุนุฑูุฉ ุฎุงุฑุฌูุงู
        if (typeof displayNoResults === 'function') {
            displayNoResults(false, false); 
        }
        return; 
    } 
    
    // 1. ุชุฑุฌูุฉ ุงููุฌุจุฉ ุฅูู ุงููุบุฉ ุงูุญุงููุฉ ูููุงุฌูุฉ
    const currentLangCode = document.documentElement.lang;
    const t = typeof translations !== 'undefined' ? translations[currentLangCode] : {}; // ุงูุชุฃูุฏ ูู ุชุนุฑูู t
    const translatedMeal = translateMeal(mealData, currentLangCode);
    
    // 2. ูุญุต ุณูุงูุฉ ูุชูุฌุฉ ุงูุชุฑุฌูุฉ
    if (!translatedMeal) {
        console.error("Translated meal data is invalid.");
        return;
    }

    // 3. ุชุญุฏูุฏ ุงูููููุงุช ูุทุฑููุฉ ุงูุชุญุถูุฑ ุจุงููุบุฉ ุงูุตุญูุญุฉ
    const ingredientsToDisplay = translatedMeal.ingredients || []; 
    const preparationStepsList = translatedMeal.preparation || []; 
    
    // 4. ุจูุงุก ุงูู HTML
    if (resultDiv) {
        console.log(mealData.image);
        resultDiv.innerHTML = `
            <div class="meal-layout">
               <div class="meal-header"> 
                <h3 class="meal-title">
                    ๐ฅ<span>${translatedMeal.name}</span>๐ฅ
                    </h3>
                 <img src="${mealData.image}" alt="${translatedMeal.name}" class="meal-image">
            </div> 
                 <div class="ingredient flex-row-aligned">
            </div>
           <div class="flex-start-group">
            <div class="flex-end-group">
       </div> 
                <div class="meal-content">
                    <div class="ingredients-section" lang="${currentLangCode}">
                        <strong>๐ ${t.ingredientsLabel || 'ุงูููููุงุช'}</strong> 
                        <div class="ingredients-list">
                            ${ingredientsToDisplay.map(ingredient => {
                                
                                const newQuantity = ingredient.quantity || '';
                                const displayUnit = ingredient.unit || ''; 
                                
                                // ๐ข ุงูุชุนุฏูู ุงูุฌุฐุฑู: ูุณุชุฎุฏู ingredient.item_ar ูุฎูุงุฑ ุจุฏูู ุฅุฐุง ูุงู ingredient.item ูุงุฑุบุงู 
                                // (ููู ูุง ูุญุฏุซ ุนูุฏ ุงูุชุฑุฌูุฉ ููุนุฑุจูุฉ ูู ุญุงูุชู)
                                const displayItem = ingredient.item || ingredient.item_ar || 'ูููู ุบูุฑ ูุนุฑูู';
                                
                                let quantityAndUnitHtml = '';
                                
                                // ููุทู ููุน ุชูุฑุงุฑ ุงููุญุฏุฉ (ุงูุฐู ุชู ุฅุถุงูุชู ุณุงุจูุงู)
                                if (currentLangCode === 'ar' && newQuantity.toString().includes(' ')) {
                                    quantityAndUnitHtml = `<span class="ingredient-quantity">${newQuantity}</span>`;
                                } else {
                                    quantityAndUnitHtml = `<span class="ingredient-quantity">${newQuantity} ${displayUnit}</span>`;
                                }

                                return `
                                <div class="ingredient">
                                    ${ingredient.emoji || (typeof getIngredientEmoji !== 'undefined' ? getIngredientEmoji(ingredient.item_ar) : '๐ฝ๏ธ')} 
                                    <strong>${displayItem}</strong>
                                    ${quantityAndUnitHtml}
                                </div>
                                `;
                            }).join('')}
                        </div>
                    </div>
                    <div class="preparation-section">
                        <strong>๐ฉโ๐ณ ${t.instructionsLabel || 'ุทุฑููุฉ ุงูุชุญุถูุฑ'}</strong>
                        <div class="preparation-steps">
                            ${preparationStepsList.map((step, index) => `
                                <div class="step">
                                    ${step.replace(/^\d+\.\s*/, '')} </div>
                            `).join('')}
                        </div>
                    </div>
                </div>
            </div>
        `;
    
        // 5. ุชุญุฏูุซ ุญุงูุฉ ุงูุฃุฒุฑุงุฑ
        const suggestBtn = document.getElementById('suggestBtn');
        const alternativeBtn = document.getElementById('alternativeBtn');
        const exitBtn = document.getElementById('exitBtn');
        const confirmBtn = document.getElementById('confirmBtn');
        const noPrepMsg = document.getElementById('noPrepMsg');
        
        if (suggestBtn) suggestBtn.style.display = 'none';
        if (alternativeBtn) alternativeBtn.style.display = 'block';
        if (exitBtn) exitBtn.style.display = 'block';
        if (confirmBtn) confirmBtn.style.display = 'block';

        resultDiv.classList.add('result-success');
    }
}

// ... (ุจููุฉ ุงูุฏูุงู ุงููุณุงุนุฏุฉ ูุซู getIngredientEmoji)

// ====================================================================
// 5. ุฏูุงู ุงูุฅุถุงูุงุช (Auxiliary Functions)
// ====================================================================

/** ุฏุงูุฉ ูุณุงุนุฏุฉ ููุฅูููุฌู */
function getIngredientEmoji(ingredientName) {
    const emojiMap = {
        'ุนุฏุณ': '๐ซ', 'ุฌุฒุฑ': '๐ฅ', 'ุจุตู': '๐ง', 'ุซูู': '๐ง',
        'ุฌุฑุฌูุฑ': '๐ฅฌ', 'ุฌุจู': '๐ง', 'ุทูุงุทู': '๐', 'ุฎุณ': '๐ฅฌ',
        'ุฎูุงุฑ': '๐ฅ', 'ูุญู': '๐ฅฉ', 'ุฏุฌุงุฌ': '๐', 'ุณูู': '๐',
        'ุฃุฑุฒ': '๐', 'ูุนูุฑููุฉ': '๐', 'ุจูุถ': '๐ฅ', 'ุญููุจ': '๐ฅ',
        'ูุงุก': '๐ง', 'ูุฑู': '๐ฒ', 'ุฒูุช': '๐ซ', 'ููููู': '๐',
        'ูููู': '๐ถ๏ธ', 'ููุญ': '๐ง', 'ูุทุฑ': '๐', 'ุจุทุงุทุง': '๐ฅ'
    };
    return emojiMap[ingredientName] || '๐ฑ';
}

/** ุฏุงูุฉ ูุณุญ ุงููุชุงุฆุฌ ูู ุงูุดุงุดุฉ */
function clearResults() {
    const resultDiv = document.getElementById('result');
    if (resultDiv) {
        resultDiv.innerHTML = '';
        resultDiv.classList.remove('result-success');
        document.getElementById('suggestBtn').style.display = 'block'; // ุฅุนุงุฏุฉ ุฒุฑ ุงูุงูุชุฑุงุญ
        document.getElementById('alternativeBtn').style.display = 'none';
        document.getElementById('exitBtn').style.display = 'none';
        document.getElementById('confirmBtn').style.display = 'none';
    }
}

/** ุฏุงูุฉ ุนุฑุถ ุฑุณุงูุฉ "ุตุญุชูู ูุนุงููุฉ" ุงููุชุฑุฌูุฉ */
function showHealthMessage() {
    const currentLangCode = document.documentElement.lang;
    const messages = {
        'ar': '๐ฝ๏ธุตุญุชูู ูุนุงููุฉ๐ฝ๏ธ',
        'en': '๐ฝ๏ธ Bon Appรฉtit ๐ฝ๏ธ',
        'ru': '๐ฝ๏ธ ะัะธััะฝะพะณะพ ะฐะฟะฟะตัะธัะฐ ๐ฝ๏ธ',
        'fa': '๐ฝ๏ธ ููุด ุฌุงู ๐ฝ๏ธ'
    };
    const message = messages[currentLangCode] || messages['ar'];

    const msgElement = document.createElement('div');
    msgElement.className = 'health-message';
    msgElement.textContent = message;
    document.body.appendChild(msgElement);
    
    setTimeout(() => {
        if (document.body.contains(msgElement)) {
            document.body.removeChild(msgElement);
        }
    }, 8000);
}


// ====================================================================
// 6. ุฏุงูุฉ ุนุฑุถ ุงูุณุงุนุฉ ุงูุฑูููุฉ (Clock Functionality)
// ====================================================================

/** ุฏุงูุฉ ุนุฑุถ ุงูุณุงุนุฉ ุงูุฑูููุฉ (ูุญุฏุซุฉ ูุฏุนู ูุบุงุช ูุชุนุฏุฏุฉ) */
function updateClock() {
    const now = new Date();
    
    let locale = 'en-US';
    let currentLangCode = document.documentElement.lang;

    if (currentLangCode === 'ar' || currentLangCode === 'fa') {
        locale = 'en-EG'; // ุงุณุชุฎุฏุงู ุงูุฃุฑูุงู ุงูุนุฑุจูุฉ
    } else if (currentLangCode === 'ru') {
        locale = 'ru-RU';
    }
    
    const timeString = now.toLocaleTimeString(locale, {
        hour: '2-digit',
        minute: '2-digit',
        hour12: false // ุตูุบุฉ 24 ุณุงุนุฉ
    });

    document.getElementById('timeDisplay').textContent = timeString;
}

// ุชุญุฏูุซ ุงูุณุงุนุฉ ูู ุซุงููุฉ (ูุฌุจ ุฃู ูููู 'timeDisplay' ููุฌูุฏูุง ูู HTML)
setInterval(updateClock, 1000);
updateClock(); 

// ====================================================================
// 7. ููุณุชูุน ุจุฏุก ุงูุชุดุบูู ูุฑุจุท ุงูุฃุญุฏุงุซ (Initialization & Listeners)
// ====================================================================

document.addEventListener('DOMContentLoaded', () => {
    // 1. ุชุทุจูู ุงููุบุฉ ุงููุญููุธุฉ ุนูุฏ ุงูุชุญููู ุงูุฃููู
    const savedLanguage = localStorage.getItem('preferredLang') || 'ar';
    applyUITranslation(savedLanguage);
    highlightActiveLanguageButton(savedLanguage); 

    // 2. ุฑุจุท ุฃุฒุฑุงุฑ ุงููุบุฉ (lang-btn) ุจู handleLanguageToggle
    const langButtons = document.querySelectorAll('.lang-btn'); 
    langButtons.forEach(button => {
        button.addEventListener('click', (event) => {
            const langCode = event.target.getAttribute('data-lang');
            handleLanguageToggle(langCode); 
        });
    });

    // 3. ุฑุจุท ุฃุฒุฑุงุฑ ุงููุธุงุฆู ุงูุฑุฆูุณูุฉ
    document.getElementById('suggestBtn').addEventListener('click', suggestMeal);
    document.getElementById('alternativeBtn').addEventListener('click', suggestAlternative);
    document.getElementById('confirmBtn').addEventListener('click', () => {
        const confirmationMsg = document.getElementById('confirmationMsg');
        confirmationMsg.style.display = 'block';

        setTimeout(() => {
            confirmationMsg.style.display = 'none';
            showHealthMessage();
        }, 750);
    });

    document.getElementById('exitBtn').addEventListener('click', () => {
        const resultDiv = document.getElementById('result');
        if (!resultDiv || !resultDiv.innerHTML.trim()) {
            return; 
        } 
        
        clearResults();
        
        const currentLangCode = document.documentElement.lang;
        const exitMessages = {
            'ar': 'โ ุชู ุฅููุงุก ุงูุฌูุณุฉ. ุดูุฑุงู ูุงุณุชุฎุฏุงูู ุชุทุจูู "ุดู ุนุงููู ุฃููุ"โ ',
            'en': 'โSession Ended. Thank you for using- What is for Dinner โ?',
            'ru': 'โะกะตะฐะฝั ะทะฐะฒะตััะตะฝ. ะกะฟะฐัะธะฑะพ ะทะฐ ะธัะฟะพะปัะทะพะฒะฐะฝะธะต ะฟัะธะปะพะถะตะฝะธั-ะงัะพ ะฝะฐ ะพะฑะตะดโ?',
            'fa': 'โุฌูุณู ุจู ูพุงุงู ุฑุณุฏ. ุงุฒ ุดูุง ุจุงุจุช ุงุณุชูุงุฏู ุงุฒ ุจุฑูุงูู ยซุบุฐุง ฺ ุฏุงุฑูุ ยป ูุชุดฺฉุฑู.โ'
        };
        const exitMessage = exitMessages[currentLangCode] || exitMessages['ar'];

        const msgElement = document.createElement('div');
        msgElement.className = 'health-message';
        msgElement.textContent = exitMessage;
        msgElement.style.background = 'rgba(175, 50, 50, 0.95)'; 
        msgElement.style.borderColor = '#FF6B6B';
        msgElement.style.color = '#FFDDDD';
        
        document.body.appendChild(msgElement);
        
        setTimeout(() => {
            if (document.body.contains(msgElement)) {
                document.body.removeChild(msgElement);
            }
            window.currentSuggestedMeal = null;
            // ููููู ุชูุฌูู ุงููุณุชุฎุฏู ูุตูุญุฉ ุฃุฎุฑู ุฅุฐุง ูุฒู ุงูุฃูุฑ
            window.location.href = 'index.html';
        }, 8000);
    });
    
    // 4. ุนุฑุถ ุฑุณุงูุฉ ุงูุจุฏุงูุฉ ุงููุชุฑุฌูุฉ ุนูุฏ ุงูุชุญููู
    displayNoResults(false, true); 
});
</script>
<div id="customModal" class="modal-overlay" style="display: none;">
    <div class="modal-content">
        <div id="modalIcon" class="modal-icon">โ๏ธ</div>
        <h2 id="modalTitle">ุงูุชูุช ุงููุญุงููุงุช!</h2>
        <p id="modalMessage">ููุฏ ุงุณุชูููุช ุฌููุน ุงููุญุงููุงุช ุงููุฌุงููุฉ ููุฐุง ุงูููู.</p>
        
        <div id="proKeySection" style="display: none;">
            <input type="text" id="proKeyInput" placeholder= "  ุงุฏุฎูู ููุชุงุญ ุงูุชูุนูู ููุง ..." class="pro-input">
            <button onclick="handleKeyActivation()" class="btn-activate">ุชูุนูู ุงููุณุฎุฉ ุงููุฏููุนุฉ</button>
        </div>

        <div class="modal-buttons">
    <button id="giftBtn" onclick="addGiftAttempts()" class="btn-gift">๐ ูุญุงููุชูู ูุฌุงูุงู (ูุฑุฉ ูุงุญุฏุฉ)</button>
    <button id="closeModalBtn" onclick="closeModal()" class="btn-close">ุนูุฏุฉ ุงูู ุงูุชุทุจูู</button>
</div>
    </div>
</div>
</body>
</html>

